(self.webpackChunkapp_studio_enterprise_relationship_diagram=self.webpackChunkapp_studio_enterprise_relationship_diagram||[]).push([[3396,8239,5036,6118,7344,8160,1034,8056,1906,4501],{43396:(ht,at,c)=>{c.r(at),c.d(at,{ConnectionPropertiesPageComponent:()=>A,ContainerPropertiesPageComponent:()=>$,CrtRelationshipDialogComponent:()=>K,EntityInGroupPropertiesDialogComponent:()=>B,GroupContentListComponent:()=>V,GroupContentListEventService:()=>T,GroupPropertiesDialogComponent:()=>Z,GroupsPropertiesPageComponent:()=>X,LookupDataService:()=>O,PropertiesPageEventService:()=>j,RelatedListComponent:()=>J,RelationshipDeleteDialogService:()=>E,RelationshipDesignerComponent:()=>Y,RelationshipDesignerModule:()=>st,RelationshipDesignerService:()=>b,RelationshipDesignerTranslateLoader:()=>et,RelationshipDiagramEventHandlerController:()=>rt,RelationshipDiagramEventService:()=>F});var I=c(74742),g=c(31134),H=c(2876),t=c(94450),R=c(86146),v=c(30955),S=c(72856),D=c(59837),M=c(14535),u=c(75903),m=c(66868),w=c(30738),k=c(59972),L=c(32820),ut=c(7950),f=c(75378),C=c(77207),Ct=c(28118),h=c(99293),tt=c(41307),P=c(34038),d=c(15288),ct=c(49475),pt=c(28212),l=c(21322),_=c(27049);class N{static{this.formal={id:"56d730bf-27f5-42d9-83df-183df2ec06a1",name:"Formal"}}static{this.notFormal={id:"6d1d2243-d4de-4d64-aab4-23eed4021a60",name:"Not formal"}}}class W{static{this.AddElement="AddElement"}static{this.EditConnection="EditConnection"}static{this.DeleteElement="DeleteElement"}static{this.AddGroup="AddGroup"}static{this.AddEntityInGroup="AddEntityInGroup"}}var yt=c(6523);class O{constructor(e){this.queryExecutor=e}_getDisplayValueFilterGroup(e,n){const i=new f.FilterGroup;i.logicalOperation=f.LogicalOperatorType.Or;for(const o of e)i.addSchemaColumnFilterWithParameter(f.ComparisonType.Contain,o,n);return i}getFilteredLookupItems(e){const n=new f.EntitySchemaQuery(e.schemaName);n.rowCount=20;const i=e.additionalColumns||[],o=e.excludedRecords||[],a=e.additionalFilters||[];i.includes("Id")||n.addSchemaColumn("Id"),i.includes("Name")||n.addSchemaColumn("Name");for(const s of i)n.addSchemaColumn(s);if(e.value!==""){const s=e.displayValueFilters||["Name"];n.filters.add(this._getDisplayValueFilterGroup(s,e.value))}o.length>0&&n.filters.addSchemaColumnInFilterWithParameters(f.ComparisonType.Not_equal,"Id",o);for(const s of a)n.filters.add(s);return this.queryExecutor.executeSelectQuery(n).pipe((0,_.map)(s=>s.map(p=>({value:p.Id,displayValue:e.displayValueGetter?e.displayValueGetter(p):p.Name,row:p}))),(0,_.share)())}static{this.\u0275fac=function(n){return new(n||O)(t.\u0275\u0275inject(yt.QueryExecutor))}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:O,factory:O.\u0275fac})}}class T{constructor(){this.createGroup$=new l.Subject,this.addEntityToGroup$=new l.Subject,this.initializeGroups$=new l.Subject,this.isLoading$=new l.ReplaySubject(1)}createGroup(){this.createGroup$.next()}addEntityToGroup(e){this.addEntityToGroup$.next(e)}isLoading(e){this.isLoading$.next(e)}initializeGroups(){this.initializeGroups$.next()}static{this.\u0275fac=function(n){return new(n||T)}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:T,factory:T.\u0275fac})}}class j{constructor(){this.designerConfig$=new l.ReplaySubject(1),this.doSave$=new l.Subject,this.saveCard$=new l.Subject,this.doCloseCard$=new l.Subject}setDesignerConfig(e){this.designerConfig$.next(e)}getDesignerConfig(){return this.designerConfig$}doSave(){return this.doSave$}cardSaved(e){this.saveCard$.next(e)}saveCard(){return this.doSave$.next(),this.saveCard$}closeCard(e){this.doCloseCard$.next(e)}doCloseCard(){return this.doCloseCard$}static{this.\u0275fac=function(n){return new(n||j)}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:j,factory:j.\u0275fac})}}var Mt=c(33177),G=c(97600);class et extends C.TranslateLoader{constructor(e,n,i){super(),this.customEventService=e,this._store=n,this._getTranslationsEventName=i,this.destroyed$=new l.Subject,this.translations={},this.InitializeTranslation()}InitializeTranslation(){this.customEventService.subscribe(this._getTranslationsEventName).pipe((0,_.takeUntil)(this.destroyed$),(0,_.tap)(e=>{this._store.langs.forEach(n=>{const i=this._store.translations[n];this._store.translations[n]=(0,G.merge)(i,e)})})).subscribe(e=>{this.translations=e}),this.customEventService.createOutboundChannel(this._getTranslationsEventName).next()}getTranslation(e){return(0,l.of)(this.translations)}ngOnDestroy(){this.destroyed$.next()}static{this.\u0275fac=function(n){return new(n||et)(t.\u0275\u0275inject(Mt.CustomEventService),t.\u0275\u0275inject(C.TranslateStore),t.\u0275\u0275inject(ct.GET_TRANSLATIONS_EVENT_NAME))}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:et,factory:et.\u0275fac})}}class b{constructor(e){this.httpClient=e,this.serviceEndpoint="rest/RelationshipDesignerService/"}_prepareCollection(e,n){const i={};return e?.forEach(function(o){const a=o[n];i[a]=o},this),i}getDiagram(e,n){const i=this.serviceEndpoint+"GetDiagram";return this.httpClient.post(i,{recordId:e,schemaName:n}).pipe((0,_.map)(o=>{if(o&&o.success){const a=o.data;a.elements=this._prepareCollection(a.elements,"id"),a.connections=this._prepareCollection(a.connections,"id"),a.labels=this._prepareCollection(a.labels,"parent"),a.groups&&(a.groups=this._prepareCollection(a.groups,"id")),o.data=a;const s=o.config;s.customDiagramElements=this._prepareCollection(s.customDiagramElements,"type"),o.config=s}return o}))}deleteEntity(e){const n=this.serviceEndpoint+"DeleteEntity";return this.httpClient.post(n,{entityId:e})}createConnection(e){const n=this.serviceEndpoint+"CreateConnection";return this.httpClient.post(n,{entityConnection:e})}updateConnection(e){const n=this.serviceEndpoint+"UpdateConnection";return this.httpClient.post(n,{entityConnection:e})}deleteConnection(e){const n=this.serviceEndpoint+"DeleteConnection";return this.httpClient.post(n,{connectionId:e})}getGroupsData(){const e=this.serviceEndpoint+"GetGroupsData";return this.httpClient.post(e,null)}getGroupsDataForEntity(e){const n=this.serviceEndpoint+"GetGroupsDataForEntity";return this.httpClient.post(n,{entityId:e})}createGroup(e){const n=this.serviceEndpoint+"CreateGroup";return this.httpClient.post(n,{group:e})}updateGroup(e){const n=this.serviceEndpoint+"UpdateGroup";return this.httpClient.post(n,{group:e})}deleteGroup(e){const n=this.serviceEndpoint+"DeleteGroup";return this.httpClient.post(n,{groupId:e})}createEntityInGroup(e){const n=this.serviceEndpoint+"CreateEntityInGroup";return this.httpClient.post(n,{entityInGroup:e})}updateEntityInGroup(e){const n=this.serviceEndpoint+"UpdateEntityInGroup";return this.httpClient.post(n,{entityInGroup:e})}deleteEntityInGroup(e,n){const i=this.serviceEndpoint+"DeleteEntityInGroup";return this.httpClient.post(i,{entityId:e,groupId:n})}getRecordEntityInfo(e){const n=this.serviceEndpoint+"GetRecordEntityInfo";return this.httpClient.post(n,{entityId:e}).pipe((0,_.map)(i=>{const o=i?.recordEntityInfo;if(o){const a={};(0,G.forOwn)(o,s=>{const p=s.Key.toLowerCase();a[p]=s.Value}),i.recordEntityInfo=a}return i}))}static{this.\u0275fac=function(n){return new(n||b)(t.\u0275\u0275inject(H.HttpClient))}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:b,factory:b.\u0275fac})}}var y=c(8239),x=c(29450);class F extends x.BaseDiagramEventService{constructor(){super(),this.getDiagramInfo$=new l.ReplaySubject(1),this.itemSelected$=new l.Subject,this.highlightedGroup$=new l.Subject,this.diagramLoaded$=new l.Subject,this.elementDoubleClick$=new l.Subject,this.elementRemoving$=new l.Subject,this.connectionAdding$=new l.Subject,this.connectionAdded$=new l.Subject,this.connectionChanged$=new l.Subject,this.showMessage$=new l.Subject,this.connectionReconnect$=new l.Subject,this.entityInGroupAdded$=new l.Subject,this.entityInGroupRemoving$=new l.Subject,this.diagramChanged$=new l.Subject,this.init()}getDiagramConfig(){var e=this;return(0,y.Z)(function*(){return(0,l.lastValueFrom)(e.getDiagramInfo$.asObservable(),{defaultValue:null})})()}setDiagramConfig(e){this.getDiagramInfo$.next(e),this.getDiagramInfo$.complete()}diagramLoaded(){this.diagramLoaded$.next()}itemSelected(e){this.itemSelected$.next(e)}highlightGroup(e){this.highlightedGroup$.next(e)}elementDoubleClick(e){this.elementDoubleClick$.next(e)}connectionAdding(e){this.connectionAdding$.next(e)}connectionReconnect(e){this.connectionReconnect$.next(e)}elementRemoving(e){return this.elementRemoving$.next(e),!1}showMessage(e){this.showMessage$.next(e)}entityInGroupAdded(){this.entityInGroupAdded$.next()}entityInGroupRemoving(){this.entityInGroupRemoving$.next()}static{this.\u0275fac=function(n){return new(n||F)}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:F,factory:F.\u0275fac})}}class E{constructor(e,n){this._dialogService=e,this._translateService=n}_getRemovingConfirmationDialogConfig(e){return{width:"450px",panelClass:["dialog-top-border","relationship-remove-item"],data:{message:this._translateService.instant(e),primaryButton:{result:h.YesButton.result,caption:this._translateService.instant(h.YesButton.caption).toLowerCase()},secondaryButton:{result:h.NoButton.result,caption:this._translateService.instant(h.NoButton.caption).toLowerCase()}}}}confirmRemoving(e){const n=this._getRemovingConfirmationDialogConfig(e);return this._dialogService.open(h.ConfirmationDialogComponent,n).pipe((0,l.map)(i=>i===h.YesButton.result))}static{this.\u0275fac=function(n){return new(n||E)(t.\u0275\u0275inject(h.DialogService),t.\u0275\u0275inject(C.TranslateService))}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:E,factory:E.\u0275fac})}}class U{static hasParent(e){return!!e?.parent}static getDefaultConnectionType(e,n){switch(!0){case(this.isContainer(e)&&this.isContainer(n)):case(this.isContainer(e)&&this.isItem(n)&&!this.hasParent(n)):case(this.isContainer(e)&&this.isItem(n)&&e.id===n.parent):case(this.isItem(e)&&!this.hasParent(e)&&this.isContainer(n)):case(this.isItem(e)&&this.hasParent(e)&&this.isItem(n)&&!this.hasParent(n)):case(this.isItem(e)&&!this.hasParent(e)&&this.isItem(n)&&this.hasParent(n)):case(this.isItem(e)&&this.hasParent(e)&&this.isItem(n)&&this.hasParent(n)&&e.parent===n.parent):return N.formal;default:return N.notFormal}}static getUnsupportedConnectionTypesIds(e,n){return U.getDefaultConnectionType(e,n).id!==N.formal.id?[N.formal.id]:[]}static isItem(e){return e&&e.type==="relationship-item"}static isContainer(e){return e&&e.type==="relationship-container"}}var Q=c(99852);class z{_initializeDirectionality(){this.isRtl=this.directionality?.value==="rtl"}_initializeGTM(){this.subscription.add(this.googleTagManagerService.initialize().subscribe())}constructor(e){this.injector=e,this.subscription=new l.Subscription,this.isNew=!1,this.isLoading=!1,this.elementData=null,this.elementConfig=null,this.id$=new l.Subject,this.isRtl=!1,this.injectDependencies(),this.subscribeEvents(),this._initializeDirectionality(),this._initializeGTM()}injectDependencies(){this.designerService=this.injector.get(b),this.propertiesPageEventService=this.injector.get(j),this.dialogService=this.injector.get(h.DialogService),this.translateService=this.injector.get(C.TranslateService),this.diagramEventService=this.injector.get(d.BaseDiagramEventService),this.directionality=this.injector.get(Q.Directionality),this.googleTagManagerService=this.injector.get(tt.GoogleTagManagerService)}subscribeEvents(){this.subscription.add(this.id$.subscribe(e=>this.onIdChange(e))),this.subscription.add(this.propertiesPageEventService.doSave().subscribe(()=>this.saveCard()))}showMask(){this.isLoading=!0}hideMask(){this.isLoading=!1}getElement(e){return this.data.elements[e]||this.data.connections[e]}getElementConfig(e){return e&&this.config?.customDiagramElements[e]}getElementByRecordId(e){let n=null;return(0,G.forOwn)(this.data.elements,i=>{if(i.recordId===e)return n=i,!1}),n}onIdChange(e){this.subscription.add(this.propertiesPageEventService.getDesignerConfig().pipe((0,_.take)(1)).subscribe(n=>{this.fillData(n,e),this.onDataInitialized()}))}fillData(e,n){this.data=e.data,this.config=e.config;const i=this.elementData||this.getElement(n);this.elementConfig=this.getElementConfig(i?.type),this.elementData=i}onDataInitialized(){}saveCard(){const e=this.validate();if(!e){setTimeout(()=>{this.propertiesPageEventService.cardSaved({validated:e,success:!1,isChanged:!1})});return}this.showMask(),this.subscription.add(this.onSavedCard().subscribe(n=>{this.hideMask();const i=this.isNeedActualizeDiagram();this.propertiesPageEventService.cardSaved({validated:e,success:n,isChanged:i})}))}isNeedActualizeDiagram(){return this.isNew||this.isChanged()}onSavedCard(){return(0,l.of)(!0).pipe((0,_.delay)(1))}validate(){return!0}isChanged(){return!1}showErrorDialog(e){if(e?.success)return;const n=e?.errorInfo?.message||"An unknown error occurred during the operation.";this.subscription.add(this.dialogService.openInfoDialog(n).subscribe())}sendGtmAction(e){const n={moduleName:"RelationshipDesignerModule",schemaName:this.getGtmSchemaName()};e&&n&&this.googleTagManagerService.track((0,G.merge)(n,e))}getGtmSchemaName(){throw new Error("Need return gtm schema name")}ngOnDestroy(){this.subscription.unsubscribe(),this.hideMask()}static{this.\u0275fac=function(n){return new(n||z)(t.\u0275\u0275directiveInject(t.Injector))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:z,selectors:[["crt-base-properties-page"]],hostVars:2,hostBindings:function(n,i){n&2&&t.\u0275\u0275classProp("rtl",i.isRtl)},decls:0,vars:0,template:function(n,i){},encapsulation:2})}}var mt=c(73539);class nt{set legacyAutocompleteTrigger(e){this._legacyAutocompleteTrigger=e}set legacyAutocomplete(e){this._legacyAutocomplete=e,this._openedSubscription||(this._openedSubscription=this._legacyAutocomplete.opened.subscribe(this._onAutocompleteOpened.bind(this)),this._closedSubscription=this._legacyAutocomplete.closed.subscribe(this._onAutocompleteClosed.bind(this)))}_onAutocompleteOpened(){this._overlayPointerEventsSubscription=this._legacyAutocompleteTrigger._overlayRef._outsidePointerEvents.subscribe(e=>this._legacyAutocompleteTrigger.closePanel())}_onAutocompleteClosed(){this._overlayPointerEventsSubscription.unsubscribe(),this._overlayPointerEventsSubscription=void 0}ngOnDestroy(){this._openedSubscription.unsubscribe(),this._openedSubscription=void 0,this._closedSubscription.unsubscribe(),this._closedSubscription=void 0}static{this.\u0275fac=function(n){return new(n||nt)}}static{this.\u0275dir=t.\u0275\u0275defineDirective({type:nt,selectors:[["","crtLegacyAutocompleteOverlayClick",""]],inputs:{legacyAutocompleteTrigger:"legacyAutocompleteTrigger",legacyAutocomplete:"legacyAutocomplete"}})}}function ft(r,e){r&1&&t.\u0275\u0275element(0,"ts-mask",27)}function _t(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-hint"),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),r&2){const n=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(n.getControlErrorMessage())}}function It(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-option",28),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),r&2){const n=e.$implicit;t.\u0275\u0275property("value",n),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",n.displayValue," ")}}function vt(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-hint"),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),r&2){const n=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(n.getControlErrorMessage())}}function Dt(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-option",28),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),r&2){const n=e.$implicit;t.\u0275\u0275property("value",n),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",n.displayValue," ")}}function xt(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-hint"),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),r&2){const n=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(n.getControlErrorMessage())}}function Pt(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-option",28),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),r&2){const n=e.$implicit;t.\u0275\u0275property("value",n),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",n.displayValue," ")}}function bt(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-hint"),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),r&2){const n=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(n.getControlErrorMessage())}}function Et(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-option",28),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),r&2){const n=e.$implicit;t.\u0275\u0275property("value",n),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",n.displayValue," ")}}class A extends z{constructor(e){super(e),this.injector=e,this.relationshipTypeSchemaName="RelationType",this.connectionTypeSchemaName="RelationConnectionType",this.comment="",this.elementData=null,this._relationshipDeleteDialogService=this.injector.get(E)}injectDependencies(){super.injectDependencies(),this.lookupDataService=this.injector.get(O)}onDataInitialized(){this.showMask(),super.onDataInitialized(),this.initializeIsNew(),this.initializeSourceElementData(),this.initializeTargetElementData(),this.initializeConnectionType(),this.initializeExcludedConnectionTypes(),this.initializeRelationshipType(),this.initializeEntityA(),this.initializeEntityB(),this.initializeComment(),this.hideMask()}initializeIsNew(){this.isNew=this.elementData?.isNew}initializeSourceElementData(){!this.elementData?.source||(this.sourceElement=this.getElement(this.elementData.source),this.sourceConfig=this.getElementConfig(this.sourceElement.type))}initializeTargetElementData(){!this.elementData?.target||(this.targetElement=this.getElement(this.elementData.target),this.targetConfig=this.getElementConfig(this.targetElement.type))}initializeEntityA(){!this.sourceElement||(this.selectedEntityA={value:this.sourceElement.recordId,displayValue:this.sourceElement.caption})}initializeEntityB(){if(!this.elementData?.target)return;const e=this.getElement(this.elementData.target);this.selectedEntityB={value:e.recordId,displayValue:e.caption}}initializeConnectionType(){if(!this.elementData?.relationshipType?.connectionType)return;const e=this.elementData.relationshipType.connectionType;let n=e.id;this.isNew?(n=this.isFormalConnectionAddingDisabled()?N.notFormal.id:n,this.initializeConnectionTypeById(n)):this.selectedConnectionType={value:n,displayValue:e.name}}initializeConnectionTypeById(e){this.getConnectionTypeControlLookupValues().pipe((0,_.take)(1)).subscribe(n=>{this.selectedConnectionType=n.find(i=>i.value===e)})}initializeExcludedConnectionTypes(){!this.sourceElement||!this.targetElement||(this.excludedConnectionTypes=U.getUnsupportedConnectionTypesIds(this.sourceElement,this.targetElement))}initializeRelationshipType(){!this.elementData?.relationshipType?.id||(this.selectedRelationshipType={value:this.elementData?.relationshipType.id,displayValue:this.elementData?.relationshipType.name})}initializeComment(){this.comment=this.elementData?.comment||""}onSavedCard(){if(!this.isNeedActualizeDiagram())return(0,l.of)(!0).pipe((0,_.delay)(1));const e=this.buildServerElement(),n=this.isNew?this.designerService.createConnection(e):this.designerService.updateConnection(e);return this.sendGtmAction({action:this.isNew?W.AddElement:W.EditConnection}),n.pipe((0,_.switchMap)(i=>{const o=i?.success;return o||this.showErrorDialog(i),(0,l.of)(o).pipe((0,_.delay)(1))}))}validate(){let e=super.validate();return e=e&&!!this.selectedConnectionType&&!!this.selectedRelationshipType&&!!this.selectedEntityA&&!!this.selectedEntityB,e}isChanged(){let e=super.isChanged();const n=this.elementData,i=this.getElementByRecordId(this.selectedEntityB.value);return e=e||!i||i.id!==n.target,e=e||this.selectedConnectionType?.value!==n.relationshipType.connectionType.id,e=e||this.selectedRelationshipType?.value!==n.relationshipType.id,e=e||this.comment!==n.comment,e}buildServerElement(){return{id:this.elementData.originalId||this.elementData.id,diagramId:this.data.id,relationshipRecordA:{id:this.selectedEntityA.value,schemaName:this.sourceConfig.caption},relationshipRecordB:{id:this.selectedEntityB.value,schemaName:this.targetConfig.caption},relationshipType:this.selectedRelationshipType.value,comment:this.comment}}doDeleteConnection(){if(this.isNew){this.forceCloseCard(!0);return}this.showMask(),this.subscription.add(this.designerService.deleteConnection(this.elementData.originalId).subscribe(e=>{if(!e?.success){this.hideMask(),this.showErrorDialog(e);return}this.forceCloseCard(!0),this.hideMask(),this.sendGtmAction({action:W.DeleteElement})}))}forceCloseCard(e=!1){this.propertiesPageEventService.closeCard({isForced:!0,isNeedDiagramReload:e})}getControlLookupValues(e){return this.lookupDataService.getFilteredLookupItems({value:e.value,schemaName:e.schemaName,excludedRecords:e.excludedRecords,additionalColumns:e.additionalColumns,additionalFilters:e.additionalFilters,displayValueFilters:e.displayValueFilters,displayValueGetter:e.displayValueGetter})}isFormalConnectionAddingDisabled(){const e=U.hasParent(this.sourceElement),n=U.hasParent(this.targetElement),i=this.targetConfig.caption==="Account";return e&&n&&this.sourceElement.parent!==this.targetElement.parent||e&&i}getExcludedConnectionTypes(){return this.isFormalConnectionAddingDisabled()?[N.formal.id]:[]}getConnectionTypeControlLookupValues(e=""){const n=this.excludedConnectionTypes?.length?this.excludedConnectionTypes:this.getExcludedConnectionTypes();return this.getControlLookupValues({value:e,schemaName:this.connectionTypeSchemaName,excludedRecords:n})}getRelationTypeAdditionalFilterGroup(){const e="For"+this.sourceConfig.caption+this.targetConfig.caption,n=new f.FilterGroup;n.addSchemaColumnFilterWithParameter(f.ComparisonType.Equal,e,!0);let i=this.selectedConnectionType?.value;return!i&&this.isFormalConnectionAddingDisabled()&&(i=N.notFormal.id),i&&n.addSchemaColumnFilterWithParameter(f.ComparisonType.Equal,"RelationConnectionType.Id",i),n}getRelationshipTypeControlLookupValues(e=""){return this.getControlLookupValues({value:e,schemaName:this.relationshipTypeSchemaName,additionalColumns:["ReverseRelationType.Name","RelationConnectionType.Id","RelationConnectionType.Name"],additionalFilters:[this.getRelationTypeAdditionalFilterGroup()],displayValueFilters:["Name","ReverseRelationType.Name"],displayValueGetter:n=>n.Name+" - "+n["ReverseRelationType.Name"]})}getEntityAControlLookupValues(e=""){return this.getControlLookupValues({value:e,schemaName:this.sourceConfig.caption})}getEntityBControlLookupValues(e=""){return this.getControlLookupValues({value:e,schemaName:this.targetConfig.caption,excludedRecords:this.getExcludedEntityBControlValuesFilter()})}getExcludedEntityBControlValuesFilter(){const e=[];return this.addSelfExcludeFilterIfNeed(e),e}addSelfExcludeFilterIfNeed(e){this.targetConfig.caption===this.sourceConfig.caption&&e.push(this.sourceElement.recordId)}getGtmSchemaName(){return"ConnectionPropertiesPageComponent"}onConnectionTypeChange(e){this.selectedConnectionType=null,this.connectionTypes=this.getConnectionTypeControlLookupValues(e)}onConnectionTypeSelected(e){this.selectedConnectionType=e,this.connectionTypes=null,this.selectedRelationshipType=null}onRelationshipTypeChange(e){this.selectedRelationshipType=null,this.relationshipTypes=this.getRelationshipTypeControlLookupValues(e)}onRelationshipTypeSelected(e){this.selectedRelationshipType=e,this.selectedRelationshipType?.row&&(this.selectedConnectionType={value:this.selectedRelationshipType?.row["RelationConnectionType.Id"],displayValue:this.selectedRelationshipType?.row["RelationConnectionType.Name"]}),this.relationshipTypes=null}onEntityAChange(e){this.selectedEntityA=null,this.entitiesA=this.getEntityAControlLookupValues(e)}onEntityASelected(e){this.selectedEntityA=e,this.entitiesA=null}onEntityBChange(e){this.selectedEntityB=null,this.entitiesB=this.getEntityBControlLookupValues(e)}onEntityBSelected(e){this.selectedEntityB=e,this.entitiesB=null}getControlDisplayValue(e){return e?e.displayValue||e.value:""}getControlErrorMessage(){return this.translateService.instant("RelationshipDesigner.RequiredControlErrorMessage")}onCommentChange(e){this.comment=e}deleteConnection(){this._relationshipDeleteDialogService.confirmRemoving("RelationshipDesigner.DeleteItemMessage").subscribe(e=>{e&&this.doDeleteConnection()})}onConnectionTypeFocus(e){this.connectionTypes=this.getConnectionTypeControlLookupValues()}onRelationshipTypeFocus(e){this.relationshipTypes=this.getRelationshipTypeControlLookupValues()}onEntityAFocus(e){this.entitiesA=this.getEntityAControlLookupValues()}onEntityBFocus(e){this.entitiesB=this.getEntityBControlLookupValues()}static{this.\u0275fac=function(n){return new(n||A)(t.\u0275\u0275directiveInject(t.Injector))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:A,selectors:[["crt-connection-properties-page"]],features:[t.\u0275\u0275InheritDefinitionFeature],decls:59,vars:52,consts:[["class","component-mask",4,"ngIf"],[1,"header"],[1,"title-wrap"],[1,"logo-wrap"],[1,"logo"],[1,"title"],[1,"title-control-group"],["floatLabel","always"],["type","text","matInput","","required","",3,"matAutocomplete","value","keyup","focus"],["connectionTypeTrigger","matAutocompleteTrigger"],[4,"ngIf"],["crtLegacyAutocompleteOverlayClick","",3,"legacyAutocompleteTrigger","legacyAutocomplete","displayWith","optionSelected"],["connectionTypeAuto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","",1,"delete-icon",3,"click"],[1,"content"],["relationshipTypeTrigger","matAutocompleteTrigger"],["relationshipTypeAuto","matAutocomplete"],[1,"group-label"],["type","text","matInput","","disabled","",3,"matAutocomplete","value","keyup","focus"],["entityATrigger","matAutocompleteTrigger"],["entityAAuto","matAutocomplete"],["entityBTrigger","matAutocompleteTrigger"],["entityBAuto","matAutocomplete"],[1,"divider"],["floatLabel","always",1,"text-area"],["matInput","","name","message",3,"value","change"],[1,"component-mask"],[3,"value"]],template:function(n,i){if(n&1&&(t.\u0275\u0275template(0,ft,1,0,"ts-mask",0),t.\u0275\u0275elementStart(1,"div",1)(2,"div",2)(3,"div",3),t.\u0275\u0275element(4,"div",4),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",5),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(8,"div",6)(9,"mat-form-field",7)(10,"input",8,9),t.\u0275\u0275listener("keyup",function(a){return i.onConnectionTypeChange(a.target.value)})("focus",function(a){return i.onConnectionTypeFocus(a.target.value)}),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(12,_t,2,1,"mat-hint",10),t.\u0275\u0275elementStart(13,"mat-autocomplete",11,12),t.\u0275\u0275listener("optionSelected",function(a){return i.onConnectionTypeSelected(a.option.value)}),t.\u0275\u0275template(15,It,2,2,"mat-option",13),t.\u0275\u0275pipe(16,"async"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(17,"button",14),t.\u0275\u0275listener("click",function(){return i.deleteConnection()}),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(18,"div",15)(19,"mat-form-field",7)(20,"mat-label"),t.\u0275\u0275text(21),t.\u0275\u0275pipe(22,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(23,"input",8,16),t.\u0275\u0275listener("keyup",function(a){return i.onRelationshipTypeChange(a.target.value)})("focus",function(a){return i.onRelationshipTypeFocus(a.target.value)}),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(25,vt,2,1,"mat-hint",10),t.\u0275\u0275elementStart(26,"mat-autocomplete",11,17),t.\u0275\u0275listener("optionSelected",function(a){return i.onRelationshipTypeSelected(a.option.value)}),t.\u0275\u0275template(28,Dt,2,2,"mat-option",13),t.\u0275\u0275pipe(29,"async"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(30,"span",18),t.\u0275\u0275text(31),t.\u0275\u0275pipe(32,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(33,"mat-form-field",7)(34,"mat-label"),t.\u0275\u0275text(35),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(36,"input",19,20),t.\u0275\u0275listener("keyup",function(a){return i.onEntityAChange(a.target.value)})("focus",function(a){return i.onEntityAFocus(a.target.value)}),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(38,xt,2,1,"mat-hint",10),t.\u0275\u0275elementStart(39,"mat-autocomplete",11,21),t.\u0275\u0275listener("optionSelected",function(a){return i.onEntityASelected(a.option.value)}),t.\u0275\u0275template(41,Pt,2,2,"mat-option",13),t.\u0275\u0275pipe(42,"async"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(43,"mat-form-field",7)(44,"mat-label"),t.\u0275\u0275text(45),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(46,"input",8,22),t.\u0275\u0275listener("keyup",function(a){return i.onEntityBChange(a.target.value)})("focus",function(a){return i.onEntityBFocus(a.target.value)}),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(48,bt,2,1,"mat-hint",10),t.\u0275\u0275elementStart(49,"mat-autocomplete",11,23),t.\u0275\u0275listener("optionSelected",function(a){return i.onEntityBSelected(a.option.value)}),t.\u0275\u0275template(51,Et,2,2,"mat-option",13),t.\u0275\u0275pipe(52,"async"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275element(53,"mat-divider",24),t.\u0275\u0275elementStart(54,"mat-form-field",25)(55,"mat-label"),t.\u0275\u0275text(56),t.\u0275\u0275pipe(57,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(58,"textarea",26),t.\u0275\u0275listener("change",function(a){return i.onCommentChange(a.target.value)}),t.\u0275\u0275elementEnd()()()),n&2){const o=t.\u0275\u0275reference(11),a=t.\u0275\u0275reference(14),s=t.\u0275\u0275reference(24),p=t.\u0275\u0275reference(27),it=t.\u0275\u0275reference(37),q=t.\u0275\u0275reference(40),ot=t.\u0275\u0275reference(47),lt=t.\u0275\u0275reference(50);t.\u0275\u0275property("ngIf",i.isLoading),t.\u0275\u0275advance(6),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(7,36,"ConnectionPropertiesPage.Title")),t.\u0275\u0275advance(4),t.\u0275\u0275property("matAutocomplete",a)("value",i.selectedConnectionType==null?null:i.selectedConnectionType.displayValue),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!i.selectedConnectionType),t.\u0275\u0275advance(1),t.\u0275\u0275property("legacyAutocompleteTrigger",o)("legacyAutocomplete",a)("displayWith",i.getControlDisplayValue),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(16,38,i.connectionTypes)),t.\u0275\u0275advance(6),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(22,40,"ConnectionPropertiesPage.RelationshipType")),t.\u0275\u0275advance(2),t.\u0275\u0275property("matAutocomplete",p)("value",i.selectedRelationshipType==null?null:i.selectedRelationshipType.displayValue),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!i.selectedRelationshipType),t.\u0275\u0275advance(1),t.\u0275\u0275property("legacyAutocompleteTrigger",s)("legacyAutocomplete",p)("displayWith",i.getControlDisplayValue),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(29,42,i.relationshipTypes)),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(32,44,"ConnectionPropertiesPage.Relations")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(i.sourceConfig==null||i.sourceConfig.entitySchemaData==null?null:i.sourceConfig.entitySchemaData.caption),t.\u0275\u0275advance(1),t.\u0275\u0275property("matAutocomplete",q)("value",i.selectedEntityA==null?null:i.selectedEntityA.displayValue),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!i.selectedEntityA),t.\u0275\u0275advance(1),t.\u0275\u0275property("legacyAutocompleteTrigger",it)("legacyAutocomplete",q)("displayWith",i.getControlDisplayValue),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(42,46,i.entitiesA)),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(i.targetConfig==null||i.targetConfig.entitySchemaData==null?null:i.targetConfig.entitySchemaData.caption),t.\u0275\u0275advance(1),t.\u0275\u0275property("matAutocomplete",lt)("value",i.selectedEntityB==null?null:i.selectedEntityB.displayValue),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!i.selectedEntityB),t.\u0275\u0275advance(1),t.\u0275\u0275property("legacyAutocompleteTrigger",ot)("legacyAutocomplete",lt)("displayWith",i.getControlDisplayValue),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(52,48,i.entitiesB)),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(57,50,"ConnectionPropertiesPage.Comment")),t.\u0275\u0275advance(2),t.\u0275\u0275property("value",i.comment)}},dependencies:[g.NgForOf,g.NgIf,h.MaskComponent,D.MatLegacyAutocomplete,D.MatLegacyAutocompleteTrigger,mt.MatLegacyOption,M.MatLegacyButton,R.MatDivider,m.MatLegacyFormField,m.MatLegacyHint,m.MatLegacyLabel,w.MatLegacyInput,nt,g.AsyncPipe,C.TranslatePipe],styles:["[_nghost-%COMP%]{display:block;position:relative;height:100%}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-right:0}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-right:10px;text-align:right}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.open-card[_ngcontent-%COMP%]{transform:rotate(-90deg)}.rtl[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:right}.header[_ngcontent-%COMP%]{max-width:343px;padding:12px 20px 0;min-height:97px;max-height:135px;border-top-left-radius:8px;border-top-right-radius:8px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]{height:56px;margin-top:5px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-top:7px;flex:0 0 69px;width:72px;height:56px;display:inline-flex;justify-content:center;align-items:center;margin-right:16px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{background-position:center;background-repeat:no-repeat}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:inline-block;letter-spacing:0px;text-align:left;margin-top:3px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;margin-top:7px;margin-right:10px;justify-content:flex-end;align-items:center}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{width:16px;height:16px;font-size:16px}.content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;width:100%;position:absolute;overflow-x:hidden;overflow-y:auto;height:auto;bottom:0;top:135px}.content[_ngcontent-%COMP%]:last-child{padding-bottom:0}.content[_ngcontent-%COMP%]   .text-area[_ngcontent-%COMP%]{min-width:150px;width:100%}.content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:left;letter-spacing:0px}",'.rtl[_nghost-%COMP%]   .title-control-group[_ngcontent-%COMP%]{width:300px}.rtl[_nghost-%COMP%]   .title-control-group[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{padding:revert;margin-left:0}.rtl[_nghost-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]{margin-left:-50px}.logo[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMC45MDgiIGhlaWdodD0iMTEuMDI5IiB2aWV3Qm94PSIwIDAgMTAuOTA4IDExLjAyOSI+PGRlZnM+PHN0eWxlPi5he2ZpbGw6bm9uZTtzdHJva2U6IzU0NjU3ZDt9PC9zdHlsZT48L2RlZnM+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4zNTYgMC40NDcpIj48cGF0aCBjbGFzcz0iYSIgZD0iTTQuMTMxLDEwLjIzLDE0LjIzNiwwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNC4xMzEpIi8+PGxpbmUgY2xhc3M9ImEiIHkxPSIyLjEyNSIgeDI9IjQuMjUxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1Ljg1NSkiLz48bGluZSBjbGFzcz0iYSIgeTE9IjQuMjUxIiB4Mj0iMi4xMjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDcuOTgpIi8+PC9nPjwvc3ZnPg==);width:24px;height:24px}.title-control-group[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:324px}.title-control-group[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%}.title-control-group[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{font-family:bpmonline designer icons;line-height:1px;line-height:.6px;font-size:24px;height:24px;width:24px;opacity:.8;margin:19px 19px 10px 5px}.title-control-group[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]:before{content:"\\e92c"!important;display:inline;position:relative}.content[_ngcontent-%COMP%]{padding:20px}.content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .mat-divider[_ngcontent-%COMP%]{padding-bottom:20px}.content[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{margin:8px -20px 0}']})}}var St=c(8785);function wt(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-option",13),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),r&2){const n=e.$implicit;t.\u0275\u0275property("value",n),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",n.displayValue," ")}}function Ot(r,e){if(r&1){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-form-field",4)(1,"mat-label"),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"input",9),t.\u0275\u0275listener("keyup",function(o){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.onGroupChange(o.target.value))})("focus",function(o){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.onGroupFocus(o.target.value))}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"mat-autocomplete",10,11),t.\u0275\u0275listener("optionSelected",function(o){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.onGroupSelected(o.option.value))}),t.\u0275\u0275template(7,wt,2,2,"mat-option",12),t.\u0275\u0275pipe(8,"async"),t.\u0275\u0275elementEnd()()}if(r&2){const n=t.\u0275\u0275reference(6),i=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,5,"EntityInGroupPropertiesDialog.Group")),t.\u0275\u0275advance(2),t.\u0275\u0275property("matAutocomplete",n)("value",i.selectedGroup==null?null:i.selectedGroup.displayValue),t.\u0275\u0275advance(1),t.\u0275\u0275property("displayWith",i.getControlDisplayValue),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(8,7,i.groups))}}function Tt(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-option",13),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),r&2){const n=e.$implicit;t.\u0275\u0275property("value",n),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",n.displayValue," ")}}function Lt(r,e){if(r&1){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-form-field",4)(1,"mat-label"),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"input",9),t.\u0275\u0275listener("keyup",function(o){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.onEntityChange(o.target.value))})("focus",function(o){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.onEntityFocus(o.target.value))}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"mat-autocomplete",10,14),t.\u0275\u0275listener("optionSelected",function(o){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.onEntitySelected(o.option.value))}),t.\u0275\u0275template(6,Tt,2,2,"mat-option",12),t.\u0275\u0275pipe(7,"async"),t.\u0275\u0275elementEnd()()}if(r&2){const n=t.\u0275\u0275reference(5),i=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(i.itemTypeSchemaCaption),t.\u0275\u0275advance(1),t.\u0275\u0275property("matAutocomplete",n)("value",i.selectedEntity==null?null:i.selectedEntity.displayValue),t.\u0275\u0275advance(1),t.\u0275\u0275property("displayWith",i.getControlDisplayValue),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(7,5,i.entities))}}class B{constructor(e,n){this.injector=n,this.itemTypeSchemaCaption="",this.isGroupVisible=!0,this.isEntityVisible=!0,this.isRtl=!1,this.injectDependencies(),this.initializeItemTypeSchemaCaption(),this.initializeEntityInGroup(e?.entityInGroup),this.initializeExludedGroups(e?.excludedGroups),this.initializeExludedEntityRecords(e?.exludedEntityRecords),this._initializeDirectionality()}_initializeDirectionality(){this.isRtl=this.directionality?.value==="rtl"}initializeExludedGroups(e){this.excludedGroups=e||[]}initializeExludedEntityRecords(e){this.excludedEntityRecords=e||[]}injectDependencies(){this.lookupDataService=this.injector.get(O),this.translateService=this.injector.get(C.TranslateService),this.diagramEventService=this.injector.get(d.BaseDiagramEventService),this.directionality=this.injector.get(Q.Directionality)}initializeItemTypeSchemaCaption(){var e=this;return(0,y.Z)(function*(){const i=(yield e.diagramEventService.getDiagramConfig())?.customDiagramElements[d.RelationshipElementType.relationshipItem]||{};e.itemTypeSchemaCaption=i.entitySchemaData?.caption||""})()}initializeEntityInGroup(e){!e||(this.entityInGroup=e,this.initializeComment(),this.initializeInputVisibility())}initializeComment(){this.entityInGroup?.comment||(this.entityInGroup.comment="")}initializeInputVisibility(){this.entityInGroup.groupId&&(this.isGroupVisible=!1),this.entityInGroup.entityId&&(this.isEntityVisible=!1)}getControlLookupValues(e){return this.lookupDataService.getFilteredLookupItems({value:e.value,schemaName:e.schemaName,excludedRecords:e.excludedRecords})}getGroupControlLookupValues(e=""){return this.getControlLookupValues({value:e,schemaName:"RelationshipGroup",excludedRecords:this.excludedGroups})}getContactControlLookupValues(e=""){return this.getControlLookupValues({value:e,schemaName:"Contact",excludedRecords:this.excludedEntityRecords})}isCardValid(){const e=!this.isEntityVisible||!!this.selectedEntity,n=!this.isGroupVisible||!!this.selectedGroup;return e&&n}getControlDisplayValue(e){return e?e.displayValue||e.value:""}onGroupChange(e){this.selectedGroup=null,this.groups=this.getGroupControlLookupValues(e)}onGroupSelected(e){this.selectedGroup=e,this.entityInGroup.groupId=e.value,this.groups=null}onGroupFocus(e){this.groups=this.getGroupControlLookupValues()}onEntityChange(e){this.selectedEntity=null,this.entities=this.getContactControlLookupValues(e)}onEntitySelected(e){this.selectedEntity=e;let n=this.entityInGroup.entityRecordData||{};n=Object.assign(n,{id:e.value,name:e.displayValue}),this.entityInGroup.entityRecordData=n,this.entities=null}onEntityFocus(e){this.entities=this.getContactControlLookupValues()}getDialogCaption(){const e=this.isGroupVisible||this.isEntityVisible?"AddToGroup":"Edit";return this.translateService.instant("EntityInGroupPropertiesDialog."+e)}static{this.\u0275fac=function(n){return new(n||B)(t.\u0275\u0275directiveInject(u.MAT_LEGACY_DIALOG_DATA),t.\u0275\u0275directiveInject(t.Injector))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:B,selectors:[["crt-entity-in-group-properties-dialog"]],hostVars:2,hostBindings:function(n,i){n&2&&t.\u0275\u0275classProp("rtl",i.isRtl)},decls:19,vars:15,consts:[[1,"add-entity-to-group-dialog"],["mat-dialog-title",""],["mat-dialog-content","",1,"relationship-dialog-content"],["floatLabel","always",4,"ngIf"],["floatLabel","always"],["type","text","matInput","",3,"value","input"],["mat-dialog-actions",""],["mat-button","",1,"crt-button",3,"mat-dialog-close"],["mat-flat-button","","color","accent",1,"action-button","crt-button",3,"mat-dialog-close","disabled"],["type","text","matInput","","required","",3,"matAutocomplete","value","keyup","focus"],[3,"displayWith","optionSelected"],["groupAutocomplete","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["contactAutocomplete","matAutocomplete"]],template:function(n,i){n&1&&(t.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"span"),t.\u0275\u0275text(3),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(4,"div",2),t.\u0275\u0275template(5,Ot,9,9,"mat-form-field",3),t.\u0275\u0275template(6,Lt,8,7,"mat-form-field",3),t.\u0275\u0275elementStart(7,"mat-form-field",4)(8,"mat-label"),t.\u0275\u0275text(9),t.\u0275\u0275pipe(10,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(11,"input",5),t.\u0275\u0275listener("input",function(a){return i.entityInGroup.comment=a.target.value}),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(12,"div",6)(13,"button",7),t.\u0275\u0275text(14),t.\u0275\u0275pipe(15,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(16,"button",8),t.\u0275\u0275text(17),t.\u0275\u0275pipe(18,"translate"),t.\u0275\u0275elementEnd()()()),n&2&&(t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(i.getDialogCaption()),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",i.isGroupVisible),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.isEntityVisible),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(10,9,"EntityInGroupPropertiesDialog.Comment")),t.\u0275\u0275advance(2),t.\u0275\u0275property("value",i.entityInGroup==null?null:i.entityInGroup.comment),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(15,11,"EntityInGroupPropertiesDialog.Cancel")," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("mat-dialog-close",i.entityInGroup)("disabled",!i.isCardValid()),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(18,13,"EntityInGroupPropertiesDialog.Save")," "))},dependencies:[g.NgForOf,g.NgIf,D.MatLegacyAutocomplete,D.MatLegacyAutocompleteTrigger,mt.MatLegacyOption,M.MatLegacyButton,u.MatLegacyDialogClose,u.MatLegacyDialogTitle,u.MatLegacyDialogContent,u.MatLegacyDialogActions,m.MatLegacyFormField,m.MatLegacyLabel,w.MatLegacyInput,g.AsyncPipe,C.TranslatePipe],styles:["[_nghost-%COMP%]{min-width:240px}[_nghost-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-top:4px;font-family:var(--crt-headline-2-font-family);font-size:var(--crt-headline-2-font-size);line-height:var(--crt-headline-2-line-height);font-weight:var(--crt-headline-2-font-weight);letter-spacing:var(--crt-headline-2-letter-spacing);text-transform:var(--crt-headline-2-text-transform);-webkit-font-smoothing:antialiased;color:var(--crt-palette-primary-500, var(--palette-primary-500))}.rtl[_nghost-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%]{text-align:right}.rtl[_nghost-%COMP%]   .mat-autocomplete.mat-autocomplete[_ngcontent-%COMP%]:after{right:auto}.mat-dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}.mat-dialog-content[_ngcontent-%COMP%]   .mat-form-field-wrapper[_ngcontent-%COMP%]   .mat-form-field-label-wrapper[_ngcontent-%COMP%]   .mat-form-field-required-marker[_ngcontent-%COMP%]{color:#f44336}.mat-dialog-actions[_ngcontent-%COMP%]{justify-content:flex-end}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%], .mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]{font-family:var(--crt-button-font-family, var(--button-font-family));font-size:var(--crt-button-font-size, var(--button-font-size));font-weight:var(--crt-button-font-weight, var(--button-font-weight));text-transform:var(--crt-button-text-transform, uppercase);border-radius:var(--button-border-radius, var(--button-rounded-border-radius))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[disabled][_ngcontent-%COMP%]{color:var(--crt-palette-disabled-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-disabled-50, rgba(var(--disabled-button-background), 1))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]){color:var(--crt-palette-primary-contrast-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-primary-500, var(--palette-primary-500))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):focus{color:var(--crt-palette-primary-contrast-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-primary-500, var(--palette-primary-500))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):hover, .mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]).cdk-keyboard-focused{background-color:var(--crt-palette-primary-800, var(--palette-primary-800))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):active{background-color:var(--crt-palette-primary-900, var(--palette-primary-800))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{color:var(--crt-palette-secondary-500, var(--palette-primary-500))!important}"]})}}const Nt=["colorBox"];function jt(r,e){if(r&1){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"color-github",15),t.\u0275\u0275listener("onChangeComplete",function(o){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.onChangeColor(o))}),t.\u0275\u0275elementEnd()}if(r&2){const n=t.\u0275\u0275nextContext();t.\u0275\u0275styleProp("left",n.colorPickerPosition.x,"px")("top",n.colorPickerPosition.y,"px"),t.\u0275\u0275property("triangle","top-right")("color",n.group.color)("colors",n.colors)("width",187)}}class Z{constructor(e,n,i){this.translateService=n,this.isNew=!0,this.colors=["#FF2031","#C40069","#C400A9","#8400C4","#5200C4","#2B00C4","#005BC4","#0076C4","#009FC4","#29A5A1","#00C4A8","#00C46D","#00C407","#A3C400"],this.isColorTabVisible=!1,this.colorPickerPosition={x:0,y:0},this.group={id:(0,f.generateGuid)(),name:"",color:"#000000",comment:""},this.isRtl=!1,e?.group?(this.group=e.group,this.isNew=!1):this.initializeColor(),this._initializeDirectionality(i)}_initializeDirectionality(e){this.isRtl=e?.value==="rtl"}initializeColor(){const e=Math.floor(Math.random()*Math.floor(this.colors.length-1));this.group.color=this.colors[e]}initializeColorPickerPostion(){const e=this.colorBox?.nativeElement;if(!e)return;let n=e.offsetLeft,i=e.offsetTop;i+=30,n-=145,this.colorPickerPosition={x:n,y:i}}showColorTab(){this.initializeColorPickerPostion(),this.isColorTabVisible=!0}onChangeColor(e){this.group.color=e.color.hex}onGlobalClick(e){this.colorBox.nativeElement.contains(e.target)||(this.isColorTabVisible=!1)}getDialogCaption(){const e=this.isNew?"NewGroup":"EditGroup";return this.translateService.instant("GroupPropertiesDialog."+e)}static{this.\u0275fac=function(n){return new(n||Z)(t.\u0275\u0275directiveInject(u.MAT_LEGACY_DIALOG_DATA),t.\u0275\u0275directiveInject(C.TranslateService),t.\u0275\u0275directiveInject(Q.Directionality))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:Z,selectors:[["crt-group-properties-dialog"]],viewQuery:function(n,i){if(n&1&&t.\u0275\u0275viewQuery(Nt,5,t.ElementRef),n&2){let o;t.\u0275\u0275queryRefresh(o=t.\u0275\u0275loadQuery())&&(i.colorBox=o.first)}},hostVars:2,hostBindings:function(n,i){n&1&&t.\u0275\u0275listener("mousedown",function(a){return i.onGlobalClick(a)},!1,t.\u0275\u0275resolveDocument),n&2&&t.\u0275\u0275classProp("rtl",i.isRtl)},decls:27,vars:20,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"relationship-dialog-content"],[1,"flex-row-control-group"],["floatLabel","always",1,"name-control"],["matInput","","type","text","required","",3,"value","input"],["floatLabel","always"],["matInput","","type","text",3,"value","input"],[1,"color-box-wrap"],["colorBox",""],[1,"color-box"],[1,"choose-button",3,"click"],["class","color-picker",3,"left","top","triangle","color","colors","width","onChangeComplete",4,"ngIf"],["mat-dialog-actions",""],["mat-button","","cdkFocusInitial","",1,"crt-button",3,"mat-dialog-close"],["mat-flat-button","","color","accent",1,"crt-button",3,"mat-dialog-close","disabled"],[1,"color-picker",3,"triangle","color","colors","width","onChangeComplete"]],template:function(n,i){n&1&&(t.\u0275\u0275elementStart(0,"div",0)(1,"span"),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(3,"div",1)(4,"div",2)(5,"mat-form-field",3)(6,"mat-label"),t.\u0275\u0275text(7),t.\u0275\u0275pipe(8,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(9,"input",4),t.\u0275\u0275listener("input",function(a){return i.group.name=a.target.value}),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(10,"mat-form-field",5)(11,"mat-label"),t.\u0275\u0275text(12),t.\u0275\u0275pipe(13,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(14,"input",6),t.\u0275\u0275listener("input",function(a){return i.group.comment=a.target.value}),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(15,"div",7,8),t.\u0275\u0275element(17,"div",9),t.\u0275\u0275elementStart(18,"div",10),t.\u0275\u0275listener("click",function(){return i.showColorTab()}),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(19,jt,1,8,"color-github",11),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(20,"div",12)(21,"button",13),t.\u0275\u0275text(22),t.\u0275\u0275pipe(23,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(24,"button",14),t.\u0275\u0275text(25),t.\u0275\u0275pipe(26,"translate"),t.\u0275\u0275elementEnd()()),n&2&&(t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(i.getDialogCaption()),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(8,12,"GroupPropertiesDialog.Name")),t.\u0275\u0275advance(2),t.\u0275\u0275property("value",i.group.name),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(13,14,"GroupPropertiesDialog.Comment")),t.\u0275\u0275advance(2),t.\u0275\u0275property("value",i.group.comment),t.\u0275\u0275advance(3),t.\u0275\u0275styleProp("background",i.group.color),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",i.isColorTabVisible),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(23,16,"GroupPropertiesDialog.Cancel")," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("mat-dialog-close",i.group)("disabled",!(i.group!=null&&i.group.name)),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(26,18,"GroupPropertiesDialog.Save")," "))},dependencies:[g.NgIf,pt.GithubComponent,M.MatLegacyButton,u.MatLegacyDialogClose,u.MatLegacyDialogTitle,u.MatLegacyDialogContent,u.MatLegacyDialogActions,m.MatLegacyFormField,m.MatLegacyLabel,w.MatLegacyInput,C.TranslatePipe],styles:["[_nghost-%COMP%]{min-width:240px}[_nghost-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-top:4px;font-family:var(--crt-headline-2-font-family, var(--dialog-title-font-family));font-size:var(--crt-headline-2-font-size, var(--dialog-title-font-size));line-height:var(--crt-headline-2-line-height, var(--dialog-title-line-height));font-weight:var(--crt-headline-2-font-weight, var(--dialog-title-font-weight));color:var(--crt-palette-primary-500, var(--palette-primary-500))}.rtl[_nghost-%COMP%]   .mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]{margin-right:30px}.rtl[_nghost-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%]{text-align:right}.mat-dialog-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.mat-dialog-content[_ngcontent-%COMP%]   .flex-row-control-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1}.mat-dialog-content[_ngcontent-%COMP%]   .flex-row-control-group[_ngcontent-%COMP%]   .name-control[_ngcontent-%COMP%]{width:100%}.mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]{height:16px;width:32px;display:flex;margin-left:10px;flex-direction:row;margin-top:20px}.mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]   .color-box[_ngcontent-%COMP%]{height:16px;width:16px;border:1px solid #cccccc}.mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]   .choose-button[_ngcontent-%COMP%]{height:16px;width:16px;background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmF7ZmlsbDojNTQ2NTdkO30uYntmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNzgzLjc3OSA3NC40NTUpIj48cGF0aCBjbGFzcz0iYSIgZD0iTTE3ODcuNzc5LTY3LjQ1NWw0LDQsNC00WiIvPjwvZz48cmVjdCBjbGFzcz0iYiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+PC9zdmc+);background-position:center;background-repeat:no-repeat}.mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]   .choose-button[_ngcontent-%COMP%]:hover{cursor:pointer}.mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]   .color-picker[_ngcontent-%COMP%]{position:absolute;z-index:2600}.mat-dialog-content[_ngcontent-%COMP%]   .mat-form-field-wrapper[_ngcontent-%COMP%]   .mat-form-field-label-wrapper[_ngcontent-%COMP%]   mat-label[_ngcontent-%COMP%]{font-family:var(--crt-font-family, var(--font-family))}.mat-dialog-content[_ngcontent-%COMP%]   .mat-form-field-wrapper[_ngcontent-%COMP%]   .mat-form-field-label-wrapper[_ngcontent-%COMP%]   .mat-form-field-required-marker[_ngcontent-%COMP%]{color:#f44336}.mat-dialog-actions[_ngcontent-%COMP%]{justify-content:flex-end}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%], .mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]{font-family:var(--crt-button-font-family, var(--button-font-family));font-size:var(--crt-button-font-size, var(--button-font-size));font-weight:var(--crt-button-font-weight, var(--button-font-weight));text-transform:var(--crt-button-text-transform, uppercase);border-radius:var(--button-border-radius, var(--button-rounded-border-radius))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[disabled][_ngcontent-%COMP%]{color:var(--crt-palette-disabled-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-disabled-50, rgba(var(--disabled-button-background), 1))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]){color:var(--crt-palette-primary-contrast-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-primary-500, var(--palette-primary-500))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):focus{color:var(--crt-palette-primary-contrast-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-primary-500, var(--palette-primary-500))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):hover, .mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]).cdk-keyboard-focused{background-color:var(--crt-palette-primary-800, var(--palette-primary-800))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):active{background-color:var(--crt-palette-primary-900, var(--palette-primary-800))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{color:var(--crt-palette-secondary-500, var(--palette-primary-500))!important}"]})}}function Gt(r,e){if(r&1){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",21),t.\u0275\u0275listener("click",function(o){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext().$implicit,s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.addEntityToGroup(o,a.id))}),t.\u0275\u0275elementEnd()}}const zt=function(r){return{"background-image":r}};function At(r,e){if(r&1){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-list-item",22)(1,"div",23)(2,"div",24),t.\u0275\u0275element(3,"div",25),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"div",26)(5,"div",27),t.\u0275\u0275text(6),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(7,"div",28)(8,"div"),t.\u0275\u0275text(9),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(10,"div",29),t.\u0275\u0275element(11,"button",30),t.\u0275\u0275elementStart(12,"mat-menu",14,31)(14,"button",17),t.\u0275\u0275listener("click",function(){const a=t.\u0275\u0275restoreView(n).$implicit,s=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(s.editEntityInGroup(a))}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(15,"button",18),t.\u0275\u0275listener("click",function(){const a=t.\u0275\u0275restoreView(n).$implicit,s=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(s.deleteEntityFromGroup(a.entityId,a.groupId))}),t.\u0275\u0275elementEnd()()()(),t.\u0275\u0275elementStart(16,"div",32),t.\u0275\u0275text(17),t.\u0275\u0275elementEnd()()()()}if(r&2){const n=e.$implicit,i=t.\u0275\u0275reference(13);t.\u0275\u0275advance(3),t.\u0275\u0275property("ngStyle",t.\u0275\u0275pureFunction1(5,zt,"url("+(n.entityRecordData==null?null:n.entityRecordData.image)+")")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(n.entityRecordData.type),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(n.entityRecordData.name),t.\u0275\u0275advance(2),t.\u0275\u0275property("matMenuTriggerFor",i),t.\u0275\u0275advance(6),t.\u0275\u0275textInterpolate(n.comment)}}function Rt(r,e){if(r&1){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-list-item",2)(1,"mat-expansion-panel",3)(2,"mat-expansion-panel-header",4)(3,"div",5)(4,"div",6),t.\u0275\u0275element(5,"mat-icon",7),t.\u0275\u0275elementStart(6,"div",8)(7,"div",9),t.\u0275\u0275text(8),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(9,"div",10),t.\u0275\u0275text(10),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(11,"div",11),t.\u0275\u0275template(12,Gt,1,0,"button",12),t.\u0275\u0275elementStart(13,"button",13),t.\u0275\u0275listener("click",function(o){return o==null?null:o.stopPropagation()}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(14,"mat-menu",14,15)(16,"button",16),t.\u0275\u0275listener("click",function(o){const s=t.\u0275\u0275restoreView(n).$implicit,p=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(p.toggleHighlightGroup(o,s.id))}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(17,"button",17),t.\u0275\u0275listener("click",function(){const a=t.\u0275\u0275restoreView(n).$implicit,s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.editGroup(a))}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(18,"button",18),t.\u0275\u0275listener("click",function(){const a=t.\u0275\u0275restoreView(n).$implicit,s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.deleteGroup(a.id))}),t.\u0275\u0275elementEnd()()()()(),t.\u0275\u0275elementStart(19,"mat-list",19),t.\u0275\u0275template(20,At,18,7,"mat-list-item",20),t.\u0275\u0275elementEnd()()()}if(r&2){const n=e.$implicit,i=t.\u0275\u0275reference(15),o=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("expanded",!0),t.\u0275\u0275advance(1),t.\u0275\u0275property("collapsedHeight","33px")("expandedHeight","33px"),t.\u0275\u0275advance(3),t.\u0275\u0275styleProp("background",n.color),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(n.name),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1("(",o.getGroupEntitiesCount(n),")"),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",o.isAddEntityToGroupButtonVisible()),t.\u0275\u0275advance(1),t.\u0275\u0275property("matMenuTriggerFor",i),t.\u0275\u0275advance(3),t.\u0275\u0275classProp("selectedGroup",o.highlightedGroupId===n.id),t.\u0275\u0275advance(4),t.\u0275\u0275property("ngForOf",n.entities)}}class V{set isLoading(e){this.groupContentListEventService.isLoading(e)}set filteredEntityId(e){e!==this._filteredEntityId&&(this._filteredEntityId=e)}set searchFilter(e){e!==this._searchFilter&&(this._searchFilter=e,this.renderGroup())}_initializeDirectionality(){this.isRtl=this.directionality?.value==="rtl"}_initializeGTM(){this._subscription.add(this.googleTagManagerService.initialize().subscribe())}constructor(e){this.injector=e,this._subscription=new l.Subscription,this._searchFilter="",this.groups=[],this.renderedGroups=[],this.searchFilterChange=new t.EventEmitter,this.changed=new t.EventEmitter,this.isRtl=!1,this.injectDependencies(),this.subscribePageEvent(),this._initializeDirectionality(),this._initializeGTM()}injectDependencies(){this.diagramEventService=this.injector.get(x.BaseDiagramEventService),this.directionality=this.injector.get(Q.Directionality),this.googleTagManagerService=this.injector.get(tt.GoogleTagManagerService),this.relationshipDesignerService=this.injector.get(b),this.groupContentListEventService=this.injector.get(T),this.dialogService=this.injector.get(h.DialogService),this.translateService=this.injector.get(C.TranslateService),this.relationshipDeleteDialogService=this.injector.get(E)}initializeGroups(){this.isLoading=!0;const e=this.relationshipDesignerService,n=this._filteredEntityId;(n?e.getGroupsDataForEntity(n):e.getGroupsData()).subscribe(o=>{if(!o?.success){this.isLoading=!1,this.showErrorDialog(o);return}this.groups=o.groups,this.renderGroup(),this.isLoading=!1})}renderGroup(){const e=(0,G.cloneDeep)(this.groups);this.renderedGroups=this.filteredGroupByFilter(e)}filteredGroupByFilter(e){const n=this._searchFilter?.toLocaleLowerCase();return n?e.filter(i=>{let o=i.entities||[];return o=o.filter(a=>{const s=a.entityRecordData?.name||"";return this.isStringContain(s,n)}),i.entities=o,o.length===0?this.isStringContain(i.name,n)?i:!1:i}):e}isStringContain(e,n){return e.toLowerCase().indexOf(n)>=0}clearSearchFilter(){this._searchFilter="",this.searchFilterChange.emit(this._searchFilter),this.renderGroup()}showErrorDialog(e){if(e?.success)return;const n=e?.errorInfo?.message||"An unknown error occurred during the operation.";this._subscription.add(this.dialogService.openInfoDialog(n).subscribe())}handleBaseDialogAction(e,n,i){!e||(this.isLoading=!0,n.call(this.relationshipDesignerService,e).subscribe(o=>this.handleBaseResponseAction(o,i)))}handleBaseResponseAction(e,n){if(!e?.success){this.isLoading=!1,this.showErrorDialog(e);return}n(),this.clearSearchFilter(),this.isLoading=!1,this.changed.emit(this.groups)}subscribePageEvent(){const e=this.groupContentListEventService;this._subscription.add(e.createGroup$.subscribe(()=>this.createGroup())),this._subscription.add(e.addEntityToGroup$.subscribe(n=>this.doAddEntityToGroup(n))),this._subscription.add(e.initializeGroups$.subscribe(()=>this.initializeGroups()))}addGroupToList(e){this.groups.push(e)}updateGroupInList(e){const n=this.groups.findIndex(i=>i.id===e.id);this.groups[n]=e}deleteGroupFromList(e){const n=this.groups.findIndex(i=>i.id===e);this.groups.splice(n,1),this.diagramEventService.entityInGroupRemoving()}doAddEntityToGroup(e){const n={panelClass:["relationship-dialog-edit"],data:{entityInGroup:e,excludedGroups:this.getExcludedGroupsList(),exludedEntityRecords:this.getExcludedEntityRecords(e)},autoFocus:!1},i=this.dialogService.open(B,n).subscribe(o=>{this.handleBaseDialogAction(o,this.relationshipDesignerService.createEntityInGroup,()=>{this.addEntityInGroupToList(o),this.diagramEventService.entityInGroupAdded(),this.sendGtmAction({action:W.AddEntityInGroup})})});this._subscription.add(i)}addEntityInGroupToList(e){this.initializeGroups()}updateEntityInGroupInList(e){const n=this.groups.find(o=>o.id===e.groupId),i=n.entities.findIndex(o=>o.id===e.id);n.entities[i]=e}deleteEntityInGroupFromList(e,n){const i=this.groups.find(a=>a.id===n),o=i.entities.findIndex(a=>a.entityId===e);i.entities.splice(o,1)}getExcludedGroupsList(){return this._filteredEntityId?this.groups.map(e=>e.id):[]}getExcludedEntityRecords(e){if(this._filteredEntityId||!e.groupId)return[];const n=[];return this.groups.find(o=>o.id===e.groupId).entities?.forEach(o=>n.push(o.entityRecordData.id)),n}sendGtmAction(e){const n={moduleName:"RelationshipDesignerModule",schemaName:"GroupContentListComponent"};e&&n&&this.googleTagManagerService.track((0,G.merge)(n,e))}getGroupEntitiesCount(e){return e.entities?.length||0}ngOnInit(){this.initializeGroups()}ngOnDestroy(){this._subscription.unsubscribe()}createGroup(){const e={panelClass:["relationship-dialog-edit"],data:{}},n=this.dialogService.open(Z,e).subscribe(i=>{this.handleBaseDialogAction(i,this.relationshipDesignerService.createGroup,()=>{this.addGroupToList(i),this.sendGtmAction({action:W.AddGroup})})});this._subscription.add(n)}editGroup(e){const n=Object.assign({},e),i={panelClass:["relationship-dialog-edit"],data:{group:n}},o=this.dialogService.open(Z,i).subscribe(a=>{this.handleBaseDialogAction(a,this.relationshipDesignerService.updateGroup,()=>this.updateGroupInList(a))});this._subscription.add(o)}deleteGroup(e){const n=this.relationshipDeleteDialogService.confirmRemoving("RelationshipDesigner.DeleteItemMessage").subscribe(i=>{i&&(this.isLoading=!0,this.relationshipDesignerService.deleteGroup(e).subscribe(o=>{this.handleBaseResponseAction(o,()=>this.deleteGroupFromList(e))}))});this._subscription.add(n)}toggleHighlightGroup(e,n){e?.stopPropagation(),this.highlightedGroupId=n!==this.highlightedGroupId?n:null,this.diagramEventService.highlightGroup(this.highlightedGroupId)}addEntityToGroup(e,n){e?.stopPropagation(),this.doAddEntityToGroup({groupId:n})}editEntityInGroup(e){const n={panelClass:["relationship-dialog-edit"],data:{entityInGroup:Object.assign({},e)}},i=this.dialogService.open(B,n).subscribe(o=>{this.handleBaseDialogAction(o,this.relationshipDesignerService.updateEntityInGroup,()=>this.updateEntityInGroupInList(o))});this._subscription.add(i)}deleteEntityFromGroup(e,n){const i=this.relationshipDeleteDialogService.confirmRemoving("RelationshipDesigner.DeleteItemMessage").subscribe(o=>{o&&this.relationshipDesignerService.deleteEntityInGroup(e,n).subscribe(a=>{this.handleBaseResponseAction(a,()=>this.deleteEntityInGroupFromList(e,n))})});this._subscription.add(i)}isAddEntityToGroupButtonVisible(){return!this._filteredEntityId}static{this.\u0275fac=function(n){return new(n||V)(t.\u0275\u0275directiveInject(t.Injector))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:V,selectors:[["crt-group-content-list"]],hostVars:2,hostBindings:function(n,i){n&2&&t.\u0275\u0275classProp("rtl",i.isRtl)},inputs:{filteredEntityId:"filteredEntityId",searchFilter:"searchFilter"},outputs:{searchFilterChange:"searchFilterChange",changed:"changed"},decls:2,vars:1,consts:[[1,"group-list"],["class","group-list-item",4,"ngFor","ngForOf"],[1,"group-list-item"],[3,"expanded"],[3,"collapsedHeight","expandedHeight"],[1,"group-list-item-content"],[1,"group-list-item-info"],["matListIcon","",1,"group-icon"],[1,"group-caption-block"],[1,"group-caption"],[1,"group-caption-count"],[1,"group-list-item-actions"],["disableRipple","","mat-icon-button","","class","group-add-icon",3,"click",4,"ngIf"],["disableRipple","","mat-icon-button","",1,"group-menu-button",3,"matMenuTriggerFor","click"],["xPosition","before","yPosition","above",1,"relationship-group-menu"],["matGroupItemMenu","matMenu"],["mat-menu-item","",1,"highlight",3,"click"],["mat-menu-item","",1,"edit",3,"click"],["mat-menu-item","",1,"delete",3,"click"],[1,"group-entity-list"],["class","group-entity-list-item",4,"ngFor","ngForOf"],["disableRipple","","mat-icon-button","",1,"group-add-icon",3,"click"],[1,"group-entity-list-item"],[1,"group-entity-list-item-info"],[1,"entity-logo"],[1,"logo",3,"ngStyle"],[1,"entity-info"],[1,"entity-type"],[1,"entity-name"],[1,"group-entity-list-item-actions"],["disableRipple","","mat-icon-button","",1,"group-menu-button",3,"matMenuTriggerFor"],["matGroupEntityItemMenu","matMenu"],[1,"entity-comment"]],template:function(n,i){n&1&&(t.\u0275\u0275elementStart(0,"mat-list",0),t.\u0275\u0275template(1,Rt,21,12,"mat-list-item",1),t.\u0275\u0275elementEnd()),n&2&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",i.renderedGroups))},dependencies:[g.NgForOf,g.NgIf,g.NgStyle,M.MatLegacyButton,v.MatExpansionPanel,v.MatExpansionPanelHeader,S.MatIcon,k.MatLegacyList,k.MatLegacyListItem,k.MatLegacyListIconCssMatStyler,L.MatLegacyMenu,L.MatLegacyMenuItem,L.MatLegacyMenuTrigger],styles:[".rtl[_nghost-%COMP%]   .group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]   .group-icon[_ngcontent-%COMP%]{margin-left:7px;margin-right:0}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]{display:flex}.group-list-item-content[_ngcontent-%COMP%]{display:flex;width:100%;height:33px}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]   .group-icon[_ngcontent-%COMP%]{height:12px;width:12px;padding:0;margin-right:7px}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]   .group-caption-block[_ngcontent-%COMP%]{width:212px;display:flex;flex-direction:row}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]   .group-caption-block[_ngcontent-%COMP%]   .group-caption[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]   .group-caption-block[_ngcontent-%COMP%]   .group-caption-count[_ngcontent-%COMP%]{white-space:pre}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-actions[_ngcontent-%COMP%]{display:flex;align-items:center;opacity:0}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-actions[_ngcontent-%COMP%]   .group-add-icon[_ngcontent-%COMP%]{margin:0}.mat-expansion-panel-header[_ngcontent-%COMP%]:hover   .group-list-item-content[_ngcontent-%COMP%]   .group-list-item-actions[_ngcontent-%COMP%]{opacity:unset}.entity-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.entity-logo[_ngcontent-%COMP%]{min-height:100%;width:42px;display:flex;flex-direction:column;justify-content:center}.entity-logo[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{height:32px;width:32px;border-radius:16px;background-position:center;background-repeat:no-repeat}"]})}}const kt=function(r){return{"background-image":r}};function Ft(r,e){if(r&1){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-list-item",2)(1,"div",3)(2,"div",4),t.\u0275\u0275element(3,"div",5),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"div",6)(5,"div",7),t.\u0275\u0275text(6),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(7,"div",8)(8,"div"),t.\u0275\u0275text(9),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(10,"div",9),t.\u0275\u0275element(11,"button",10),t.\u0275\u0275elementStart(12,"mat-menu",11,12)(14,"button",13),t.\u0275\u0275listener("click",function(){const a=t.\u0275\u0275restoreView(n).$implicit,s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.edit(a))}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(15,"button",14),t.\u0275\u0275listener("click",function(){const a=t.\u0275\u0275restoreView(n).$implicit,s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.delete(a))}),t.\u0275\u0275elementEnd()()()(),t.\u0275\u0275elementStart(16,"div",15),t.\u0275\u0275text(17),t.\u0275\u0275elementEnd()()()()}if(r&2){const n=e.$implicit,i=t.\u0275\u0275reference(13);t.\u0275\u0275advance(3),t.\u0275\u0275property("ngStyle",t.\u0275\u0275pureFunction1(5,kt,"url("+n.image+")")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(n.typeCaption),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(n.entityCaption),t.\u0275\u0275advance(2),t.\u0275\u0275property("matMenuTriggerFor",i),t.\u0275\u0275advance(6),t.\u0275\u0275textInterpolate(n.comment)}}class J{constructor(e){this.injector=e,this.subscription=new l.Subscription,this.isRtl=!1,this.injectDependencies(),this._initializeDirectionality()}_initializeDirectionality(){this.isRtl=this.directionality?.value==="rtl"}injectDependencies(){this.designerService=this.injector.get(b),this.diagramEventService=this.injector.get(x.BaseDiagramEventService),this.dialogService=this.injector.get(h.DialogService),this.translateService=this.injector.get(C.TranslateService),this.directionality=this.injector.get(Q.Directionality),this.relationshipDeleteDialogService=this.injector.get(E)}showErrorDialog(e){if(e?.success)return;const n=e?.errorInfo?.message||"An unknown error occurred during the operation.";this.subscription.add(this.dialogService.openInfoDialog(n).subscribe())}ngOnDestroy(){this.subscription.unsubscribe()}edit(e){this.diagramEventService.elementDoubleClick$.next(e.id)}delete(e){this.relationshipDeleteDialogService.confirmRemoving("RelationshipDesigner.DeleteItemMessage").subscribe(n=>{n&&this.designerService.deleteConnection(e.originalId).subscribe(i=>{if(!i?.success){this.showErrorDialog(i);return}this.diagramEventService.diagramChanged$.next()})})}static{this.\u0275fac=function(n){return new(n||J)(t.\u0275\u0275directiveInject(t.Injector))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:J,selectors:[["crt-related-list"]],hostVars:2,hostBindings:function(n,i){n&2&&t.\u0275\u0275classProp("rtl",i.isRtl)},inputs:{relatedItems:"relatedItems"},decls:2,vars:1,consts:[[1,"related-list"],["class","related-list-item",4,"ngFor","ngForOf"],[1,"related-list-item"],[1,"related-list-item-info"],[1,"related-entity-logo"],[1,"logo",3,"ngStyle"],[1,"related-info"],[1,"related-type-caption"],[1,"related-entity-name"],[1,"related-list-item-actions"],["mat-icon-button","",1,"related-item-menu-button",3,"matMenuTriggerFor"],["xPosition","before","yPosition","above",1,"relationship-group-menu"],["matRelatedItemMenu","matMenu"],["mat-menu-item","",1,"edit",3,"click"],["mat-menu-item","",1,"delete",3,"click"],[1,"related-comment"]],template:function(n,i){n&1&&(t.\u0275\u0275elementStart(0,"mat-list",0),t.\u0275\u0275template(1,Ft,18,7,"mat-list-item",1),t.\u0275\u0275elementEnd()),n&2&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",i.relatedItems))},dependencies:[g.NgForOf,g.NgStyle,M.MatLegacyButton,k.MatLegacyList,k.MatLegacyListItem,L.MatLegacyMenu,L.MatLegacyMenuItem,L.MatLegacyMenuTrigger],styles:[".rtl[_nghost-%COMP%]   .related-list-item-info[_ngcontent-%COMP%]   .related-info[_ngcontent-%COMP%]   .related-type-caption[_ngcontent-%COMP%]{padding-right:0;padding-left:20px}.rtl[_nghost-%COMP%]   .related-list-item-info[_ngcontent-%COMP%]   .related-info[_ngcontent-%COMP%]   .related-comment[_ngcontent-%COMP%]{padding-right:0;padding-left:20px}"]})}}function Bt(r,e){r&1&&t.\u0275\u0275element(0,"ts-mask",13)}function Zt(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-form-field",17)(1,"mat-label"),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(4,"input",18),t.\u0275\u0275elementEnd()),r&2){const n=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,2,"ContainerPropertiesPage.Type")),t.\u0275\u0275advance(2),t.\u0275\u0275property("value",n.elementData==null||n.elementData.recordInfo==null?null:n.elementData.recordInfo.type)}}function Vt(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-form-field",17)(1,"mat-label"),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(4,"input",18),t.\u0275\u0275elementEnd()),r&2){const n=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,2,"ContainerPropertiesPage.Address")),t.\u0275\u0275advance(2),t.\u0275\u0275property("value",n.elementData==null||n.elementData.recordInfo==null?null:n.elementData.recordInfo.address)}}function Yt(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-form-field",17)(1,"mat-label"),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(4,"input",19),t.\u0275\u0275elementEnd()),r&2){const n=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,2,"ContainerPropertiesPage.Phone")),t.\u0275\u0275advance(2),t.\u0275\u0275property("value",n.elementData==null||n.elementData.recordInfo==null?null:n.elementData.recordInfo.phone)}}function Ht(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-form-field",17)(1,"mat-label"),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(4,"input",20),t.\u0275\u0275elementEnd()),r&2){const n=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,2,"ContainerPropertiesPage.Email")),t.\u0275\u0275advance(2),t.\u0275\u0275property("value",n.elementData==null||n.elementData.recordInfo==null?null:n.elementData.recordInfo.email)}}function Wt(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-form-field",17)(1,"mat-label"),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(4,"input",20),t.\u0275\u0275elementEnd()),r&2){const n=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,2,"ContainerPropertiesPage.Web")),t.\u0275\u0275advance(2),t.\u0275\u0275property("value",n.elementData==null||n.elementData.recordInfo==null?null:n.elementData.recordInfo.web)}}function Ut(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-expansion-panel",14)(1,"mat-expansion-panel-header",15)(2,"mat-panel-title"),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(5,Zt,5,4,"mat-form-field",16),t.\u0275\u0275template(6,Vt,5,4,"mat-form-field",16),t.\u0275\u0275template(7,Yt,5,4,"mat-form-field",16),t.\u0275\u0275template(8,Ht,5,4,"mat-form-field",16),t.\u0275\u0275template(9,Wt,5,4,"mat-form-field",16),t.\u0275\u0275elementEnd()),r&2){const n=t.\u0275\u0275nextContext();t.\u0275\u0275property("expanded",!0),t.\u0275\u0275advance(1),t.\u0275\u0275property("collapsedHeight","48px")("expandedHeight","48px"),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(4,9,"ContainerPropertiesPage.GeneralInformation")),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!!(!(n.elementData==null||n.elementData.recordInfo==null)&&n.elementData.recordInfo.type)),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!!(!(n.elementData==null||n.elementData.recordInfo==null)&&n.elementData.recordInfo.address)),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!!(!(n.elementData==null||n.elementData.recordInfo==null)&&n.elementData.recordInfo.phone)),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!!(!(n.elementData==null||n.elementData.recordInfo==null)&&n.elementData.recordInfo.email)),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!!(!(n.elementData==null||n.elementData.recordInfo==null)&&n.elementData.recordInfo.web))}}function Qt(r,e){if(r&1){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-expansion-panel",14)(1,"mat-expansion-panel-header",15)(2,"mat-panel-title"),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"button",21),t.\u0275\u0275listener("click",function(o){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.addToGroup(o))}),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(6,"crt-group-content-list",22),t.\u0275\u0275listener("changed",function(){t.\u0275\u0275restoreView(n);const o=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(o.onGroupsChanged())}),t.\u0275\u0275elementEnd()()}if(r&2){const n=t.\u0275\u0275nextContext();t.\u0275\u0275property("expanded",n.isGroupsChanged),t.\u0275\u0275advance(1),t.\u0275\u0275property("collapsedHeight","48px")("expandedHeight","48px"),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(4,5,"ContainerPropertiesPage.Groups")),t.\u0275\u0275advance(3),t.\u0275\u0275property("filteredEntityId",n.elementData==null?null:n.elementData.originalId)}}function Jt(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-expansion-panel",14)(1,"mat-expansion-panel-header",15)(2,"mat-panel-title"),t.\u0275\u0275text(3),t.\u0275\u0275elementEnd()(),t.\u0275\u0275element(4,"crt-related-list",23),t.\u0275\u0275elementEnd()),r&2){const n=t.\u0275\u0275nextContext();t.\u0275\u0275property("expanded",!0),t.\u0275\u0275advance(1),t.\u0275\u0275property("collapsedHeight","48px")("expandedHeight","48px"),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(n.getRelatedContactsCaption()),t.\u0275\u0275advance(1),t.\u0275\u0275property("relatedItems",n.relatedContacts)}}function $t(r,e){if(r&1&&(t.\u0275\u0275elementStart(0,"mat-expansion-panel",14)(1,"mat-expansion-panel-header",15)(2,"mat-panel-title"),t.\u0275\u0275text(3),t.\u0275\u0275elementEnd()(),t.\u0275\u0275element(4,"crt-related-list",23),t.\u0275\u0275elementEnd()),r&2){const n=t.\u0275\u0275nextContext();t.\u0275\u0275property("expanded",!0),t.\u0275\u0275advance(1),t.\u0275\u0275property("collapsedHeight","48px")("expandedHeight","48px"),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(n.getRelatedAccountsCaption()),t.\u0275\u0275advance(1),t.\u0275\u0275property("relatedItems",n.relatedAccounts)}}const Xt=function(r){return{"background-image":r}};class $ extends z{constructor(e){super(e),this.isGroupsChanged=!1,this.pageLink="",this.relatedAccounts=[],this.relatedContacts=[]}injectDependencies(){super.injectDependencies(),this.groupContentListEventService=this.injector.get(T),this.linkGenerator=this.injector.get(tt.LinkGenerator)}subscribeEvents(){super.subscribeEvents(),this.subscription.add(this.groupContentListEventService.isLoading$.subscribe(e=>this.isLoading=e))}onDataInitialized(){super.onDataInitialized(),this.initializePageLinkTool(),this.showMask();const e=this.elementData.originalId||this.elementData.id;this.designerService.getRecordEntityInfo(e).subscribe(n=>{if(!n?.success){this.hideMask(),this.showErrorDialog(n);return}this.initializeRecordEntityInfo(n.recordEntityInfo),this.fillRelatedAccounts(),this.fillRelatedContacts(),this.hideMask()})}initializePageLinkTool(){const e=this.elementConfig.entitySchemaData.name,n=this.elementData.recordId;this.subscription.add(this.linkGenerator.buildPageUrl(e,n).subscribe(i=>this.pageLink=i))}initializeRecordEntityInfo(e){this.elementData.recordInfo=e}isChanged(){return super.isChanged()||this.isGroupsChanged}getRelatedElementCaption(e,n=""){const i=this.translateService.instant("ContainerPropertiesPage.RelationshipsWith"),a=this.getElementConfig(e)?.entitySchemaData?.caption||n;return St.String.Format(i,a)}getRelatedItems(e){const n=this.elementData.id,i=[],o=d.RelationshipElementType,a=[o.connection,o.indirectConnection],s=e===o.relationshipContainer?"Contact":"Account";return this.elementConfig?.caption===s&&a.push(o.parentConnection),Object.values(this.data.connections).filter(p=>a.includes(p.type)).forEach(p=>{let it;if(p.source===n)it=p.target;else if(p.target===n)it=p.source;else return;const q=this.data.elements[it];if(q?.type===e&&q?.canRead){const ot=q,lt=ot.largeImage||this.getElementConfig(ot.type).largeImage,se={id:p.id,originalId:p.originalId,image:lt,typeCaption:p.relationshipType.name,entityCaption:ot.caption,comment:p.comment};i.push(se)}}),i}isDescriptionVisible(){const e=this.elementData?.recordInfo||{};return!!e.type||!!e.address||!!e.phone||!!e.email||!!e.web}onGroupsChanged(){this.isGroupsChanged=!0}isGroupVisible(){return this.elementConfig?.caption==="Contact"}isRelatedAccountsVisible(){return!0}isRelatedContactsVisible(){return!0}addToGroup(e){e.stopPropagation();const n={entityId:this.elementData.originalId};this.groupContentListEventService.addEntityToGroup(n)}fillRelatedAccounts(){this.relatedAccounts=this.getRelatedItems(d.RelationshipElementType.relationshipContainer)}fillRelatedContacts(){this.relatedContacts=this.getRelatedItems(d.RelationshipElementType.relationshipItem)}getRelatedContactsCaption(){return this.getRelatedElementCaption(d.RelationshipElementType.relationshipItem)}getRelatedAccountsCaption(){return this.getRelatedElementCaption(d.RelationshipElementType.relationshipContainer)}static{this.\u0275fac=function(n){return new(n||$)(t.\u0275\u0275directiveInject(t.Injector))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:$,selectors:[["crt-container-properties-page"]],features:[t.\u0275\u0275InheritDefinitionFeature],decls:19,vars:11,consts:[["class","component-mask",4,"ngIf"],[1,"header"],[1,"title-wrap"],[1,"logo-wrap"],[1,"logo",3,"ngStyle"],[1,"title"],[1,"sub-title"],[1,"tools-group-wrap"],[1,"entity-info"],[1,"tools"],["target","_blank",1,"tool","open-card",3,"href"],[1,"content"],[3,"expanded",4,"ngIf"],[1,"component-mask"],[3,"expanded"],[3,"collapsedHeight","expandedHeight"],["floatLabel","always",4,"ngIf"],["floatLabel","always"],["type","text","matInput","","disabled","",3,"value"],["type","tel","matInput","","disabled","",3,"value"],["type","email","matInput","","disabled","",3,"value"],["mat-icon-button","",1,"group-add-icon",3,"click"],[3,"filteredEntityId","changed"],[3,"relatedItems"]],template:function(n,i){n&1&&(t.\u0275\u0275template(0,Bt,1,0,"ts-mask",0),t.\u0275\u0275elementStart(1,"div",1)(2,"div",2)(3,"div",3),t.\u0275\u0275element(4,"div",4),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",5)(6,"div",6),t.\u0275\u0275text(7),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"div"),t.\u0275\u0275text(9),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(10,"div",7),t.\u0275\u0275element(11,"div",8),t.\u0275\u0275elementStart(12,"div",9),t.\u0275\u0275element(13,"a",10),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(14,"div",11),t.\u0275\u0275template(15,Ut,10,11,"mat-expansion-panel",12),t.\u0275\u0275template(16,Qt,7,7,"mat-expansion-panel",12),t.\u0275\u0275template(17,Jt,5,5,"mat-expansion-panel",12),t.\u0275\u0275template(18,$t,5,5,"mat-expansion-panel",12),t.\u0275\u0275elementEnd()),n&2&&(t.\u0275\u0275property("ngIf",i.isLoading),t.\u0275\u0275advance(4),t.\u0275\u0275property("ngStyle",t.\u0275\u0275pureFunction1(9,Xt,"url("+(i.elementData==null?null:i.elementData.largeImage)+")")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(i.elementData==null?null:i.elementData.subCaption),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(i.elementData==null?null:i.elementData.caption),t.\u0275\u0275advance(4),t.\u0275\u0275property("href",i.pageLink,t.\u0275\u0275sanitizeUrl),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",i.isDescriptionVisible()),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.isGroupVisible()),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.isRelatedContactsVisible()),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.isRelatedAccountsVisible()))},dependencies:[g.NgIf,g.NgStyle,h.MaskComponent,M.MatLegacyButton,v.MatExpansionPanel,v.MatExpansionPanelHeader,v.MatExpansionPanelTitle,m.MatLegacyFormField,m.MatLegacyLabel,w.MatLegacyInput,V,J,C.TranslatePipe],styles:["[_nghost-%COMP%]{display:block;position:relative;height:100%}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-right:0}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-right:10px;text-align:right}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.open-card[_ngcontent-%COMP%]{transform:rotate(-90deg)}.rtl[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:right}.header[_ngcontent-%COMP%]{max-width:343px;padding:12px 20px 0;min-height:97px;max-height:135px;border-top-left-radius:8px;border-top-right-radius:8px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]{height:56px;margin-top:5px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-top:7px;flex:0 0 69px;width:72px;height:56px;display:inline-flex;justify-content:center;align-items:center;margin-right:16px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{background-position:center;background-repeat:no-repeat}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:inline-block;letter-spacing:0px;text-align:left;margin-top:3px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;margin-top:7px;margin-right:10px;justify-content:flex-end;align-items:center}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{width:16px;height:16px;font-size:16px}.content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;width:100%;position:absolute;overflow-x:hidden;overflow-y:auto;height:auto;bottom:0;top:135px}.content[_ngcontent-%COMP%]:last-child{padding-bottom:0}.content[_ngcontent-%COMP%]   .text-area[_ngcontent-%COMP%]{min-width:150px;width:100%}.content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:left;letter-spacing:0px}",".rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{margin-right:-10px}.header[_ngcontent-%COMP%]{display:flex;min-height:97px;justify-content:space-between}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:100%;width:100%;max-width:290px;min-width:290px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{background-size:contain;width:100%;height:100%}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:0;height:49px;margin-bottom:2px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{height:29px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]{min-width:24px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .entity-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;align-items:center;width:50%}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{width:50%;align-items:flex-start}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.open-card[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTEiIGhlaWdodD0iMTEiIHZpZXdCb3g9IjAgMCAxMSAxMSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02LjE3NTUzIDAuODAxODE3QzYuMTc1NTMgMC4zNTg5ODYgNi41MzQ1MiAwIDYuOTc3MzUgMEgxMC4xMDE3QzEwLjU5NzUgMCAxMC45OTk1IDAuNDAxOTggMTAuOTk5NSAwLjg5Nzg0M1Y0LjAyMjE3QzEwLjk5OTUgNC40NjUgMTAuNjQwNSA0LjgyMzk4IDEwLjE5NzcgNC44MjM5OEM5Ljc1NDg3IDQuODIzOTggOS4zOTU4OCA0LjQ2NSA5LjM5NTg4IDQuMDIyMTdWMi43Mzk5M0w1LjExMTA0IDcuMDM0MDhDNC43OTgyNSA3LjM0NzU1IDQuMjkwNTcgNy4zNDgxIDMuOTc3MSA3LjAzNTMxQzMuNjYzNjMgNi43MjI1MiAzLjY2MzA4IDYuMjE0ODQgMy45NzU4NyA1LjkwMTM3TDguMjY0MyAxLjYwMzYzSDYuOTc3MzVDNi41MzQ1MiAxLjYwMzYzIDYuMTc1NTMgMS4yNDQ2NSA2LjE3NTUzIDAuODAxODE3Wk0yLjcyMjM0IDEuNjAzNjNDMi4xMDQ0OSAxLjYwMzYzIDEuNjAzNjMgMi4xMDQ0OSAxLjYwMzYzIDIuNzIyMzRWOC4yNzc1OUMxLjYwMzYzIDguODk1NDMgMi4xMDQ0OSA5LjM5NjI5IDIuNzIyMzQgOS4zOTYyOUg4LjI3NzU5QzguODk1NDMgOS4zOTYyOSA5LjM5NjI5IDguODk1NDMgOS4zOTYyOSA4LjI3NzU5VjcuMjgxMzlDOS4zOTYyOSA2LjgzODU2IDkuNzU1MjcgNi40Nzk1OCAxMC4xOTgxIDYuNDc5NThDMTAuNjQwOSA2LjQ3OTU4IDEwLjk5OTkgNi44Mzg1NiAxMC45OTk5IDcuMjgxMzlWOC4yNzc1OUMxMC45OTk5IDkuNzgxMDkgOS43ODEwOSAxMC45OTk5IDguMjc3NTkgMTAuOTk5OUgyLjcyMjM0QzEuMjE4ODMgMTAuOTk5OSAwIDkuNzgxMDkgMCA4LjI3NzU5VjIuNzIyMzRDMCAxLjIxODgzIDEuMjE4ODMgMCAyLjcyMjM0IDBIMy42ODc0NkM0LjEzMDI5IDAgNC40ODkyOCAwLjM1ODk4NiA0LjQ4OTI4IDAuODAxODE3QzQuNDg5MjggMS4yNDQ2NSA0LjEzMDI5IDEuNjAzNjMgMy42ODc0NiAxLjYwMzYzSDIuNzIyMzRaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K);background-position:center;background-repeat:no-repeat}.content[_ngcontent-%COMP%]{top:99px;border-bottom-left-radius:8px;border-bottom-right-radius:8px}.content[_ngcontent-%COMP%]   .mat-divider[_ngcontent-%COMP%]{padding-bottom:0;margin-top:0}.content[_ngcontent-%COMP%]   .mat-expansion-panel-header[_ngcontent-%COMP%]   .group-add-icon[_ngcontent-%COMP%]{margin:0;opacity:0}.content[_ngcontent-%COMP%]   .mat-expansion-panel-header[_ngcontent-%COMP%]:hover   .group-add-icon[_ngcontent-%COMP%]{opacity:unset}"]})}}function Kt(r,e){r&1&&t.\u0275\u0275element(0,"ts-mask",15)}class X extends z{constructor(e){super(e),this.isGroupsChanged=!1,this.searchFilter=""}injectDependencies(){super.injectDependencies(),this.groupContentListEventService=this.injector.get(T)}subscribeEvents(){super.subscribeEvents(),this.subscription.add(this.groupContentListEventService.isLoading$.subscribe(e=>this.isLoading=e))}isChanged(){return super.isChanged()||this.isGroupsChanged}onGroupsChanged(){this.isGroupsChanged=!0}createGroup(){this.groupContentListEventService.createGroup()}onSearchFilterValueChanged(e){this.searchFilter=e}static{this.\u0275fac=function(n){return new(n||X)(t.\u0275\u0275directiveInject(t.Injector))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:X,selectors:[["crt-groups-properties-page"]],features:[t.\u0275\u0275InheritDefinitionFeature],decls:18,vars:9,consts:[["class","component-mask",4,"ngIf"],[1,"header"],[1,"title-wrap"],[1,"logo-wrap"],[1,"logo"],[1,"title"],[1,"tools-group-wrap"],[1,"search-tool"],["floatLabel","never",1,"search-input"],["matInput","","type","text","spellcheck","false","autocomplete","off",1,"search-input-field",3,"placeholder","value","keyup"],["matSuffix","",1,"search-icon"],[1,"tools"],["mat-icon-button","",1,"tool","add-icon",3,"click"],[1,"content"],[3,"searchFilter","searchFilterChange","changed"],[1,"component-mask"]],template:function(n,i){n&1&&(t.\u0275\u0275template(0,Kt,1,0,"ts-mask",0),t.\u0275\u0275elementStart(1,"div",1)(2,"div",2)(3,"div",3),t.\u0275\u0275element(4,"div",4),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",5),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(8,"div",6)(9,"div",7)(10,"mat-form-field",8)(11,"input",9),t.\u0275\u0275listener("keyup",function(a){return i.onSearchFilterValueChanged(a.target.value)}),t.\u0275\u0275pipe(12,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(13,"mat-icon",10),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(14,"div",11)(15,"button",12),t.\u0275\u0275listener("click",function(){return i.createGroup()}),t.\u0275\u0275elementEnd()()()(),t.\u0275\u0275elementStart(16,"div",13)(17,"crt-group-content-list",14),t.\u0275\u0275listener("searchFilterChange",function(a){return i.searchFilter=a})("changed",function(){return i.onGroupsChanged()}),t.\u0275\u0275elementEnd()()),n&2&&(t.\u0275\u0275property("ngIf",i.isLoading),t.\u0275\u0275advance(6),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(7,5,"GroupsPropertiesPage.Title")),t.\u0275\u0275advance(5),t.\u0275\u0275property("placeholder",t.\u0275\u0275pipeBind1(12,7,"GroupsPropertiesPage.Search"))("value",i.searchFilter),t.\u0275\u0275advance(6),t.\u0275\u0275property("searchFilter",i.searchFilter))},dependencies:[g.NgIf,h.MaskComponent,M.MatLegacyButton,S.MatIcon,m.MatLegacyFormField,m.MatLegacySuffix,w.MatLegacyInput,V,C.TranslatePipe],styles:["[_nghost-%COMP%]{display:block;position:relative;height:100%}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-right:0}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-right:10px;text-align:right}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.open-card[_ngcontent-%COMP%]{transform:rotate(-90deg)}.rtl[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:right}.header[_ngcontent-%COMP%]{max-width:343px;padding:12px 20px 0;min-height:97px;max-height:135px;border-top-left-radius:8px;border-top-right-radius:8px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]{height:56px;margin-top:5px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-top:7px;flex:0 0 69px;width:72px;height:56px;display:inline-flex;justify-content:center;align-items:center;margin-right:16px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{background-position:center;background-repeat:no-repeat}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:inline-block;letter-spacing:0px;text-align:left;margin-top:3px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;margin-top:7px;margin-right:10px;justify-content:flex-end;align-items:center}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{width:16px;height:16px;font-size:16px}.content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;width:100%;position:absolute;overflow-x:hidden;overflow-y:auto;height:auto;bottom:0;top:135px}.content[_ngcontent-%COMP%]:last-child{padding-bottom:0}.content[_ngcontent-%COMP%]   .text-area[_ngcontent-%COMP%]{min-width:150px;width:100%}.content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:left;letter-spacing:0px}",".rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{display:flex}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzOS4xOTEiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzOS4xOTEgMzIiPjxkZWZzPjxzdHlsZT4uYSwuYntmaWxsOm5vbmU7fS5he3N0cm9rZTojMDA2Y2UwO3N0cm9rZS1taXRlcmxpbWl0OjEwO308L3N0eWxlPjwvZGVmcz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjM5NCAtMC40MDMpIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjEwNiA1LjUzMikiPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMwMi42MTYsNDc5LjQ2N2E1LjUyOSw1LjUyOSwwLDAsMC01LjUyNy01LjUzMiw1LjUzNSw1LjUzNSwwLDAsMC01LjUzNiw1LjUzMkE1LjUzNyw1LjUzNywwLDAsMC0zMDguMTQ0LDQ4NSw1LjUzMSw1LjUzMSwwLDAsMC0zMDIuNjE2LDQ3OS40NjdaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMjMuMjQ0IC00NzIuOTM1KSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMwNS41MzIsNDg3LjU3M2g3Ljk4MWMwLTQtMy4wMjctNi42MzgtNy41NzItNi42MzhhOS41LDkuNSwwLDAsMC0zLjQ5Mi42MTciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMzMS43NDIgLTQ2OC40NDYpIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0tMjk5Ljc2NCw0NzkuODZhNC40MjcsNC40MjcsMCwwLDAtNC40MjUtNC40MjUsNC40MjYsNC40MjYsMCwwLDAtNC40MjUsNC40MjUsNC40MjcsNC40MjcsMCwwLDAsNC40MjUsNC40MzJBNC40MjksNC40MjksMCwwLDAtMjk5Ljc2NCw0NzkuODZaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMzAuNzQ1IC00NzIuMTE2KSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMxMC43NTEsNDg3LjU3M2gtNy45NzljMC00LDMuMDI4LTYuNjM4LDcuNTctNi42MzhhOS41MjcsOS41MjcsMCwwLDEsMy40OTMuNjE3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMTQuNzMgLTQ2OC40NDYpIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0tMzE3LjYxNSw0NzkuODZhNC40MjQsNC40MjQsMCwwLDEsNC40MjMtNC40MjUsNC40Myw0LjQzLDAsMCwxLDQuNDI4LDQuNDI1LDQuNDMyLDQuNDMyLDAsMCwxLTQuNDI4LDQuNDMyQTQuNDI1LDQuNDI1LDAsMCwxLTMxNy42MTUsNDc5Ljg2WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzE2LjgzIC00NzIuMTE2KSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTI5OC43NjQsNDg5Ljc4NmMwLTUuMzMtMy4zODMtOC44NTEtOC40NTctOC44NTFzLTguNDU3LDMuNTIxLTguNDU3LDguODUxWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzIyLjMxNiAtNDY4LjQ0NikiLz48L2c+PHJlY3QgY2xhc3M9ImIiIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAwLjQwMykiLz48L2c+PC9zdmc+);width:40px;height:32px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]{width:100%;padding-right:10px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{font-size:16px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]:before{margin-top:10px;position:absolute}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .add-icon[_ngcontent-%COMP%]{margin-bottom:6px;font-size:18px;height:24px;width:24px}"]})}}const qt=["card"];function te(r,e){r&1&&t.\u0275\u0275element(0,"ts-mask",12)}function ee(r,e){}const ne=[[["","caption",""]],[["","tools",""]]],ie=function(r){return{pressed:r}},oe=["[caption]","[tools]"];class Y{get diagramData(){return this._config?.data}get diagramConfig(){return this._config?.config}set data(e){e!==this._inputData&&(this._inputData=e,this.clearDiagramData(),this.loadDiagram())}_showResponseErorrs(e){if(e.length){const i=(0,G.uniq)(e).join(`
	`);this.showErrorDialog(i)}}_getDeleteItem(e){return new Promise(n=>{this._getDeleteItemObservable(e.id,e.originalId).subscribe(o=>{o?.success?n():n(this.getErrorResponseMessage(o))})})}_getDeleteItemObservable(e,n){return this.diagramData.connections[e]?this.designerService.deleteConnection(n):this.designerService.deleteEntity(n)}_getItem(e){return this.diagramData.elements[e]||this.diagramData.connections[e]}_getElementConfig(e){return e&&this.diagramConfig?.customDiagramElements[e]}_getCardTypeByElementId(e){const n=this._getItem(e);if(!n)throw new Error(`Not found element with id: ${e}`);return this._getCardTypeElementType(n.type)}_getCardTypeElementType(e){switch(e){case d.RelationshipElementType.relationshipContainer:case d.RelationshipElementType.relationshipItem:return $;case d.RelationshipElementType.connection:case d.RelationshipElementType.indirectConnection:case d.RelationshipElementType.parentConnection:return A;default:throw new Error(`Not implemented properties page for type: ${e}`)}}_confirmRemoving(){var e=this;return(0,y.Z)(function*(){return yield(0,l.firstValueFrom)(e.relationshipDeleteDialogService.confirmRemoving("RelationshipDesigner.DeleteItemMessage"))})()}_getExistDiagramItems(e){const n=[];return e.forEach(i=>{const o=this._getItem(i);o&&n.push(o)}),n}_deleteEntities(e){var n=this;return(0,y.Z)(function*(){n.showMask();const o=n._getExistDiagramItems(e).map(s=>n._getDeleteItem(s));let a=!1;return yield Promise.all(o).then(s=>{s=s.filter(p=>p&&p!==""),n._showResponseErorrs(s),a=s.length<e.length}),n.sendGtmAction({action:W.DeleteElement}),n.hideMask(),a})()}_initializeDirectionality(){this.isRtl=this.directionality?.value==="rtl"}_initializeGTM(){this._subscription.add(this.googleTagManagerService.initialize().subscribe())}constructor(e){this.injector=e,this._subscription=new l.Subscription,this.allowFullScreenMode=!0,this.isCardShowed=!1,this.isLoading=!1,this.isLoadingPending=!1,this.showMaskDelay=100,this.isGroupsCardOpen=!1,this.isFullscreenMode=!1,this.isRtl=!1,this.injectDependencies(),this.subscribeEvents(),this._initializeDirectionality(),this._initializeGTM()}showMask(){this.isLoadingPending=!0,setTimeout(()=>{this.isLoadingPending&&(this.isLoading=!0)},this.showMaskDelay)}hideMask(){this.isLoadingPending=!1,this.isLoading=!1,this.changeDetector.detectChanges()}injectDependencies(){this.changeDetector=this.injector.get(t.ChangeDetectorRef),this.designerService=this.injector.get(b),this.diagramEventService=this.injector.get(d.BaseDiagramEventService),this.propertiesPageEventService=this.injector.get(j),this.dialogService=this.injector.get(h.DialogService),this.translateService=this.injector.get(C.TranslateService),this.notifyService=this.injector.get(h.NotifyService),this.directionality=this.injector.get(Q.Directionality),this.googleTagManagerService=this.injector.get(tt.GoogleTagManagerService),this.relationshipDeleteDialogService=this.injector.get(E)}subscribeEvents(){this.subscribeDiagramEvents()}subscribeDiagramEvents(){var e=this;const n=this.diagramEventService;[n.itemSelected$.subscribe(o=>{this.onItemSelected(o)}),n.highlightedGroup$.subscribe(o=>{this.onGroupHighlighted(o)}),n.elementDoubleClick$.subscribe(o=>{this.onElementDoubleClick(o)}),n.elementRemoving$.subscribe(function(){var o=(0,y.Z)(function*(a){yield e.onElementRemoving(a)});return function(a){return o.apply(this,arguments)}}()),n.connectionAdding$.subscribe(o=>{this.onConnectionAdding(o)}),n.showMessage$.subscribe(o=>{this.notifyService.show({message:o,translate:!1,panelClass:"relationship-notify"}).then()}),n.connectionReconnect$.subscribe(function(){var o=(0,y.Z)(function*(a){yield e.onConnectionReconnect(a)});return function(a){return o.apply(this,arguments)}}()),n.entityInGroupAdded$.subscribe((0,y.Z)(function*(){e.loadDiagram()})),n.entityInGroupRemoving$.subscribe((0,y.Z)(function*(){e.loadDiagram()})),n.diagramChanged$.subscribe((0,y.Z)(function*(){e.loadDiagram()})),this.propertiesPageEventService.doCloseCard().subscribe(function(){var o=(0,y.Z)(function*(a){return yield e.closeCard(a)});return function(a){return o.apply(this,arguments)}}())].forEach(o=>{this._subscription.add(o)})}loadDiagram(){this.showMask();const e=this._inputData;if(!e?.selectedRecordId||!e?.schemaName){this.clearDiagramData(),this.hideMask();return}this.designerService.getDiagram(e.selectedRecordId,e.schemaName).subscribe(n=>{if(n?.success)this.initializeDesignerConfig({data:n.data,config:n.config});else{const i=this.getErrorResponseMessage(n);this.showErrorDialog(i)}this.hideMask()})}initializeDesignerConfig(e){this._config=e,this.propertiesPageEventService.setDesignerConfig(e),this.initializeDiagram(e.config),this.loadDataToDiagram(e.data)}initializeDiagram(e){this.initializeDiagramLocalizableStrings(e),this.diagramEventService.setDiagramConfig({dialogService:this.dialogService,translateService:this.translateService,...e})}initializeDiagramLocalizableStrings(e){this.initializeDiagramToolsLocalizableStrings(e)}initializeDiagramToolsLocalizableStrings(e){const n=e.customLocalizableStrings||{},i={};["FitToView","ResetView","ZoomIn","ZoomOut","MiniMapClose","MiniMapOpen"].forEach(a=>{const s=this.translateService.instant("RelationshipDiagram.Tools."+a);a=(0,ct.unCapitalizeFirstLetter)(a),i[a]=s}),e.customLocalizableStrings=Object.assign(i,n)}loadDataToDiagram(e){this.diagramEventService.endLoading$.next(e)}openCardByElementId(e){var n=this;return(0,y.Z)(function*(){let i=null;if(e){const o=n._getCardTypeByElementId(e);if(i=yield n.openCard(o),!i)return;i.id$.next(e)}return i})()}openCard(e){var n=this;return(0,y.Z)(function*(){if(!(yield n.closeCard()))return;const o=n.card.createComponent(e);return n.isCardShowed=!0,o.instance})()}closeCard(e){return(0,l.lastValueFrom)(new l.Observable(n=>{e?.isForced?(this.forceCloseCard(e),n.next(!0),n.complete()):this.isCardShowed?this.saveAndCloseCard(n):(this.clearCardContainer(),n.next(!0),n.complete())}),{defaultValue:null})}forceCloseCard(e){this.clearCardContainer(),e.isNeedDiagramReload&&this.loadDiagram()}saveAndCloseCard(e){const n=this.propertiesPageEventService.saveCard().pipe((0,_.first)()).subscribe(i=>{const o=i?.success;o&&(this.clearCardContainer(),i.isChanged&&this.loadDiagram()),e.next(o),e.complete()});this._subscription.add(n)}clearCardContainer(){this.card.clear(),this.isCardShowed=!1,this.isGroupsCardOpen=!1}getErrorResponseMessage(e){return e?.errorInfo?.message||"An unknown error occurred during the operation."}showErrorDialog(e){this.hideMask(),this._subscription.add(this.dialogService.openInfoDialog(e).subscribe())}getDefaultRelationshipType(e,n){return{connectionType:this.getDefaultConnectionType(e,n)}}getDefaultConnectionType(e,n){const i=this._getItem(e),o=this._getItem(n);return i&&o?U.getDefaultConnectionType(i,o):N.formal}clearDiagramData(){this.loadDataToDiagram({})}sendGtmAction(e){const n={moduleName:"RelationshipDesignerModule",schemaName:"RelationshipDesignerComponent"};e&&n&&this.googleTagManagerService.track((0,G.merge)(n,e))}ngOnDestroy(){this._subscription.unsubscribe()}onItemSelected(e){var n=this;return(0,y.Z)(function*(){e||(yield n.closeCard())})()}onGroupHighlighted(e){this.diagramComponent.get("eventBus").fire("relationshipGroup.highlight.changed",{id:e})}onElementDoubleClick(e){var n=this;return(0,y.Z)(function*(){e?yield n.openCardByElementId(e):yield n.closeCard()})()}onElementRemoving(e){var n=this;return(0,y.Z)(function*(){(yield n._confirmRemoving())&&(yield n.closeCard({isForced:!0,isNeedDiagramReload:!1}),(yield n._deleteEntities(e))&&n.loadDiagram())})()}onConnectionAdding(e){var n=this;return(0,y.Z)(function*(){const i=yield n.openCard(A);i&&(i.elementData={id:e.id,source:e.source,target:e.target,relationshipType:n.getDefaultRelationshipType(e.source,e.target),isNew:!0},i.targetConfig=n._getElementConfig(e.targetType),i.id$.next(e.id||(0,f.generateGuid)()))})()}onConnectionReconnect(e){var n=this;return(0,y.Z)(function*(){yield n._deleteEntities([e.id]);const i=yield n.openCard(A);i&&(i.elementData={source:e.source,target:e.target,relationshipType:n.getDefaultRelationshipType(e.source,e.target),isNew:!0},i.id$.next((0,f.generateGuid)()))})()}showGroupsCard(){var e=this;return(0,y.Z)(function*(){if(e.isGroupsCardOpen)yield e.closeCard(),e.isGroupsCardOpen=!1;else{const n=yield e.openCard(X);n&&(n.id$.next((0,f.generateGuid)()),e.isGroupsCardOpen=!0)}})()}toggleFullscreenMode(){this.isFullscreenMode=!this.isFullscreenMode}static{this.\u0275fac=function(n){return new(n||Y)(t.\u0275\u0275directiveInject(t.Injector))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:Y,selectors:[["crt-relationship-designer"]],viewQuery:function(n,i){if(n&1&&(t.\u0275\u0275viewQuery(qt,7,t.ViewContainerRef),t.\u0275\u0275viewQuery(d.RelationshipDiagramComponent,7)),n&2){let o;t.\u0275\u0275queryRefresh(o=t.\u0275\u0275loadQuery())&&(i.card=o.first),t.\u0275\u0275queryRefresh(o=t.\u0275\u0275loadQuery())&&(i.diagramComponent=o.first)}},hostVars:4,hostBindings:function(n,i){n&2&&t.\u0275\u0275classProp("fullscreen",i.isFullscreenMode)("rtl",i.isRtl)},inputs:{data:"data",allowFullScreenMode:"allowFullScreenMode"},ngContentSelectors:oe,decls:15,vars:8,consts:[["class","component-mask",4,"ngIf"],[1,"designer-tools-panel"],[1,"caption-content-container"],[1,"modes"],[1,"tools"],["mat-icon-button","",1,"tool","group",3,"ngClass","click"],["mat-icon-button","",1,"tool","fullscreen",3,"click"],[1,"additional-tools-container"],[1,"designer-content"],[1,"diagram-wrap"],[1,"card-wrap"],["card",""],[1,"component-mask"]],template:function(n,i){n&1&&(t.\u0275\u0275projectionDef(ne),t.\u0275\u0275template(0,te,1,0,"ts-mask",0),t.\u0275\u0275elementStart(1,"div",1)(2,"div",2),t.\u0275\u0275projection(3),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(4,"div",3),t.\u0275\u0275elementStart(5,"div",4)(6,"button",5),t.\u0275\u0275listener("click",function(){return i.showGroupsCard()}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(7,"button",6),t.\u0275\u0275listener("click",function(){return i.toggleFullscreenMode()}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"div",7),t.\u0275\u0275projection(9,1),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(10,"div",8),t.\u0275\u0275element(11,"crt-relationship-diagram",9),t.\u0275\u0275elementStart(12,"div",10),t.\u0275\u0275template(13,ee,0,0,"ng-template",null,11,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275elementEnd()()),n&2&&(t.\u0275\u0275property("ngIf",i.isLoading),t.\u0275\u0275advance(6),t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(6,ie,i.isGroupsCardOpen)),t.\u0275\u0275advance(1),t.\u0275\u0275classProp("hidden",!i.allowFullScreenMode),t.\u0275\u0275advance(5),t.\u0275\u0275classProp("card-hidden",!i.isCardShowed))},dependencies:[g.NgClass,g.NgIf,h.MaskComponent,M.MatLegacyButton,d.RelationshipDiagramComponent],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;position:relative}.fullscreen[_nghost-%COMP%]{position:fixed;z-index:1999;top:0;left:0;width:100%;height:100%;background:#fff}.fullscreen[_nghost-%COMP%]   .designer-content[_ngcontent-%COMP%]{height:calc(100vh - 50px)}.fullscreen[_nghost-%COMP%]   .designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiI+CiAgPGRlZnM+CiAgICA8c3R5bGU+CiAgICAgIC5he2ZpbGw6IzU0NjU3ZH0uYntmaWxsOm5vbmU7c3Ryb2tlOiM1NDY1N2Q7c3Ryb2tlLW1pdGVybGltaXQ6MTB9CiAgICA8L3N0eWxlPgogIDwvZGVmcz4KICA8cGF0aCBjbGFzcz0iYSIgZD0iTTE0LjAwMyA4aC01VjN6TTguMDAzIDE0VjloLTV6Ii8+CiAgPHBhdGggY2xhc3M9ImIiIGQ9Ik0zIDE0bDQtNE0xMCA3bDQtNCIvPgogIDxwYXRoIGZpbGw9Im5vbmUiIGQ9Ik0wIDBoMTZ2MTZIMHoiLz4KPC9zdmc+Cg==) no-repeat center}.fullscreen[_nghost-%COMP%]   .designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen[_ngcontent-%COMP%]:hover{background:url(data:image/svg+xml;base64,PHN2ZyBpZD0iQ29tcG9uZW50XzY3OF8xIiBkYXRhLW5hbWU9IkNvbXBvbmVudCA2Nzgg4oCTIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMTYgMTYiPg0KICA8cGF0aCBpZD0iUGF0aF82MDU3IiBkYXRhLW5hbWU9IlBhdGggNjA1NyIgZD0iTTE4MjIuNi02MGgtNXYtNVoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xODA4LjU5NyA2OCkiIGZpbGw9IiMwMDZjZTAiLz4NCiAgPHBhdGggaWQ9IlBhdGhfNjA1OCIgZGF0YS1uYW1lPSJQYXRoIDYwNTgiIGQ9Ik0xODI5LjYtNjd2LTVoLTVaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTgyMS41OTcgODEpIiBmaWxsPSIjMDA2Y2UwIi8+DQogIDxsaW5lIGlkPSJMaW5lXzU3OSIgZGF0YS1uYW1lPSJMaW5lIDU3OSIgeTE9IjQiIHgyPSI0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzIDEwKSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDA2Y2UwIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMSIvPg0KICA8bGluZSBpZD0iTGluZV81ODAiIGRhdGEtbmFtZT0iTGluZSA1ODAiIHkxPSI0IiB4Mj0iNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAgMykiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwNmNlMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBzdHJva2Utd2lkdGg9IjEiLz4NCiAgPHJlY3QgaWQ9IlJlY3RhbmdsZV82Mjc2IiBkYXRhLW5hbWU9IlJlY3RhbmdsZSA2Mjc2IiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiLz4NCjwvc3ZnPg0K) no-repeat center}.rtl[_nghost-%COMP%]   .designer-content[_ngcontent-%COMP%]{direction:rtl;text-align:right}.rtl[_nghost-%COMP%]   .designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{margin-right:10px;margin-left:10px}.rtl[_nghost-%COMP%]   .designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen[_ngcontent-%COMP%]{transform:rotate(90deg)}.fullscreen-overlay[_ngcontent-%COMP%]{position:fixed;width:100%;height:100%;top:0;left:0;opacity:.4;background-color:#fff;z-index:1998}.designer-tools-panel[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;height:48px;border:1px solid #dbdbdb;border-radius:8px}.designer-tools-panel[_ngcontent-%COMP%]   .modes[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch}.designer-tools-panel[_ngcontent-%COMP%]   .caption-content-container[_ngcontent-%COMP%]{width:100%}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;justify-content:flex-end;align-items:center;min-width:345px}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{width:16px;height:16px;margin-right:22px}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.group[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmEsLmJ7ZmlsbDpub25lO30uYXtzdHJva2U6IzU0NjU3ZDtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9PC9zdHlsZT48L2RlZnM+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzE5LjExNiAtNDcxLjQzNSkiPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMwOC42OCw0NzYuNDM1YTIuNSwyLjUsMCwwLDAtMi41LTIuNSwyLjUsMi41LDAsMCwwLTIuNSwyLjUsMi41LDIuNSwwLDAsMCwyLjUsMi41QTIuNSwyLjUsMCwwLDAtMzA4LjY4LDQ3Ni40MzVaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjA2NCkiLz48cGF0aCBjbGFzcz0iYSIgZD0iTS0zMDcuMjIyLDQ4My45MzVoMy42MDdjMC0xLjgwNi0xLjM2OC0zLTMuNDIyLTNhNC4yOTQsNC4yOTQsMCwwLDAtMS41NzguMjc5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMC4wMDEpIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0tMzA0LjYxNSw0NzcuNDM1YTIsMiwwLDAsMC0yLTIsMiwyLDAsMCwwLTIsMiwyLDIsMCwwLDAsMiwyQTIsMiwwLDAsMC0zMDQuNjE1LDQ3Ny40MzVaIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0tMzE1LjEyNCw0ODMuOTM1aC0zLjYwNmMwLTEuODA2LDEuMzY5LTMsMy40MjEtM2E0LjMwNiw0LjMwNiwwLDAsMSwxLjU3OS4yNzkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuMTE0KSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMxNy42MTUsNDc3LjQzNWEyLDIsMCwwLDEsMi0yLDIsMiwwLDAsMSwyLDIsMiwyLDAsMCwxLTIsMkEyLDIsMCwwLDEtMzE3LjYxNSw0NzcuNDM1WiIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMwNi42NzgsNDg0LjkzNWMwLTIuNDA5LTEuOC00LTQuNS00cy00LjUsMS41OTEtNC41LDRaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjA2MikiLz48L2c+PHJlY3QgY2xhc3M9ImIiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIvPjwvc3ZnPg==) no-repeat center}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.group[_ngcontent-%COMP%]:hover{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmF7ZmlsbDojMDA2Y2UwO30uYntmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxwYXRoIGNsYXNzPSJhIiBkPSJNOCw5Yy0yLjk5MSwwLTUsMS44MDktNSw0LjVWMTRIMTN2LS41QzEzLDEwLjgwOSwxMC45OSw5LDgsOVoiLz48Y2lyY2xlIGNsYXNzPSJhIiBjeD0iMyIgY3k9IjMiIHI9IjMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUgMikiLz48cmVjdCBjbGFzcz0iYiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0xMiw5aC0uMzc5YTUuMTU1LDUuMTU1LDAsMCwxLDIuMzU1LDRIMTZ2LS41QzE2LDEwLjQ0LDE0LjM1NSw5LDEyLDlaIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik00LDloLjM3OWE1LjE1NSw1LjE1NSwwLDAsMC0yLjM1NSw0SDB2LS41QzAsMTAuNDQsMS42NDUsOSw0LDlaIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0xMi41LDMuNWEyLjQ3NiwyLjQ3NiwwLDAsMC0uNzU4LjEzLDMuOTI2LDMuOTI2LDAsMCwxLS45MjYsNC4yMDZBMi41LDIuNSwwLDEsMCwxMi41LDMuNVoiLz48cGF0aCBjbGFzcz0iYSIgZD0iTTMuNSwzLjVhMi40NzYsMi40NzYsMCwwLDEsLjc1OC4xMywzLjkyNiwzLjkyNiwwLDAsMCwuOTI2LDQuMjA2QTIuNSwyLjUsMCwxLDEsMy41LDMuNVoiLz48L3N2Zz4=) no-repeat center}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.group.pressed[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmF7ZmlsbDojMDA2Y2UwO30uYntmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxwYXRoIGNsYXNzPSJhIiBkPSJNOCw5Yy0yLjk5MSwwLTUsMS44MDktNSw0LjVWMTRIMTN2LS41QzEzLDEwLjgwOSwxMC45OSw5LDgsOVoiLz48Y2lyY2xlIGNsYXNzPSJhIiBjeD0iMyIgY3k9IjMiIHI9IjMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUgMikiLz48cmVjdCBjbGFzcz0iYiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0xMiw5aC0uMzc5YTUuMTU1LDUuMTU1LDAsMCwxLDIuMzU1LDRIMTZ2LS41QzE2LDEwLjQ0LDE0LjM1NSw5LDEyLDlaIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik00LDloLjM3OWE1LjE1NSw1LjE1NSwwLDAsMC0yLjM1NSw0SDB2LS41QzAsMTAuNDQsMS42NDUsOSw0LDlaIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0xMi41LDMuNWEyLjQ3NiwyLjQ3NiwwLDAsMC0uNzU4LjEzLDMuOTI2LDMuOTI2LDAsMCwxLS45MjYsNC4yMDZBMi41LDIuNSwwLDEsMCwxMi41LDMuNVoiLz48cGF0aCBjbGFzcz0iYSIgZD0iTTMuNSwzLjVhMi40NzYsMi40NzYsMCwwLDEsLjc1OC4xMywzLjkyNiwzLjkyNiwwLDAsMCwuOTI2LDQuMjA2QTIuNSwyLjUsMCwxLDEsMy41LDMuNVoiLz48L3N2Zz4=) no-repeat center}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyBpZD0iQ29tcG9uZW50XzUwN18zIiBkYXRhLW5hbWU9IkNvbXBvbmVudCA1MDcg4oCTIDMiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMTYgMTYiPg0KICA8ZyBpZD0iR3JvdXBfNTgxMSIgZGF0YS1uYW1lPSJHcm91cCA1ODExIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTgxNS41OTcgNzQpIj4NCiAgICA8cGF0aCBpZD0iUGF0aF82MDU3IiBkYXRhLW5hbWU9IlBhdGggNjA1NyIgZD0iTTE4MjIuNi02MGgtNXYtNVoiIGZpbGw9IiM1NDY1N2QiLz4NCiAgICA8cGF0aCBpZD0iUGF0aF82MDU4IiBkYXRhLW5hbWU9IlBhdGggNjA1OCIgZD0iTTE4MjkuNi02N3YtNWgtNVoiIGZpbGw9IiM1NDY1N2QiLz4NCiAgICA8bGluZSBpZD0iTGluZV81NzkiIGRhdGEtbmFtZT0iTGluZSA1NzkiIHkxPSI0IiB4Mj0iNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTgyNC41OTcgLTcxKSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNTQ2NTdkIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMSIvPg0KICAgIDxsaW5lIGlkPSJMaW5lXzU4MCIgZGF0YS1uYW1lPSJMaW5lIDU4MCIgeTE9IjQiIHgyPSI0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxODE4LjU5NyAtNjUpIiBmaWxsPSJub25lIiBzdHJva2U9IiM1NDY1N2QiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIxIi8+DQogICAgPHJlY3QgaWQ9IlJlY3RhbmdsZV82Mjc2IiBkYXRhLW5hbWU9IlJlY3RhbmdsZSA2Mjc2IiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4MTUuNTk3IC03NCkiIGZpbGw9Im5vbmUiLz4NCiAgPC9nPg0KPC9zdmc+DQo=) no-repeat center}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen[_ngcontent-%COMP%]:hover{background:url(data:image/svg+xml;base64,PHN2ZyBpZD0iQ29tcG9uZW50XzY3OV8xIiBkYXRhLW5hbWU9IkNvbXBvbmVudCA2Nzkg4oCTIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMTYgMTYiPg0KICA8cGF0aCBpZD0iUGF0aF82MDU3IiBkYXRhLW5hbWU9IlBhdGggNjA1NyIgZD0iTTE4MjIuNi02MGgtNXYtNVoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xODE1LjU5NyA3NCkiIGZpbGw9IiMwMDZjZTAiLz4NCiAgPHBhdGggaWQ9IlBhdGhfNjA1OCIgZGF0YS1uYW1lPSJQYXRoIDYwNTgiIGQ9Ik0xODI5LjYtNjd2LTVoLTVaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTgxNS41OTcgNzQpIiBmaWxsPSIjMDA2Y2UwIi8+DQogIDxsaW5lIGlkPSJMaW5lXzU3OSIgZGF0YS1uYW1lPSJMaW5lIDU3OSIgeTE9IjQiIHgyPSI0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5IDMpIiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDZjZTAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIxIi8+DQogIDxsaW5lIGlkPSJMaW5lXzU4MCIgZGF0YS1uYW1lPSJMaW5lIDU4MCIgeTE9IjQiIHgyPSI0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzIDkpIiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDZjZTAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIxIi8+DQogIDxyZWN0IGlkPSJSZWN0YW5nbGVfNjI3NiIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgNjI3NiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSJub25lIi8+DQo8L3N2Zz4NCg==) no-repeat center}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen.hidden[_ngcontent-%COMP%]{display:none}.designer-content[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch}.designer-content[_ngcontent-%COMP%]   .diagram-wrap[_ngcontent-%COMP%]{width:100%;border-radius:8px}.designer-content[_ngcontent-%COMP%]   .card-wrap[_ngcontent-%COMP%]{min-width:345px;max-width:345px;border:1px solid #dcdcdc;border-radius:8px}.designer-content[_ngcontent-%COMP%]   .card-wrap.card-hidden[_ngcontent-%COMP%]{display:none}"]})}}const ae=function(r){return{schemaName:r}};class K{constructor(e,n){this.dialogRef=e,this.data=n}static{this.\u0275fac=function(n){return new(n||K)(t.\u0275\u0275directiveInject(u.MatLegacyDialogRef),t.\u0275\u0275directiveInject(u.MAT_LEGACY_DIALOG_DATA))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:K,selectors:[["crt-relationship-dialog"]],decls:10,vars:11,consts:[["content",""],[3,"data","allowFullScreenMode"],["caption",""],[1,"dialog-caption",3,"caption"],["tools",""],["mat-flat-button","","color","default",3,"clicked"]],template:function(n,i){n&1&&(t.\u0275\u0275elementStart(0,"crt-dialog"),t.\u0275\u0275elementContainerStart(1,0),t.\u0275\u0275elementStart(2,"crt-relationship-designer",1),t.\u0275\u0275elementContainerStart(3,2),t.\u0275\u0275element(4,"crt-label",3),t.\u0275\u0275pipe(5,"translate"),t.\u0275\u0275elementContainerEnd(),t.\u0275\u0275elementContainerStart(6,4),t.\u0275\u0275elementStart(7,"crt-button",5),t.\u0275\u0275listener("clicked",function(){return i.dialogRef.close()}),t.\u0275\u0275text(8),t.\u0275\u0275pipe(9,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd(),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd(),t.\u0275\u0275elementEnd()),n&2&&(t.\u0275\u0275advance(2),t.\u0275\u0275property("data",i.data)("allowFullScreenMode",!1),t.\u0275\u0275advance(2),t.\u0275\u0275property("caption",t.\u0275\u0275pipeBind2(5,4,"RelationshipDesignerModal.Caption",t.\u0275\u0275pureFunction1(9,ae,i.data.schemaName))),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(9,7,"BasePageComponent.Close"),""))},dependencies:[P.CrtButtonComponent,P.CrtLabelComponent,P.CrtDialogComponent,Y,C.TranslatePipe],styles:[`.crt-relationship-dialog{max-width:94vw!important}.crt-relationship-dialog mat-dialog-container{height:90vh;width:94vw}.crt-relationship-dialog crt-relationship-dialog .designer-tools-panel{border:none}.crt-relationship-dialog crt-relationship-dialog .designer-tools-panel .dialog-caption label{font-family:var(--crt-headline-2-font-family);font-size:var(--crt-headline-2-font-size);line-height:var(--crt-headline-2-line-height);font-weight:var(--crt-headline-2-font-weight);letter-spacing:var(--crt-headline-2-letter-spacing);text-transform:var(--crt-headline-2-text-transform);-webkit-font-smoothing:antialiased;color:var(--crt-palette-primary-500, var(--palette-primary-500))}.crt-relationship-dialog crt-relationship-dialog .designer-content .diagram-wrap{border:1px solid #dcdcdc}.crt-relationship-dialog crt-relationship-dialog .designer-content .card-wrap{margin-left:10px}
`],encapsulation:2})}}let rt=class extends x.BaseDiagramEventHandlerController{constructor(e,n,i,o){super(),this.config=e,this.eventBus=n,this.rules=i,this.elements=o,this.translateService=e?.translateService}noAccessMessage(){const e=this.service,n=this.translateService.instant("RelationshipDiagram.NoAccess");e.showMessage(n)}subscribeServerDiagramChanges(){const e=this.service;this.eventBus.on(["element.dblclick"],n=>{const i=n.element;i&&!d.RelationshipDiagramUtils.isRoot(i)&&(this.rules.canEdit(i)?e.elementDoubleClick(i.id):this.noAccessMessage())}),this.eventBus.on(["elements.noAccessMessage"],()=>{this.noAccessMessage()}),this.eventBus.on(["elements.removing"],n=>{const i=n.elements.map(o=>o.id);return e.elementRemoving(i)}),this.eventBus.on(["diagram.connection.adding"],n=>e.connectionAdding({source:n.source.id,target:n.target?.id,targetType:n.targetType})),this.eventBus.on([x.Handlers.connection.reconnectExecuted],n=>{const i=n.context;if(i.newSource!==i.oldSource||i.newTarget!==i.oldTarget)return e.connectionReconnect({id:i.connection.id,source:i.newSource.id,target:i.newTarget.id})}),this.eventBus.on(["diagram.item.selected"],n=>e.itemSelected(n.id)),this.eventBus.on("diagram.loaded",()=>e.diagramLoaded()),this.eventBus.on("connect.end",x.EventPriority.LOW,function({context:n}){if(n.canExecute&&n.connection)return e.connectionAdding({id:n.connection.id,source:n.connection.source.id,target:n.connection.target.id})})}subscribeServerChanges(){return this.subscribeServerDiagramChanges(),[]}};rt=(0,I.__decorate)([(0,I.__param)(0,(0,x.Inject)("config")),(0,I.__param)(1,(0,x.Inject)("eventBus")),(0,I.__param)(2,(0,x.Inject)("diagramRules")),(0,I.__param)(3,(0,x.Inject)("elements")),(0,I.__metadata)("design:paramtypes",[Object,Object,d.RelationshipRules,x.DiagramElements])],rt);let dt=class extends f.BaseRequestHandler{constructor(e){super(),this._dialogProvider=e}handle(e){const n=e.recordId?.value??e.recordId;return(0,l.firstValueFrom)(this._dialogProvider.open(K,{data:{schemaName:e.entityName,selectedRecordId:n},panelClass:"crt-relationship-dialog"}))}};dt=(0,I.__decorate)([(0,f.CrtRequestHandler)({requestType:"crt.ShowRelationshipsRequest",type:"crt.ShowRelationshipsHandler"}),(0,I.__metadata)("design:paramtypes",[P.DialogProvider])],dt);function re(r,e){return()=>(0,l.lastValueFrom)(r.loadCurrentUserInfo().pipe((0,_.tap)(n=>{e.use(n?.userInfo?.cultureInfo?.sysCultureName)})),{defaultValue:null})}let st=class gt{static{this.\u0275fac=function(n){return new(n||gt)}}static{this.\u0275mod=t.\u0275\u0275defineNgModule({type:gt})}static{this.\u0275inj=t.\u0275\u0275defineInjector({providers:[T,O,j,b,F,E,O,{provide:d.BaseDiagramEventService,useClass:F},{provide:d.DiagramFeaturesToken,useFactory:()=>({...d.RelationshipDiagramFeatures,diagramEventHandlerController:["type",rt],elementFactory:["type",d.CommonDiagramElementFactory]})},tt.LinkGenerator,{provide:t.ENVIRONMENT_INITIALIZER,useFactory:re,deps:[ct.UserInfoService,C.TranslateService],multi:!0}],imports:[g.CommonModule,pt.ColorGithubModule,h.MaskModule,D.MatLegacyAutocompleteModule,M.MatLegacyButtonModule,u.MatLegacyDialogModule,R.MatDividerModule,v.MatExpansionModule,S.MatIconModule,m.MatLegacyFormFieldModule,w.MatLegacyInputModule,k.MatLegacyListModule,L.MatLegacyMenuModule,ut.MatLegacyTooltipModule,h.DialogModule,d.RelationshipDiagramModule,C.TranslateModule.forChild({defaultLanguage:"en-US",loader:{provide:C.TranslateLoader,useFactory:(e,n)=>new Ct.TranslateHttpLoader(e,n+"ClientApp/assets/i18n/"),deps:[H.HttpClient,g.APP_BASE_HREF]}}),P.CrtButtonModule,P.CrtLabelModule,P.CrtDialogModule]})}};st=(0,I.__decorate)([(0,f.CrtModule)({includes:[],requestHandlers:[dt]})],st),function(){(typeof ngJitMode>"u"||ngJitMode)&&t.\u0275\u0275setNgModuleScope(st,{declarations:[z,A,$,V,Z,X,Y,B,J,K,nt],imports:[g.CommonModule,pt.ColorGithubModule,h.MaskModule,D.MatLegacyAutocompleteModule,M.MatLegacyButtonModule,u.MatLegacyDialogModule,R.MatDividerModule,v.MatExpansionModule,S.MatIconModule,m.MatLegacyFormFieldModule,w.MatLegacyInputModule,k.MatLegacyListModule,L.MatLegacyMenuModule,ut.MatLegacyTooltipModule,h.DialogModule,d.RelationshipDiagramModule,C.TranslateModule,P.CrtButtonModule,P.CrtLabelModule,P.CrtDialogModule],exports:[z,Y]})}()},8239:(ht,at,c)=>{c.d(at,{Z:()=>g});function I(H,t,R,v,S,D,M){try{var u=H[D](M),m=u.value}catch(w){R(w);return}u.done?t(m):Promise.resolve(m).then(v,S)}function g(H){return function(){var t=this,R=arguments;return new Promise(function(v,S){var D=H.apply(t,R);function M(m){I(D,v,S,M,u,"next",m)}function u(m){I(D,v,S,M,u,"throw",m)}M(void 0)})}}}}]);
