(self.webpackChunkapp_studio_enterprise_relationship_diagram=self.webpackChunkapp_studio_enterprise_relationship_diagram||[]).push([[1736],{61736:(Ge,Te,C)=>{C.r(Te),C.d(Te,{AttributeBindingExpressionInterpreter:()=>M,AttributeControlBindingExpressionInterpreter:()=>F,AttributePropertyBindingExpressionInterpreter:()=>K,BINDING_CONTEXT:()=>B,BINDING_CONTEXT_DESIGN_TIME:()=>Be,BaseDynamicModule:()=>fe,BaseViewElementComponentCreator:()=>et,BindableDirective:()=>ce,BindingContextMock:()=>Re,BindingExpressionInterpreter:()=>O,BindingPipe:()=>de,COMPONENT_LOADER_VISIBILITY_DELAY:()=>D,ComponentViewElementRef:()=>Qe,ConverterExpressionInterpreter:()=>L,ConverterRegistryService:()=>ie,CrtAsyncPipe:()=>X,CrtBaseComponent:()=>R,DESIGNER_TOOL_GROUP_CONFIG:()=>Yt,DesignTimeViewElementTypeResolver:()=>Ee,FixedValueBindingExpressionInterpreter:()=>z,IGNORE_VIEW_ELEMENTS_NOT_FOUND_TOKEN:()=>_,JIT_MODULES:()=>Ue,ObjectPropBindingExpressionInterpreter:()=>k,RequestBindingConfigInterpreter:()=>U,RequestParamBindingExpressionInterpreter:()=>Y,ResourceBindingExpressionInterpreter:()=>q,ReusableViewGeneratorCacheService:()=>ye,ReusableViewGeneratorDirective:()=>H,SCHEMA_BINDING_CACHE:()=>It,ToolbarViewElementConfigResolver:()=>Ve,VIEW_ELEMENT_COMPONENT_CREATOR:()=>v,VIEW_ELEMENT_CONFIG:()=>j,ValidationStateBindingExpressionInterpreter:()=>W,ViewElementComponentCreator:()=>tt,ViewElementConfigUtils:()=>Fe,ViewElementDirective:()=>T,ViewElementPlaceholderComponent:()=>Z,ViewElementPlaceholderModule:()=>$,ViewElementTypeResolver:()=>A,ViewElementWebComponentCreator:()=>gt,ViewEventsNotifier:()=>me,ViewGeneratorDirective:()=>Q,ViewGeneratorModule:()=>ve,ViewInitDirective:()=>he,ViewModelDirective:()=>J,ViewModule:()=>G,WebComponentViewElementRef:()=>ft,bindingExpressionInterpretersProviders:()=>be,changeAttributeValueFromUI:()=>qe,designTimeFactory:()=>bt,factory:()=>wt,getAssociatedInputName:()=>ut,getAssociatedOutputName:()=>ae,getAssociatedValidationInputName:()=>ze,getAttributeLocation:()=>De,getRelativeAttributeBindingPath:()=>Ce,getRequestBindingConfigs:()=>Jt,getRootBindingContext:()=>ne,getTargetBindingContextInfo:()=>we,hasAssociatedInput:()=>Bt,hasAssociatedOutput:()=>Tt,hasAssociatedValidationInput:()=>Ie,hasInput:()=>re,hasOutput:()=>oe,hasValidationInfo:()=>Mt,markControlAsTouched:()=>Je,parseAttributePath:()=>He,viewConfigLtrMock:()=>zt,viewConfigRtlMock:()=>qt});var V=C(74742),te=C(99852),s=C(94450),d=C(75378),y=C(52045),g=C(97600),h=C(21322),p=C(27049);const Be=new s.InjectionToken("CRT_BINDING_CONTEXT_DESIGN_TIME"),B=new s.InjectionToken("CRT_BINDING_CONTEXT"),j=new s.InjectionToken("CRT_VIEW_ELEMENT_CONFIG"),_=new s.InjectionToken("Ignore view elements not found warning"),v=new s.InjectionToken("VIEW_ELEMENT_COMPONENT_CREATOR"),D=new s.InjectionToken("Add delay before enabling skeleton loader");class R extends y.CrtInjectorConstructor{set shape(e){this._shape=e;const t=this._classes.indexOf("crt-component-rounded");this.shape==="rounded"?t===-1&&this._classes.push("crt-component-rounded"):t>=0&&this._classes.splice(t,1)}get shape(){return this._shape}get classes(){return this.getClasses()}set classes(e){this.setClasses(e)}get loading(){return this._loading$.value}set loading(e){this._loading$.next(!!e),typeof e=="boolean"&&(e?this.handleStartLoadViewModelAttributes():this.handleFinishLoadViewModelAttributes())}constructor(e){super(e),this.injector=e,this._loading$=new h.BehaviorSubject(!1),this._classes=[],this.destroyed$=new h.Subject,this.loaderVisible=!1,this.documentDirection=null,this.documentDirection=e.get(te.Directionality)?.value==="rtl"?"rtl":null,this.changeDetectorRef=this.injector.get(s.ChangeDetectorRef),this.directionality=this.injector.get(te.Directionality),this.elementRef=this.injector.get(s.ElementRef),this._subscribeLoadingChanges()}_subscribeLoadingChanges(){const e=this.injector.get(D,0,{optional:!0});this._loading$.pipe((0,p.switchMap)(t=>t?(0,h.of)(t).pipe((0,h.delay)(e)):(0,h.of)(t)),(0,p.tap)(t=>{this.loaderVisible=t,this.changeDetectorRef.markForCheck()}),(0,p.takeUntil)(this.destroyed$)).subscribe()}handleStartLoadViewModelAttributes(){}handleFinishLoadViewModelAttributes(){}setClasses(e){this._classes=e||[]}getClasses(){return this._classes}toggleClass(e,t,n){const i=e.indexOf(n);t&&i===-1&&e.push(n),!t&&i>=0&&e.splice(i,1)}switchClass(e,t,n){n.forEach(([i,r])=>{this.toggleClass(e,i===t,r)})}setValuesFromConfig(e,t=[]){const n=(0,g.omit)(e,["id","name","type",...t]);Object.entries(n).forEach(([i,r])=>{this[i]=r})}detectChanges(){this.changeDetectorRef.detectChanges()}isRtl(){return this.directionality.value==="rtl"}focus(){this.elementRef?.nativeElement.focus()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}static{this.\u0275fac=function(t){return new(t||R)(s.\u0275\u0275directiveInject(s.Injector))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:R,hostVars:2,hostBindings:function(t,n){t&2&&s.\u0275\u0275attribute("element-name",n.name)("dir",n.documentDirection)},inputs:{name:"name",id:"id",tabIndex:"tabIndex",styles:"styles",shape:"shape",classes:"classes",loading:"loading"},features:[s.\u0275\u0275InheritDefinitionFeature]})}}(0,V.__decorate)([(0,d.CrtInput)(),(0,V.__metadata)("design:type",String)],R.prototype,"name",void 0),(0,V.__decorate)([(0,d.CrtInput)(),(0,V.__metadata)("design:type",String)],R.prototype,"id",void 0),(0,V.__decorate)([(0,d.CrtInput)(),(0,V.__metadata)("design:type",Number)],R.prototype,"tabIndex",void 0),(0,V.__decorate)([(0,d.CrtInput)(),(0,V.__metadata)("design:type",Object)],R.prototype,"styles",void 0),(0,V.__decorate)([(0,d.CrtInput)(),(0,V.__metadata)("design:type",String),(0,V.__metadata)("design:paramtypes",[String])],R.prototype,"shape",null),(0,V.__decorate)([(0,d.CrtInput)(),(0,V.__metadata)("design:type",Array),(0,V.__metadata)("design:paramtypes",[Array])],R.prototype,"classes",null),(0,V.__decorate)([(0,d.CrtInput)(),(0,V.__metadata)("design:type",Boolean),(0,V.__metadata)("design:paramtypes",[Boolean])],R.prototype,"loading",null);var P=C(31134),je=C(72856),St=C(54514);class Z{constructor(e,t){this.caption="",e.addSvgIconLiteral("placeholder",t.bypassSecurityTrustHtml(C(57421)))}static{this.\u0275fac=function(t){return new(t||Z)(s.\u0275\u0275directiveInject(je.MatIconRegistry),s.\u0275\u0275directiveInject(St.DomSanitizer))}}static{this.\u0275cmp=s.\u0275\u0275defineComponent({type:Z,selectors:[["crt-view-element-placeholder"]],inputs:{caption:"caption"},decls:4,vars:1,consts:[[1,"placeholder-container"],["svgIcon","placeholder",1,"icon"]],template:function(t,n){t&1&&(s.\u0275\u0275elementStart(0,"div",0),s.\u0275\u0275element(1,"mat-icon",1),s.\u0275\u0275elementStart(2,"span"),s.\u0275\u0275text(3),s.\u0275\u0275elementEnd()()),t&2&&(s.\u0275\u0275advance(3),s.\u0275\u0275textInterpolate(n.caption))},dependencies:[je.MatIcon],styles:[".placeholder-container[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;align-content:center;justify-content:center;border-radius:8px;position:relative;overflow:hidden}.placeholder-container[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:100%;max-height:64px;width:72px;align-self:center}.placeholder-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;top:50%;left:8px;right:8px;transform:translateY(-50%);overflow:hidden;width:calc(100% - 16px);text-overflow:ellipsis}@supports (background: -webkit-named-image(i)){.placeholder-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:initial;height:initial}}"]})}}class ${static{this.\u0275fac=function(t){return new(t||$)}}static{this.\u0275mod=s.\u0275\u0275defineNgModule({type:$})}static{this.\u0275inj=s.\u0275\u0275defineInjector({imports:[P.CommonModule,je.MatIconModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&s.\u0275\u0275setNgModuleScope($,{declarations:[Z],imports:[P.CommonModule,je.MatIconModule],exports:[Z]})})();var w=C(49475),Oe=C(34560),I=C(24709);class S{constructor(e=new h.Subscription,t=Promise.resolve()){this._subscription=e,this.ready=t}static all(e){const t=(0,w.joinSubscriptions)(e.map(i=>i._subscription)),n=Promise.all(e.map(i=>i.ready)).then(()=>{});return new S(t,n)}static subscribe(e,t,n=!1){e=e.pipe((0,p.share)());const i=e.subscribe({next:t}),r=n?(0,h.lastValueFrom)(e.pipe((0,p.first)(),(0,p.map)(()=>{})),{defaultValue:null}):Promise.resolve();return new S(i,r)}unsubscribe(){this._subscription.unsubscribe()}}var N=C(8239);function Ce(c,e){if(!c)return e;if(!e.startsWith(c))throw new Error(`Attribute path '${e}' should start with '${c}'`);return e.substring(c.length+1)}function He(c){if(!(0,y.isBindingExpression)(c))throw new Error(`'${c}' is not binding expression`);const e=c.indexOf("|");return e>-1&&(c=c.substring(0,e).trimEnd()),c.substring(1)}function De(c,e){return Ze.apply(this,arguments)}function Ze(){return Ze=(0,N.Z)(function*(c,e){const t=e.match(/^(?:(?<attributeHostPath>.+)\.)?(?<attributeName>[^.]+)$/),{attributeHostPath:n,attributeName:i}=t.groups,r=n?yield(0,I.get)(c,n):c;return{attributeName:i,attributeHost:r}}),Ze.apply(this,arguments)}function ne(c){for(;c.parent;)c=c.parent;return c}function we(c,e){const t=c.split(".").slice(0,-1),n=at(e),i=n.map(r=>r.viewModel$.pipe((0,p.take)(1)));return(0,h.forkJoin)(i).pipe((0,p.map)(r=>{const a=[];let o=n.length-1,u=[];for(const l of t)if(a.push(l),At(r[o],a)&&(u=[...a],o--,o<0))return null;return{context:n[o],contextPath:u.join(".")}}))}function at(c){const e=[c];return c.parent&&e.push(...at(c.parent)),e}function At(c,e){let t=c;for(const n of e)t=t?.attributes?t.attributes[n]:t?.[n];return t instanceof I.BaseViewModelCollection}class ct{getAttributeValuesStream(e,t){return e?e.events$.pipe((0,p.filter)(n=>n.type===I.ViewModelEventType.ChangeAttributeValue),(0,p.filter)(n=>n?.payload?.attributeName===t),(0,p.switchMap)(n=>t in e?Promise.resolve(e[t]):Promise.resolve(n.payload.value)),(0,p.share)()):(0,h.of)(null)}getAttributeInitialValueStream(e,t,n){return e?(0,h.from)((0,I.get)(e,t)).pipe((0,p.takeUntil)(n)):(0,h.of)(null)}getAttributeLocationChanges(e,t){return we(e,t).pipe((0,p.tap)(n=>{if(!n)throw new Error(`Target binding context for attribute "${e} was not found"`)}),(0,p.switchMap)(({context:n,contextPath:i})=>(0,h.combineLatest)([n.viewModel$,(0,h.of)(Ce(i,e))])),(0,p.switchMap)(([n,i])=>n?De(n,i):(0,h.of)({attributeName:void 0,attributeHost:void 0})))}evaluate(e,t){const n=e.slice(1);return this.getAttributeLocationChanges(n,t).pipe((0,p.switchMap)(i=>this.getAttributeValueChanges(i)))}}class M extends ct{getAttributeValueChanges({attributeHost:e,attributeName:t}){const n=this.getAttributeValuesStream(e,t),i=this.getAttributeInitialValueStream(e,t,n);return(0,h.merge)(i,n)}static{this.\u0275fac=function(){let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(M)))(n||M)}}()}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:M,factory:M.\u0275fac})}}var lt=C(41307);const xt="DisableAttributeDeactivationUntilBRulesExecution";class K extends ct{constructor(e){super(),this._featureService=e,this._readonlyProperties=["readonly","disabled"]}getAttributeValueChangesInHybridMode(e,t,n,i){const r=e.getControl(t),a=i.slice(1);return this._getValuesStream(e,t,n,()=>{const o=this.getAttributeValuesStream(e,a).pipe((0,p.tap)(f=>r.setPropertyValue(n,f))),u=this.getAttributeValuesStream(e,`${t}:${n}`).pipe((0,p.filter)(()=>{const f=Object.getOwnPropertyDescriptor(e,a),m=Boolean(f?.get),E=Boolean(f?.set);return!(m&&!E)}),(0,p.tap)(f=>e[a]=f)),l=(0,h.from)((0,I.get)(e,a)).pipe((0,p.tap)(f=>r.setPropertyValue(n,f,!0)),(0,p.takeUntil)(o));return(0,h.merge)(l,o,u)})}_getDefaultValue(e){if(!e)return null;try{return JSON.parse(e)}catch{return e}}_getValuesStream(e,t,n,i){return this._readonlyProperties.includes(n)?(0,h.forkJoin)({disableAttributeDeactivation:this._featureService.getFeatureState(xt),hasBRulesAffectingAttribute:e._getIsAffectedByBusinessRules({name:t})}).pipe((0,p.switchMap)(({disableAttributeDeactivation:r,hasBRulesAffectingAttribute:a})=>r||a!==!0?i():e._businessRulesActivated$.pipe((0,p.switchMap)(o=>o?i():(0,h.of)(!0))))):i()}getAttributeValueChanges(e){const{attributeHost:t}=e;if(!t)return(0,h.of)(null);const[n,i]=e.attributeName.split(":"),[r,a]=i.split("="),o=t.getControl(n),u=this._getDefaultValue(a);if(typeof u=="string"&&u?.startsWith("$"))return this.getAttributeValueChangesInHybridMode(t,n,r,u);if(u!=null){const l=o.getPropertyByName(r,!0);l.hasInitialValue||l.setInitialValue(u)}return this._getValuesStream(t,n,r,()=>{const l=this.getAttributeValuesStream(t,`${n}:${r}`),f=(0,h.of)(o.getPropertyValue(r)).pipe((0,p.filter)(m=>m!=null),(0,p.takeUntil)(l));return(0,h.merge)(f,l)})}static{this.\u0275fac=function(t){return new(t||K)(s.\u0275\u0275inject(lt.FeatureService))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:K,factory:K.\u0275fac})}}class F extends M{removeConvertersFromExpression(e){const t=e.indexOf("|");return t===-1?e:(console.warn(`Cannot use converters in control binding expression: ${e}`),e.substring(0,t).trimEnd())}evaluate(e,t){e=this.removeConvertersFromExpression(e);const n=e.slice(1);return this.getAttributeLocationChanges(n,t).pipe((0,p.map)(({attributeHost:i,attributeName:r})=>i?i.getAttributeControl(r):new Oe.FormControl(null)))}static{this.\u0275fac=function(){let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(F)))(n||F)}}()}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:F,factory:F.\u0275fac})}}class z{_getStringValue(e){return e.match(/^'(.*)'$/)[1]}_getBooleanValue(e){if(e==="true")return!0;if(e==="false")return!1;throw new Error(`${e} is not Boolean value`)}evaluate(e){if((0,y.isFixedStringValueExpression)(e))return(0,h.of)(this._getStringValue(e));if((0,y.isFixedNumberValueExpression)(e))return(0,h.of)(parseFloat(e));if((0,y.isFixedBooleanValueExpression)(e))return(0,h.of)(this._getBooleanValue(e));throw new Error(`Failed to parse primitive value binding expression: ${e}`)}static{this.\u0275fac=function(t){return new(t||z)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:z,factory:z.\u0275fac})}}class k extends M{_getViewModelCollectionValue(e,t){if(!t.length)return Promise.resolve(e);const n=Array.from(e).map(i=>this._getObjectProp(i,t));return Promise.all(n)}_getObjectProp(e,t){var n=this;return(0,N.Z)(function*(){const i=t.shift();return i?(e=yield e[i],e instanceof I.BaseViewModel?n._getObjectProp(e,t):e instanceof I.BaseViewModelCollection?n._getViewModelCollectionValue(e,t):n._getObjectProp(e,t)):e})()}evaluate(e,t){const n=e.slice(1);return we(n,t).pipe((0,p.map)(i=>i??{context:ne(t),contextPath:""}),(0,p.switchMap)(i=>(0,h.combineLatest)([i.context.viewModel$,(0,h.of)(Ce(i.contextPath,n))])),(0,p.switchMap)(([i,r])=>i?this._getObjectProp(i,r.split(".")):(0,h.of)(null)),(0,p.take)(1))}static{this.\u0275fac=function(){let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(k)))(n||k)}}()}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:k,factory:k.\u0275fac})}}class ie{constructor(){this._converterRegistry=d.ConverterRegistry,this._injector=(0,s.inject)(s.Injector)}get(e,t){return this._converterRegistry.get(e).instantiate(t)}register(e,t){throw new Error("NotImplemented")}clear(){this._converterRegistry.clear()}static{this.\u0275fac=function(t){return new(t||ie)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:ie,factory:ie.\u0275fac,providedIn:"root"})}}class L extends I.AbstractExpressionInterpreter{constructor(e,t,n,i=!1){super(),this._convertersRegistry=e,this._objectPropBindingExpressionInterpreter=t,this._fixedValueBindingExpressionInterpreter=n,this._isDesignTime=i}_evaluateParam(e,t){if((0,y.isFixedValueBindingExpression)(e))return this._fixedValueBindingExpressionInterpreter.evaluate(e);if((0,y.isBindingExpression)(e))return this._objectPropBindingExpressionInterpreter.evaluate(e,t);throw new Error(`Cannot parse parameter expression: ${e}`)}_evaluateParams(e,t){const n=e.map(i=>this._evaluateParam(i,t).pipe((0,p.first)()));return(0,h.forkJoin)(n).pipe((0,p.defaultIfEmpty)([]))}_getConverters(e,t){return e.split("|").map(i=>i.trim()).map(i=>{const[r,...a]=i.split(":").map(l=>l.trim()),o=this._evaluateParams(a,t),u=t.viewModel$.pipe((0,p.first)());return(0,h.forkJoin)([u,o]).pipe((0,p.map)(([l,f])=>m=>{if(!l)return null;const E=l._injectionContext;return this._convertersRegistry.get(r,E).convert(m,l,...f)}))})}_applyConverters(e,t){for(const[n,i]of Object.entries(t))if(e=i(e),e instanceof Promise){const r=parseInt(n,10)+1;return this._applyAsyncConverters(e,[...t].slice(r))}return e}_applyAsyncConverters(e,t){return(0,N.Z)(function*(){let n=yield e;for(const i of t)n=i(n),n instanceof Promise&&(n=yield n);return n})()}evaluate(e,t){if(this._isDesignTime||(0,g.isEmpty)(e))return(0,h.of)(i=>i);const n=this._getConverters(e,t);return(0,h.forkJoin)(n).pipe((0,p.map)(i=>r=>this._applyConverters(r,i)))}static{this.\u0275fac=function(t){return new(t||L)(s.\u0275\u0275inject(ie),s.\u0275\u0275inject(k),s.\u0275\u0275inject(z),s.\u0275\u0275inject(w.IS_DESIGN_TIME,8))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:L,factory:L.\u0275fac})}}class q{evaluate(e,t){const n=e.slice(1);return ne(t).viewModel$.pipe((0,p.switchMap)(i=>i?(0,I.get)(i,n):(0,h.of)(null)))}static{this.\u0275fac=function(t){return new(t||q)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:q,factory:q.\u0275fac})}}class O{constructor(e,t,n,i){this._attributeBindingExpressionInterpreter=e,this._attributePropertyBindingExpressionInterpreter=t,this._resourceBindingExpressionInterpreter=n,this._converterExpressionInterpreter=i}_applyConverter(e,t){return(0,N.Z)(function*(){return e=t(e),e instanceof Promise&&(e=yield e),e})()}evaluateInputValueExpression(e,t){return(0,y.isResourceBindingExpression)(e)?this._resourceBindingExpressionInterpreter.evaluate(e,t):(0,y.isPropertyBindingExpression)(e)?this._attributePropertyBindingExpressionInterpreter.evaluate(e,t):this._attributeBindingExpressionInterpreter.evaluate(e,t)}evaluate(e,t){const n=/\|(.*)/,[i,r]=e.split(n).map(u=>u.trim()),a=this.evaluateInputValueExpression(i,t),o=this._converterExpressionInterpreter.evaluate(r,t);return a.pipe((0,p.switchMap)(u=>o.pipe((0,p.switchMap)(l=>this._applyConverter(u,l)))))}static{this.\u0275fac=function(t){return new(t||O)(s.\u0275\u0275inject(M),s.\u0275\u0275inject(K),s.\u0275\u0275inject(q),s.\u0275\u0275inject(L))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:O,factory:O.\u0275fac})}}class Y extends O{constructor(e,t){super(null,null,null,t),this._objectPropBindingExpressionInterpreter=e}_evaluateEventBindingExpression(e,t){const n=t.initialEvent,i=e.replace(/@event\.?/,"");return(0,h.of)(i?(0,g.get)(n,i):n)}evaluateInputValueExpression(e,t){return(0,y.isEventBindingExpression)(e)?this._evaluateEventBindingExpression(e,t):this._objectPropBindingExpressionInterpreter.evaluate(e,t)}static{this.\u0275fac=function(t){return new(t||Y)(s.\u0275\u0275inject(k),s.\u0275\u0275inject(L))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:Y,factory:Y.\u0275fac})}}class se{constructor(e){this._requestParamBindingExpressionInterceptor=e}_evaluate(e,t){var n=this;return(0,N.Z)(function*(){const i={};for(const[r,a]of Object.entries(e))i[r]=yield n._evaluateConfigValue(a,t);return i})()}_evaluateConfigValue(e,t){return Array.isArray(e)?Promise.all(e.map(n=>this._evaluateConfigValue(n,t))):(0,y.isBindingExpression)(e)||(0,y.isEventBindingExpression)(e)?(0,h.lastValueFrom)(this._requestParamBindingExpressionInterceptor.evaluate(e,t),{defaultValue:null}):e&&typeof e=="object"?this._evaluate(e,t):Promise.resolve(e)}evaluate(e,t){return(0,h.from)(this._evaluate(e,t))}static{this.\u0275fac=function(t){return new(t||se)(s.\u0275\u0275inject(Y))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:se,factory:se.\u0275fac})}}class U{constructor(e){this._requestParamsBindingConfigInterpreter=e}_evaluateParams(e,t){return e?this._requestParamsBindingConfigInterpreter.evaluate(e,t):(0,h.of)({})}_getRequestBindingContext(e,t){return e.useRelativeContext?t:ne(t)}evaluate(e,t){return this._evaluateParams(e.params,t).pipe((0,p.withLatestFrom)(this._getRequestBindingContext(e,t).viewModel$),(0,p.map)(([n,i])=>({type:e.request,$context:i,...n})),(0,p.first)())}static{this.\u0275fac=function(t){return new(t||U)(s.\u0275\u0275inject(se))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:U,factory:U.\u0275fac})}}class W extends M{_getValidationStateChanges(e,t){const n=t.attributeHost.getAttributeControl(t.attributeName);return(0,h.merge)(e,n.statusChanges).pipe((0,p.map)(()=>({value:n.value,validationInfo:(0,g.pick)(n,"valid","errors","dirty","touched")})),(0,p.distinctUntilChanged)(g.isEqual))}evaluate(e,t){const n=e.slice(1);return this.getAttributeLocationChanges(n,t).pipe((0,p.switchMap)(i=>i.attributeHost?this._getValidationStateChanges(super.evaluate(e,t),i):(0,h.of)({value:null,validationInfo:{valid:!0,errors:null,dirty:!1,touched:!1}})))}static{this.\u0275fac=function(){let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(W)))(n||W)}}()}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:W,factory:W.\u0275fac})}}var $e=C(33177);const be=[M,K,F,O,L,k,z,U,Y,se,q,W,$e.FactoryProvider.create({token:I.EXPRESSION_INTERPRETER_FACTORY,mappings:[{predicate:"converter",injectable:L}]})],Ke="Change",Ne="ValidationInfo";function re(c,e){const t=d.ViewElementRegistry.viewElements.get(c);return Boolean(t?.inputs?.[e])}function oe(c,e){const t=d.ViewElementRegistry.viewElements.get(c);return Boolean(t?.outputs?.[e])}function Mt(c,e){const t=d.ViewElementRegistry.viewElements.get(c);return Boolean(t?.validationInputs?.[e])}function ae(c){return c+Ke}function Tt(c,e){const t=ae(e);return oe(c,t)}function ze(c){return c+Ne}function Ie(c,e){const t=e+Ne,n=d.ViewElementRegistry.viewElements.get(c);return Boolean(n?.validationInputs?.[t])}function ut(c){let e=null;if(c.endsWith(Ke))e=c.replace(new RegExp(Ke+"$"),"");else if(c.endsWith(Ne))e=c.replace(new RegExp(Ne+"$"),"");else return null;return e}function Bt(c,e){const t=ut(e);return Boolean(t)&&re(c,t)}class Fe{static _updateAttributeProperties(e,t,n,i){const r=e[t]||{},a={};i.forEach(l=>{let f=l.defaultValue;Object.prototype.hasOwnProperty.call(n,l.name)&&(f=n[l.name]??l.defaultValue),a[l.name]={defaultValue:f}});const o=d.ViewElementRegistry.getViewElementInputs(n.type);Object.entries(o).filter(([,l])=>l.propertyName!=null).forEach(([l,f])=>{a[f.propertyName]={defaultValue:l,locked:!0}}),r.properties={...r.properties??{},...a}}static updateAttributeProperties(e,t,n){const i=e.bindTo.replace("$",""),r=t?.viewModelConfig?.attributes||{};Fe._updateAttributeProperties(r,i,e,n)}static updateCollectionAttributeProperties(e,t,n,i){const r=e.bindTo.replace(`${n}.`,""),a=n.replace("$",""),u=(t?.viewModelConfig?.attributes||{})[a];if(!u)return;const l=u?.viewModelConfig?.attributes;!l||Fe._updateAttributeProperties(l,r,e,i)}}function qe(c,e,t){return Ye.apply(this,arguments)}function Ye(){return Ye=(0,N.Z)(function*(c,e,t){const n=yield(0,h.firstValueFrom)(we(c,t)),i=yield(0,h.firstValueFrom)(n.context.viewModel$);if(!i)return;const r=Ce(n.contextPath,c),{attributeHost:a,attributeName:o}=yield De(i,r);a.getAttributeControl(o).markAsDirty(),a[o]=e}),Ye.apply(this,arguments)}function Je(c,e){return Xe.apply(this,arguments)}function Xe(){return Xe=(0,N.Z)(function*(c,e){const t=yield(0,h.firstValueFrom)(we(c,e)),n=yield(0,h.firstValueFrom)(t.context.viewModel$);if(!n)return;const i=Ce(t.contextPath,c),{attributeHost:r,attributeName:a}=yield De(n,i),o=r.getAttributeControl(a);o.touched||(o.markAsTouched(),o.updateValueAndValidity())}),Xe.apply(this,arguments)}const pt="bindTo";class ht{constructor(e){this.injector=e,this._loadingAttributeName="loading",this.bindingExpressionInterpreter=e.get(O),this.attrCtrlExpInterpreter=e.get(F),this.requestBindingConfigInterpreter=e.get(U),this.validationBindingInterpreter=e.get(W),this._bindingContext=e.get(B,null),this._macrosHandlerService=e.get(w.MacrosHandlerService),this._isDesignTime=e.get(w.IS_DESIGN_TIME,!1)}_useMacros(e,t){if(!this._bindingContext)return t(e);let n;const i=new h.Subject,r=this._bindingContext.viewModel$.pipe((0,p.switchMap)(a=>this._macrosHandlerService.handleResourceMacros(e,a)),(0,p.map)((a,o)=>{n?.unsubscribe(),n=t(a),o===0&&n.ready.then(()=>{i.next(),i.complete()})}),(0,p.finalize)(()=>n?.unsubscribe())).subscribe();return new S(r,(0,h.lastValueFrom)(i,{defaultValue:null}))}_bindLoadingProperty(e,t){if(Object.keys(e).some(o=>o===this._loadingAttributeName))return new S;const i=(0,g.chain)(e).entries().filter(([o,u])=>this.isInputBinding(o,u,t,e)&&(0,y.isBindingExpression)(u)).value();if(!i.length)return new S;const r=i.map(([o,u])=>He(u)),a=ne(this._bindingContext).viewModel$.pipe((0,p.switchMap)(o=>{if(!o)return(0,h.of)();let u=[];const l=o.events$.pipe((0,p.filter)(m=>m.type===I.ViewModelEventType.StartLoadModelAttributes),(0,p.filter)(m=>{const E=Object.keys(m.payload);return r.some(x=>E.includes(x))}),(0,p.tap)(m=>{u=Object.keys(m.payload)}),(0,p.tap)(()=>t.setPropertyValue("loading",!0))),f=o.events$.pipe((0,p.filter)(m=>m.type===I.ViewModelEventType.FinishLoadModelAttributes),(0,p.filter)(m=>{const E=Object.keys(m.payload);return u.every(x=>E.includes(x))}),(0,p.tap)(()=>t.setPropertyValue("loading",!1)),(0,p.tap)(()=>u=[]));return(0,h.merge)(l,f)})).subscribe();return new S(a)}_isControlProperty(e,t){const n=d.ViewElementRegistry.getFormControlRelatesAttribute(t.type);return e===n}_getViewElementInputProperties(e){const t=d.ViewElementRegistry.viewElements.get(e.type);return t?[...Object.keys(t.inputs??{}).filter(n=>t.inputs[n].propertyBindable)]:["visible"]}_getViewElementEntries(e,t){const n=d.ViewElementRegistry.getFormControlRelatesAttribute(t.type),i=e.find(([a])=>a===pt);let r=e.filter(([a])=>a!==pt);if(i){const[,a]=i;if(!a)return r;this._getViewElementInputProperties(t).forEach(u=>{if(u!==n){let l=a;l=`${l}:${u}`;const f=t[u];f!=null&&(l+=`=${f}`),r=r.filter(([m])=>m!==u),r.push([u,l])}})}return r}_bindInputWithValidation(e,t,n){const i=this.validationBindingInterpreter.evaluate(t,this._bindingContext).pipe((0,p.startWith)(null),(0,h.pairwise)()),r=ze(e),a=([o,u])=>{o?.value!==u?.value&&n.setPropertyValue(e,u.value),n.setPropertyValue(r,u?.validationInfo)};return S.subscribe(i,a)}_bindFocusout(e,t){const n=t.getEvent("focusout"),i=e.slice(1),r=()=>Je(i,this._bindingContext);return S.subscribe(n,r)}_bindInputs(e,t){const[n,i]=(0,g.chain)(e).entries().filter(([u,l])=>this.isInputBinding(u,l,t,e)&&!this.isTwoWayBinding(u,l,t,e)).partition(([,u])=>(0,y.isBindingExpression)(u)).value();i.forEach(([u,l])=>{l=this._isControlProperty(u,e)?new Oe.FormControl(l):l,t.setPropertyValue(u,l)});const a=this._getViewElementEntries(n,e).map(([u,l])=>{const E=(this._isControlProperty(u,e)?this.attrCtrlExpInterpreter:this.bindingExpressionInterpreter).evaluate(l,this._bindingContext);if(Ie(e.type,u)&&(0,y.isSimpleBindingExpression)(l))return this._bindInputWithValidation(u,l,t);{const x=ee=>t.setPropertyValue(u,ee);return S.subscribe(E,x,!1)}}),o=this._bindLoadingProperty(e,t);return S.all([...a,o])}_createRequest(e,t){const n={...this._bindingContext,initialEvent:t};return this.requestBindingConfigInterpreter.evaluate(e,n).pipe((0,p.map)(i=>({...i,$initialEvent:t})))}_bindOutputs(e,t){const i=Object.entries(e).filter(([r,a])=>this.isOutputBinding(r,a,t,e)).map(([r,a])=>{const o=t.getEvent(r).pipe((0,p.switchMap)(l=>this._createRequest(a,l))),u=l=>l.$context.executeRequest(l);return S.subscribe(o,u)});return S.all(i)}_bindTwoWays(e,t){const n=Object.entries(e).filter(([r,a])=>this.isTwoWayBinding(r,a,t,e)),i=[];return n.forEach(([r,a])=>{const o=this.bindingExpressionInterpreter.evaluate(a,this._bindingContext),u=ot=>t.setPropertyValue(r,ot);Ie(e.type,r)&&(0,y.isSimpleBindingExpression)(a)?i.push(this._bindInputWithValidation(r,a,t)):i.push(S.subscribe(o,u));const l=a.slice(1),f=ae(r),m=this.getViewEventsStream(t,f),E=ot=>qe(l,ot,this._bindingContext),x=S.subscribe(m,E);i.push(x);const ee=this._bindFocusout(a,t);i.push(ee)}),S.all(i)}isInputBinding(e,t,n,i){return re(i.type,e)}isOutputBinding(e,t,n,i){return oe(i.type,e)}isTwoWayBinding(e,t,n,i){const r=ae(e);return(0,y.isSimpleBindingExpression)(t)&&re(i.type,e)&&oe(i.type,r)&&!(r in i)}bind(e,t){const n=i=>S.all([this._bindInputs(i,e),this._bindOutputs(i,e),this._bindTwoWays(i,e)]);return this._isDesignTime?this._useMacros(t,n):n(t)}}class dt extends ht{isInputBinding(e,t,n,i){return super.isInputBinding(e,t,n,i)||!this.isOutputBinding(e,t,n,i)}isOutputBinding(e,t,n,i){return super.isOutputBinding(e,t,n,i)||n.getPropertyValue(e)instanceof s.EventEmitter}getViewEventsStream(e,t){return e.getEvent(t)}}class jt extends ht{getViewEventsStream(e,t){return e.getEvent(t).pipe((0,h.map)(n=>n.detail))}}class Qe{constructor(e,t,n,i,r){this._ngZone=t,this._changeDetectorRef=n,this.nativeElement=i,this.hostView=r,this._propertyValues=new Map,this.instance=e}setValue(e,t){(0,g.set)(this.instance,e,t),this._changeDetectorRef.detectChanges()}getPropertyValue(e){return(0,g.get)(this.instance,e)}getEvent(e){const t=this.getPropertyValue(e);return!t&&this.nativeElement?(0,h.fromEvent)(this.nativeElement,e):t}on(e,t){const i=this.getEvent(e).subscribe(t);return()=>{i.unsubscribe()}}setPropertyValue(e,t){(!this._propertyValues.has(e)||t!==this._propertyValues.get(e))&&(this._propertyValues.set(e,t),this._ngZone.run(()=>this.setValue(e,t)))}}class ft{constructor(e){this._propertyValues=new Map,this.instance=e}getPropertyValue(e){return this.instance[e]}getEvent(e){return(0,h.fromEvent)(this.instance,e)}on(e,t){return this.instance.addEventListener(e,t),()=>this.instance.removeEventListener(e,t)}setPropertyValue(e,t){(!this._propertyValues.has(e)||t!==this._propertyValues.get(e))&&(this._propertyValues.set(e,t),this.instance[e]=t)}}class Ot{constructor(e,t){this._ngZone=t,this._propertyValues=new Map,this.instance=e}setValue(e,t){(0,g.set)(this.instance,e,t)}getPropertyValue(e){return(0,g.get)(this.instance,e)}getEvent(e){return this.getPropertyValue(e)}on(e,t){const i=this.getPropertyValue(e).subscribe(t);return()=>{i.unsubscribe()}}setPropertyValue(e,t){(!this._propertyValues.has(e)||t!==this._propertyValues.get(e))&&(this._propertyValues.set(e,t),this._ngZone.run(()=>this.setValue(e,t)))}}class et{constructor(e){this.injector=e}}class Ee{canResolve(e){return d.ViewElementRegistry.viewElements.has(e)||d.DesignTimeViewElementRegistry.infos.has(e)}getViewElementType(e){const t=e.type,n=d.DesignTimeViewElementRegistry.getByOverriddenType(t);if(n&&!e?.sealed)return n.typeRef;const i=d.ViewElementRegistry.viewElements.get(t);return i&&"typeRef"in i?i.typeRef:d.DesignTimeViewElementRegistry.infos.has(t)?d.DesignTimeViewElementRegistry.infos.get(t).typeRef:null}getSelector(e){if(d.DesignTimeViewElementRegistry.getByOverriddenType(e))return null;const t=d.ViewElementRegistry.viewElements.get(e);return t&&"selector"in t?t.selector:null}static{this.\u0275fac=function(t){return new(t||Ee)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:Ee,factory:Ee.\u0275fac})}}class A{canResolve(e){return d.ViewElementRegistry.viewElements.has(e)}getViewElementType(e){const t=d.ViewElementRegistry.viewElements.get(e.type);return t&&"typeRef"in t?t.typeRef:null}getSelector(e){const t=d.ViewElementRegistry.viewElements.get(e);return t&&"selector"in t?t.selector:null}static{this.\u0275fac=function(t){return new(t||A)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:A,factory:A.\u0275fac})}}class Ve{_setDefaultToolbarConfigValues(e){const t=e.toolbarConfig;if(!t)return;(t instanceof Array?t:[t]).forEach(i=>{i.groupType||(i.groupType=e.viewElementGroupType),i.caption||(i.caption=e.typeCaption)})}getDesignViewElementConfigs(){const e=new Map;return d.InterfaceDesignerItemRegistry.interfaceDesignerItemRegistrationInfos.forEach((t,n)=>{const i=t.toolbarConfig;i&&(this._setDefaultToolbarConfigValues(t),e.set(n,i))}),e}static{this.\u0275fac=function(t){return new(t||Ve)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:Ve,factory:Ve.\u0275fac})}}class tt extends et{createComponent(e){const t=this.injector.get(A),n=this.injector.get(s.ViewContainerRef),i=this.injector.get(j),r=this.injector.get(s.Renderer2),a=t.getViewElementType(i),o=n.createComponent(a,{index:0,injector:this.injector});e?.forEach(({name:m,value:E})=>{r.setAttribute(o.location.nativeElement,m,E)});const u=o.injector.get(s.ChangeDetectorRef),l=o.injector.get(s.ElementRef).nativeElement;o.changeDetectorRef.detectChanges();const f=this.injector.get(s.NgZone);return new Qe(o.instance,f,u,l,o.hostView)}}class gt extends et{createComponent(e){const t=this.injector.get(A),n=this.injector.get(s.Renderer2),i=this.injector.get(s.ViewContainerRef),r=this.injector.get(j),a=t.getSelector(r.type),o=document.createElement(a);return e?.forEach(({name:u,value:l})=>{n.setAttribute(o,u,l)}),n.appendChild(i.element.nativeElement.parentElement,o),this._initDirectionality(o),new ft(o)}_initDirectionality(e){this.injector.get(te.Directionality)?.value==="rtl"&&e.setAttribute("dir","rtl")}}class Dt{}class mt extends Dt{constructor(e){super(),this.injector=e,this.viewElementConfig=this.injector.get(j),this.featureValues=this.injector.get(w.FEATURE_VALUES,{optional:!0}),this.measurePerformanceService=this.injector.get(w.MeasurePerformanceService),this._componentCreator=this.injector.get(v)}_getElementName(){return`${this.viewElementConfig.type.split(".")?.[1]} ${this.viewElementConfig.name}`}_getDOMAttributes(){const e=[];return this.featureValues?.UseViewElementDataItemMarker&&e.push({name:"data-item-marker",value:this.viewElementConfig.dataItemMarker||this.viewElementConfig.name}),e}createComponent(e){return this._componentCreator.createComponent(e)}getComponentRef(){const e=this._getElementName(),t=this._getDOMAttributes();return this.measurePerformanceService.measure(e,()=>this.createComponent(t))}show(){const e=this.getComponentRef();return(0,h.of)(e)}}class $t extends mt{constructor(e,t,n){super(e),this.injector=e,this._creator=t,this._destroyed=n,this._renderer=this.injector.get(s.Renderer2),this._container=this.injector.get(s.ViewContainerRef),this._initMinHeight(),this._subscribeDestroyed()}get _parentElement(){return this._container.element.nativeElement.parentElement}_handleIntersection(e,t){if(!!this._parentElement){if(e&&!this._componentRef?.hostView){this._initResizeObservable(),t.next(this.getComponentRef()),t.complete();return}this._componentRef?.hostView&&(e?this._showElement():this._hideElement())}}_initIntersectionObserver(e){let t=this.viewElementConfig.selected;this._intersectionObserver=new IntersectionObserver(n=>{n.forEach(i=>{t?t=!1:this._handleIntersection(i.isIntersecting,e)})}),this._intersectionObserver.observe(this._parentElement),t&&this._handleIntersection(!0,e)}_initResizeObservable(){this._resizeObserver||(this._resizeObserver=new ResizeObserver(e=>{const{height:t,width:n}=e[0].contentRect;this._minHeight=`${t}px`,this._minWidth=`${n}px`}),this._resizeObserver.observe(this._parentElement))}_showElement(){this._display?this._renderer.setStyle(this._componentRef.nativeElement,"display",this._display):this._renderer.removeStyle(this._componentRef.nativeElement,"display"),this._removeMinSize()}_hideElement(){this._applyMinSize(),this._display=this._componentRef.nativeElement?.style.display,this._renderer.setStyle(this._componentRef.nativeElement,"display","none")}_removeMinSize(){this._renderer.removeStyle(this._parentElement,"min-height"),this._minWidth&&this._renderer.removeStyle(this._parentElement,"min-width")}_applyMinSize(){this._renderer.setStyle(this._parentElement,"min-height",this._minHeight),this._minWidth&&this._renderer.setStyle(this._parentElement,"min-width",this._minWidth)}_initMinHeight(){const e=d.ViewElementRegistry.viewElements.get(this.viewElementConfig.type);e?this._minHeight=e.defaultSize.height:console.warn(`View element with type "${this.viewElementConfig.type}" not found`)}_subscribeDestroyed(){this._destroyed?.subscribe(()=>{const e=this._componentRef?.hostView;e&&!e.destroyed&&e.destroy()})}createComponent(e){return this._componentRef=this._creator.createComponent(e),this._removeMinSize(),this._componentRef}show(){return this._applyMinSize(),new h.Observable(e=>{this._initIntersectionObserver(e)})}}const yt=new s.InjectionToken("COMPONENT_PROPERTIES_BINDER"),_t=new s.InjectionToken("DIRECTIVE_PROPERTIES_BINDER"),vt=new s.InjectionToken("VIEW_ELEMENT_VISIBILITY_STRATEGY"),nt=new s.InjectionToken("VIEW_ELEMENT_VISIBILITY_STRATEGY_VALUE"),Nt=function(c){const e=c.get(j);return c.get(A).getSelector(e.type)},it=function(c){return!!Nt(c)},Ft=function(c){return c.get(w.FEATURE_VALUES,{optional:!0})},kt=function(c){return c.get(w.IS_DESIGN_TIME,!1)},Lt=function(c){return it(c)?new jt(c):new dt(c)},Ut=function(c){return it(c)?new gt(c):new tt(c)},Wt=function(c,e){const t=c.get(nt)||d.ViewElementVisibilityStrategy.Default,i={[d.ViewElementVisibilityStrategy.Default]:Ct,[d.ViewElementVisibilityStrategy.OnDemand]:Kt}[t];if(!i)throw new Error(`Unsupported visibility strategy type: ${t}`);return i(c,e)},Gt=function(c,e){return c||e},Ct=function(c){return new mt(c)},Ht=function(c){return Ft(c).UseLazyComponentCreationInDesignTime},Zt=function(c){const e=c.get(j);return d.ViewElementRegistry.viewElements.get(e.type)?.viewElementVisibilityStrategy===d.ViewElementVisibilityStrategy.Default},Kt=function(c,e){const t=Zt(c),n=Ht(c),i=it(c),r=!kt(c);return t||i||r||!n?Ct(c):new $t(c,new tt(c),e)};class T{constructor(e,t,n,i,r,a){this._resolver=e,this.parentDirective=t,this.injector=n,this._container=i,this._isDesignTime=r,this._ngZone=a,this._ownProperties=[{property:"visible",defaultValue:!0,omitForViewModelBinding:!0},{property:"bindTo",defaultValue:null,omitForViewModelBinding:!1}],this._destroyed$=new h.Subject,this._showElementSubscription=new h.Subscription,this._isCreating=!1,this.nested=[],this.total=0,this.viewElementShow=new s.EventEmitter,this._visible=!1,this._featureValues=(0,s.inject)(w.FEATURE_VALUES,{optional:!0}),this._measurePerformanceService=(0,s.inject)(w.MeasurePerformanceService),this._directiveRef=new Ot(this,this._ngZone)}get visible(){return this._visible}set visible(e){this._visible=e,this._setViewElementVisibility(e||this._isDesignTime)}_bindSelfToViewModel(){const e=this._ownProperties.reduce((t,{property:n,defaultValue:i})=>({...t,[n]:this.viewElementConfig[n]??i}),{});this._ngZone.runOutsideAngular(()=>this.bindDirectiveProperties(e))}_bindComponentToViewModel(){const e=(0,g.omit)(this.viewElementConfig,...this._ownProperties.filter(({omitForViewModelBinding:t})=>t===!0).map(({property:t})=>t));this._ngZone.runOutsideAngular(()=>this.bindComponentProperties(e))}_setViewElementVisibility(e){e&&!this.componentRef?this._showViewElement():!e&&this.componentRef&&this._hideViewElement()}_showViewElement(){const e=this.viewElementConfig.type;if(this._typeName=e,!!this._typeName)if(this._resolver.canResolve(e))this._showComponent();else{if(this.injector.get(_,!1))return;const n=this._container.createComponent(Z);n.instance.caption=e;const i=n.injector.get(s.ElementRef).nativeElement;console.warn(`View element with type "${e}" not found`),this.componentRef=new Qe(n.instance,this._ngZone,n.changeDetectorRef,i,n.hostView)}}_showComponent(){if(this._isCreating)return;this._isCreating=!0;const e=this.injector.get(vt);this._showElementSubscription.add(e.show().pipe((0,p.filter)(t=>!!t),(0,p.takeUntil)(this._destroyed$)).subscribe(t=>{this.componentRef=t,this._measurePerformanceService.measure(`binding ${this.viewElementConfig.name}`,()=>this._bindComponentToViewModel()),this.viewElementShow.emit(this),this._isCreating=!1,this._featureValues?.UseMeasurePerformanceTools&&this._measurePerformanceService.rendering$.next()}))}_hideViewElement(){this._componentBinding?.unsubscribe(),this._showElementSubscription.unsubscribe(),this._container.clear(),this.componentRef=null}bindDirectiveProperties(e){this._directiveBinding?.unsubscribe(),this._directiveBinding=this._directivePropertiesBinder.bind(this._directiveRef,e)}bindComponentProperties(e){this._componentBinding?.unsubscribe(),this.componentRef&&(this._componentBinding=this._componentPropertiesBinder.bind(this.componentRef,e))}updateViewElementConfig(e){this.viewElementConfig=e,this._bindSelfToViewModel(),this._bindComponentToViewModel()}ngOnInit(){this._directivePropertiesBinder=this.injector.get(_t),this._componentPropertiesBinder=this.injector.get(yt),this.parentDirective&&this.parentDirective.attachNested(this),this._bindSelfToViewModel()}attachNested(e){this.nested.push(e)}detachNested(e){this.nested.splice(this.nested.indexOf(e),1)}ngOnDestroy(){this.parentDirective&&this.parentDirective.detachNested(this),this._componentBinding?.unsubscribe(),this._directiveBinding?.unsubscribe(),this._destroyed$.next(),this._destroyed$.complete()}static{this.\u0275fac=function(t){return new(t||T)(s.\u0275\u0275directiveInject(A),s.\u0275\u0275directiveInject(T,12),s.\u0275\u0275directiveInject(s.Injector),s.\u0275\u0275directiveInject(s.ViewContainerRef),s.\u0275\u0275directiveInject(w.IS_DESIGN_TIME,8),s.\u0275\u0275directiveInject(s.NgZone))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:T,selectors:[["","crtViewElement",""]],inputs:{viewElementConfig:["crtViewElement","viewElementConfig"],visibilityStrategy:"visibilityStrategy",visible:"visible"},outputs:{viewElementShow:"viewElementShow"},features:[s.\u0275\u0275ProvidersFeature([{provide:j,useFactory:e=>e.viewElementConfig,deps:[(0,s.forwardRef)(()=>T)],multi:!1},{provide:yt,useFactory:Lt,deps:[s.Injector],multi:!1},{provide:_t,useFactory:e=>new dt(e),deps:[s.Injector],multi:!1},{provide:v,useFactory:Ut,deps:[s.Injector],multi:!1},{provide:nt,useFactory:(e,t)=>Gt(e.visibilityStrategy,t),deps:[(0,s.forwardRef)(()=>T),[new s.Inject(nt),new s.SkipSelf,new s.Optional]],multi:!1},{provide:vt,useFactory:(e,t)=>Wt(e,t._destroyed$),deps:[s.Injector,(0,s.forwardRef)(()=>T)],multi:!1},...be])]})}}const wt=c=>({viewModel$:c.viewModel$,parent:c.parent}),bt=(c,e)=>{const t=new h.ReplaySubject(1);return t.next(null),(c.viewModel$??e?.viewModel$)?.subscribe(t),{viewModel$:t.asObservable(),parent:c.viewModel$?e:e?.parent,viewModelSubject:t}};class J{constructor(e){this.injector=e}set viewModel(e){(e instanceof I.BaseViewModel||e===void 0||e===null)&&(this.viewModel$?this.viewModel$.next(e):(this.viewModel$=new h.ReplaySubject(1),this.viewModel$.next(e)))}ngOnDestroy(){this.viewModel=null,this.viewModel$?.complete()}static{this.\u0275fac=function(t){return new(t||J)(s.\u0275\u0275directiveInject(s.Injector))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:J,selectors:[["","crtViewModel",""]],inputs:{viewModel:["crtViewModel","viewModel"]},exportAs:["crtViewModel"],features:[s.\u0275\u0275ProvidersFeature([{provide:B,useFactory:wt,deps:[[new s.Inject(Be),new s.Self]],multi:!1},{provide:Be,useFactory:bt,deps:[(0,s.forwardRef)(()=>J),[new s.Inject(B),new s.SkipSelf,new s.Optional]],multi:!1}])]})}}const zt=[{name:"Root",type:"crt.GridContainer",rows:["min-content","auto"],columns:["200px","auto"],gap:{columnGap:5,rowGap:5},classes:["page"],styles:{background:"lightcoral",minHeight:"700px",alignItems:"stretch"},items:[{name:"Header",type:"crt.FlexContainer",classes:["container","header","fixed-top"],alignItems:"center",styles:{padding:"5px",background:"#e0ebeb",border:"1px solid #94b8b8",position:"sticky",top:"0px",height:"100%"},items:[{name:"SaveButton",type:"crt.Button",caption:"save",dataItemMarker:"save-button"},{name:"CancelButton",type:"crt.Button",caption:"cancel"},{name:"UserButton",type:"crt.Button",caption:"user"},{name:"NotRegisterComponent",type:"crt.NotRegisterComponent"}],layoutConfig:{column:1,colSpan:-1}},{name:"LeftPane",type:"crt.FlexContainer",classes:["container","left"],styles:{height:"100%",background:"lightblue",padding:"5px",border:"1px solid #94b8b8"},direction:"column",items:[{name:"LeftPaneElement",type:"crt.List",parent:"LeftPane",classes:["el"],id:"list1",styles:{border:"1px solid #94b8b8",background:"#c2d6d6",padding:"5px"},layoutConfig:{grow:1}},{name:"input1",type:"crt.DeprecatedInput",parent:"LeftPane",classes:["el"],id:"input1",styles:{},caption:"Full name",value:"Andrew Baker (sample)",layoutConfig:{grow:1}}]},{name:"RightPane",type:"crt.GridContainer",classes:["container","right"],columns:["1fr","1fr"],styles:{height:"100%"},gap:5,items:[{name:"ImageInput2",type:"crt.ImageInput",classes:["el"],id:"imageInput2",caption:"imageInput2"},{name:"Toolbar1",type:"crt.FlexContainer",id:"toolbar1",gap:"5px",direction:"row",justifyContent:"flex-end",alignItems:"center",styles:{height:"100%"},items:[{name:"RunProcessButton",type:"crt.Button",caption:"run process"},{name:"ExecRequestButton",type:"crt.Button",caption:"exec request"}],layoutConfig:{column:1,colSpan:-1}}]}]}],qt=[{name:"Root",type:"crt.GridContainer",rows:["min-content","auto"],columns:["200px","auto"],gap:{columnGap:5,rowGap:5},classes:["page"],styles:{direction:"rtl"},items:[{name:"Header",type:"crt.FlexContainer",classes:["container","header"],styles:{padding:"5px",background:"#e0ebeb",border:"1px solid #94b8b8"},items:[{name:"SaveButton",type:"crt.Button",caption:"save"},{name:"CancelButton",type:"crt.Button",caption:"cancel"},{name:"UserButton",type:"crt.Button",caption:"user"}],layoutConfig:{colSpan:2}},{name:"LeftPane",type:"crt.FlexContainer",classes:["container","left"],styles:{height:"100%"},items:[{name:"LeftPaneElement",type:"crt.List",parent:"LeftPane",classes:["el"],id:"list1",styles:{border:"1px solid #94b8b8",background:"#c2d6d6",padding:"5px"},layoutConfig:{grow:1}}],layoutConfig:{colSpan:1}},{name:"RightPane",type:"crt.GridContainer",classes:["container","right"],rows:"min-content",columns:["1fr","1fr"],gap:2,items:[{name:"Toolbar1",type:"crt.FlexContainer",id:"toolbar1",gap:"5px",direction:"row",justifyContent:"flex-end",items:[{name:"RunProcessButton",type:"crt.Button",caption:"run process"},{name:"ExecRequestButton",type:"crt.Button",caption:"exec request"}],layoutConfig:{colSpan:2}}],layoutConfig:{colSpan:1}},{name:"Footer",type:"crt.FlexContainer",classes:["container","footer"],items:[{name:"FeedbackButton",type:"crt.Button",caption:"feedback"}],layoutConfig:{column:1,colSpan:2,row:3}}]}];class Re{constructor(){this._viewModel$=new h.BehaviorSubject(null),this.viewModel$=this._viewModel$.asObservable()}set viewModel(e){this._viewModel$.next(e)}get viewModel(){return this._viewModel$.getValue()}static{this.\u0275fac=function(t){return new(t||Re)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:Re,factory:Re.\u0275fac})}}const Yt=c=>{switch(c){case d.DesignerToolGroupType.Data:case d.DesignerToolGroupType.Inputs:return{styles:{caption:{height:20},icon:{width:72,height:40},tile:{width:72,height:40+20}}};default:return{styles:{caption:{height:20},icon:{width:72,height:64},tile:{width:72,height:64+20}}}}};class G{static{this.\u0275fac=function(t){return new(t||G)}}static{this.\u0275mod=s.\u0275\u0275defineNgModule({type:G})}static{this.\u0275inj=s.\u0275\u0275defineInjector({providers:[A,...be],imports:[P.CommonModule,w.MacrosModule,$,$]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&s.\u0275\u0275setNgModuleScope(G,{declarations:[J,T],imports:[P.CommonModule,w.MacrosModule,$],exports:[J,T,$]})})();function Jt(c,e,t){const n=[];return e===void 0||w.MetadataSchemaUtils.getViewConfigInfoByFilter(i=>{const r=Object.values(i).filter(a=>{const o=a;return o?.request===e&&(t?t(o):!0)});return n.push(...r),!1},c),n}var ke;(function(c){c.HIDE="hide",c.DESTROY="destroy"})(ke||(ke={}));const st="crt-hide-visible",Pe="_instanceId",Le="_instanceCache";class Se{constructor(e,t,n){this._view=e,this._template=t,this._featureValues=n,this._context={$implicit:null},this.visibilityStrategyMode=ke.DESTROY}_changeVisibilityByDestroyStrategy(){this.crtIf?this._ref||(this._ref=this._view.createEmbeddedView(this._template,this._context)):(this._view.clear(),this._ref=null)}_canUseHideStrategy(){return this.visibilityStrategyMode===ke.HIDE&&this._featureValues.UseHideVisibilityStrategy}_changeVisibilityByHideStrategy(){if(this.crtIf){if(this._ref){this._getRootNode().classList.remove(st);return}this._ref=this._view.createEmbeddedView(this._template,this._context);return}this._ref&&this._getRootNode().classList.add(st)}_getRootNode(){return this._ref.rootNodes[0]}ngOnChanges(e){this._context.$implicit=this.crtIf,this._canUseHideStrategy()?this._changeVisibilityByHideStrategy():this._changeVisibilityByDestroyStrategy()}ngOnDestroy(){this._ref?.destroy()}static{this.\u0275fac=function(t){return new(t||Se)(s.\u0275\u0275directiveInject(s.ViewContainerRef),s.\u0275\u0275directiveInject(s.TemplateRef),s.\u0275\u0275directiveInject(w.FEATURE_VALUES))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:Se,selectors:[["","crtIf",""]],inputs:{crtIf:"crtIf",visibilityStrategyMode:["crtIfVisibilityStrategyMode","visibilityStrategyMode"]},features:[s.\u0275\u0275NgOnChangesFeature]})}}class ce{constructor(e){this._injector=e,this._requestBindingConfigInterpreter=this._injector.get(U),this._crtNavigationLock=this._injector.get(w.CRT_NAVIGATION_LOCK_TOKEN)}_sendRequest(e,t){var n=this;return(0,N.Z)(function*(){const r={...yield(0,h.lastValueFrom)(n._requestBindingConfigInterpreter.evaluate(e,{...n._bindingContext,initialEvent:t})),$initialEvent:t};return r.$context?r.$context.executeRequest(r):null})()}_sendRequests(e,t){var n=this;return this._crtNavigationLock.wait((0,N.Z)(function*(){let i=null,r=!1;for(const a of t)if(!(r&&a.skipOnError===!0))try{i=yield n._sendRequest(a,e)}catch{r=!0}return i}))}processOutputEvent(e,t){if(this._bindingContext=this._injector.get(B),e.action==="processRequest")this._sendRequests(t,e.requests);else if(e.action==="changeAttributeValue"){const i=t instanceof CustomEvent?t.detail:t;qe(e.attributePath,i,this._bindingContext)}else e.action==="markControlAsTouched"&&Je(e.attributePath,this._bindingContext)}static{this.\u0275fac=function(t){return new(t||ce)(s.\u0275\u0275directiveInject(s.Injector))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:ce,selectors:[["","crtOutputBinding",""]],exportAs:["crtOutputBinding"],features:[s.\u0275\u0275ProvidersFeature([U])]})}}class le{static{this.\u0275fac=function(t){return new(t||le)}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:le,selectors:[["","crtViewElementConfig",""]],inputs:{crtViewElementConfig:"crtViewElementConfig"},features:[s.\u0275\u0275ProvidersFeature([{provide:j,useFactory:e=>(0,g.cloneDeep)(e.crtViewElementConfig),deps:[[le,new s.Self]]}])]})}}class ue{constructor(e){this.parent=e,this.inputs={},this.outputs={},this.directives=[],this.attributes={},this.content=[]}}class Ae{static{this.\u0275fac=function(t){return new(t||Ae)}}static{this.\u0275cmp=s.\u0275\u0275defineComponent({type:Ae,selectors:[["crt-view-element-container"]],inputs:{viewElementConfig:"viewElementConfig"},decls:1,vars:1,consts:[[3,"crtViewElement"]],template:function(t,n){t&1&&s.\u0275\u0275elementContainer(0,0),t&2&&s.\u0275\u0275property("crtViewElement",n.viewElementConfig)},dependencies:[T],encapsulation:2})}}class xe{constructor(e,t){this._containerRef=e,this._template=t,this._subscription=new h.Subscription,this._crtAttachIf$=new h.Subject,this._bindingActivator=(0,s.inject)(y.PRESERVED_CONTENT_BINDING_ACTIVATOR,{optional:!0})??new y.BindingActivator,this._subscription=(0,h.combineLatest)([this._bindingActivator.active$,this._crtAttachIf$]).subscribe(([n,i])=>this._changeVisibilityByAttachDetachStrategy(n,i))}_changeVisibilityByAttachDetachStrategy(e,t){if(t){if(e){if(!this._viewRef){this._viewRef=this._containerRef.createEmbeddedView(this._template);return}this._containerRef.insert(this._viewRef)}}else{const n=this._containerRef.indexOf(this._viewRef);n>=0&&this._containerRef.detach(n)}}ngOnChanges(e){this._crtAttachIf$.next(this.crtAttachIf)}ngOnDestroy(){this._subscription.unsubscribe(),this._viewRef?.destroy()}static{this.\u0275fac=function(t){return new(t||xe)(s.\u0275\u0275directiveInject(s.ViewContainerRef),s.\u0275\u0275directiveInject(s.TemplateRef))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:xe,selectors:[["","crtAttachIf",""]],inputs:{crtAttachIf:"crtAttachIf"},features:[s.\u0275\u0275NgOnChangesFeature]})}}class pe extends P.NgForOf{static{this.\u0275fac=function(){let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(pe)))(n||pe)}}()}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:pe,selectors:[["","crtNgFor",""]],features:[s.\u0275\u0275InheritDefinitionFeature]})}}class he{constructor(e,t){this.changeDetectorRef=e,this.containerRef=t,this.init=new s.EventEmitter}ngOnInit(){this.init.emit(this)}static{this.\u0275fac=function(t){return new(t||he)(s.\u0275\u0275directiveInject(s.ChangeDetectorRef),s.\u0275\u0275directiveInject(s.ViewContainerRef))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:he,selectors:[["","crtViewInit",""]],outputs:{init:"init"}})}}class X extends P.AsyncPipe{static{this.\u0275fac=function(){let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(X)))(n||X)}}()}static{this.\u0275pipe=s.\u0275\u0275definePipe({name:"crtAsync",type:X,pure:!1})}}const Ue=new s.InjectionToken("CRT_JIT_MODULES"),It=new s.InjectionToken("CRT_SCHEMA_BINDING_CACHE");class de{constructor(e,t,n,i,r){this._injector=e,this._changeDetector=t,this._bindingExpressionInterpreter=n,this._attributeFormControlExpressionInterpreter=i,this._ngZone=r,this._cache=this._injector.get(It,null),this._bindingActivator=this._injector.get(y.BINDING_ACTIVATOR,null),this._preservedContentBindingActivator=this._injector.get(y.PRESERVED_CONTENT_BINDING_ACTIVATOR,null),this._subscribeToActivator()}_subscribeToActivator(){!this._bindingActivator||(this._bindingActivatorSubscription=(0,h.combineLatest)([this._bindingActivator.active$,this._preservedContentBindingActivator?.active$??(0,h.of)(!0)]).pipe((0,p.map)(([e,t])=>e&&t),(0,p.distinctUntilChanged)(),(0,h.tap)(e=>{e&&this._stream$&&!this._subscription&&(this._subscription=this._stream$.subscribe()),e||(this._subscription?.unsubscribe(),this._subscription=null)})).subscribe())}_isControlProperty(e,t){const n=d.ViewElementRegistry.getFormControlRelatesAttribute(t.type);return e===n}_getInterpreter(e){return e?this._attributeFormControlExpressionInterpreter:this._bindingExpressionInterpreter}_restoreValueFromCache(e,t,n){if(!!this._cache&&t.name){const i=this._cache.get(e)?.get(t.name)?.get(n);typeof i<"u"&&(this._result=i)}}_canApplyValueFromCache(e,t,n){return!!(t.name&&this._cache&&typeof this._cache.get(e)?.get(t.name)?.get(n)<"u")}_saveToCache(e,t,n){if(!(!this._cache||!this._viewModelRef?.deref())&&e.name){const i=this._cache.get(this._viewModelRef.deref())||new Map,r=i.get(e.name)||new Map;this._cache.set(this._viewModelRef.deref(),i),i.set(e.name,r),r.set(t,n)}}transform(e,t,n){if(e!==this._oldValue){this._subscription?.unsubscribe(),this._oldValue=e,this._result=null,this._stream$=null;const i=this._isControlProperty(t,n);if(!(0,y.isBindingExpression)(e))this._result=i?new Oe.FormControl(e):e;else{this._bindingContext=this._injector.get(B);const r=this._bindingContext.viewModel$.pipe((0,h.tap)(u=>{const l=this._canApplyValueFromCache(u,n,t),f=(this._viewModelRef?.deref()||null)!==u,E=d.ViewElementRegistry.getViewElementInputs(n.type)[t];(!l&&f&&this._result instanceof I.BaseViewModelCollection||E?.reuseStrategy?.resetValue)&&(this._result=null),this._viewModelRef=u?new WeakRef(u):null,this._restoreValueFromCache(u,n,t)})),o=this._getInterpreter(i).evaluate(e,this._bindingContext).pipe((0,$e.runInZone)(this._ngZone),(0,h.tap)(u=>{this._result!==u&&(this._result=u,this._saveToCache(n,t,u),this._changeDetector.markForCheck())}));this._stream$=(0,h.merge)(r,o),this._subscription=this._stream$.subscribe()}}return this._result}ngOnDestroy(){this._subscription?.unsubscribe(),this._bindingActivatorSubscription?.unsubscribe()}static{this.\u0275fac=function(t){return new(t||de)(s.\u0275\u0275directiveInject(s.Injector,16),s.\u0275\u0275directiveInject(s.ChangeDetectorRef,16),s.\u0275\u0275directiveInject(O,16),s.\u0275\u0275directiveInject(F,16),s.\u0275\u0275directiveInject(s.NgZone,16))}}static{this.\u0275pipe=s.\u0275\u0275definePipe({name:"crtBinding",type:de,pure:!1})}}class Xt extends Error{constructor(e,t){super(`Validation error. Cannot create ${e} with name ${t}. Incorrect format`)}}const Qt=/^([#a-zA-Z_]+)([\w_.-]+)/gm;function We(c,e){const t=e.match(Qt);if(!(t?.length&&t[0]===e))throw new Xt(c,e)}class fe{static{this.\u0275fac=function(t){return new(t||fe)}}static{this.\u0275mod=s.\u0275\u0275defineNgModule({type:fe})}static{this.\u0275inj=s.\u0275\u0275defineInjector({imports:[P.CommonModule,G,P.CommonModule,G]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&s.\u0275\u0275setNgModuleScope(fe,{declarations:[X,de,ce,Se,le,Ae,he,pe,xe],imports:[P.CommonModule,G],exports:[P.CommonModule,G,Se,de,ce,le,X,Ae,he,pe,xe]})})();class ge{constructor(e,t,n){this._injector=t,this._ngZone=n,this._featureValues=this._injector.get(w.FEATURE_VALUES),this._modules=ge._flatModulesArrays(e)}static _flatModulesArrays(e){const t=e.flat(),n=t.filter((i,r)=>t.indexOf(i)!==r);if(n.length>0){const i=n.map(r=>r.name).join(", ");throw new Error(`There are module duplicates in "${Ue}" token: ${i}`)}return t}_getInputExpression(e,t,n){let i;const r=t.value;return this._featureValues.DisableDoNotUseBindingPipeForConstant?i=e?`"context['${e}']${n}"`:`"${r}${n}"`:e?i=t.pipes||typeof r=="string"?`"context['${e}']${n}"`:`'${r}'`:i=`"${r}${n}"`,i}_createInputDefinitions(e,t){const n=[];for(const[i,r]of Object.entries(e.inputs)){We("input",i);const a=r.propertyKey;a&&(t[a]=r.value);let o="";for(const f of r.pipes||[]){o+=` | ${f.name}`;for(const m of f.arguments||[])t[m.propertyKey]=m.value,o+=`:context['${m.propertyKey}']`}const u=this._getInputExpression(a,r,o),l=`[${i}]=${u}`;n.push(l)}return n}_createAttributeDefinitions(e,t){const n=[];for(const[i,r]of Object.entries(e.attributes))We("attribute",i),r.value?n.push(`${i}="${r.value}"`):n.push(`${i}`);return n}_createOutputDefinitions(e,t){const n=[],i="ref";Object.entries(e.outputs).length>0&&n.push(`crtOutputBinding #${i}="crtOutputBinding"`);for(const[r,a]of Object.entries(e.outputs)){We("output",r);const o=a.propertyKey;t[o]=a.fn,n.push(`(${r})="context['${o}'](${i}, $event)"`)}return n}_createDirectiveDefinitions(e,t){const n=[],i=[];for(const r of e.directives){const a=r.useAsterisk?`*${r.selector}`:`[${r.selector}]`,o=[];for(const f of r.values){const m=f.propertyKey;let E=`context['${m}']`;for(const x of f.pipes||[]){E+=` | ${x.name}`;for(const ee of x.arguments||[])t[ee.propertyKey]=ee.value,E+=`:context['${ee.propertyKey}']`}(0,h.isObservable)(f.value)?t[m]=f.value.pipe((0,$e.runInZone)(this._ngZone)):t[m]=f.value,o.push(E)}const{variableName:u}=r;let l="";r.additionalInputs?.length>0&&(r.useAsterisk?l=this._getAdditionalStructuredDirectiveInputs(r.additionalInputs):i.push(r.additionalInputs.map(f=>`[${f.propertyKey}]='${f.value}'`).join(";"))),r.rawValue&&o.push(r.rawValue),n.push(`${a}="${o.map(f=>`(${f})`).join(" && ")}${u?";let "+u:""+l}"`)}return{directives:n,directiveInputs:i}}_getAdditionalStructuredDirectiveInputs(e){return`; ${e.map(n=>`${n.propertyKey}: '${n.value}'`).join("; ")};`}_createContentDefinitions(e,t){const n=[],i=e.content;for(const r of i){const{componentContext:a,componentTemplate:o}=this.createTemplateAndContext(r);n.push(o),Object.assign(t,a)}return n}_isHostModule(e){return d.bootstrappedCrtModules.get(e)?.source==="host"}createTemplateAndContext(e){We("selector",e.selector);const t={},n=this._createInputDefinitions(e,t),i=this._createAttributeDefinitions(e,t),r=this._createOutputDefinitions(e,t),{directives:a,directiveInputs:o}=this._createDirectiveDefinitions(e,t),u=this._createContentDefinitions(e,t),l=e.name||"root",f=`${a.join(" ")} ${o.join(" ")}`;return{componentTemplate:`
			<${e.selector} id="${l}" crtViewInit (init)="refs['${l}'] = $event"
				${n.join(" ")} ${f} ${r.join(" ")} ${i.join(" ")}
			>
				${u.join(" ")}
			</${e.selector}>
		`,componentContext:t}}create(e,t,n){const i=this._injector,a=i.get(I.CRT_METADATA_PREPROCESSOR).map(l=>({provide:I.CRT_METADATA_PREPROCESSOR,useValue:l,multi:!0})),o=(n??[]).filter(l=>this._isHostModule(l));return{componentType:(0,s.Component)({selector:e,template:t,host:{class:"flex-full-height"},styles:[`
				:host > .stretch {
					flex-grow: 1;
				}
				.${st} {
					display: none;
				}
			`],changeDetection:s.ChangeDetectionStrategy.OnPush,imports:[fe,...this._modules,...o],standalone:!0,providers:[...a,{provide:y.BINDING_ACTIVATOR,useValue:{active$:new h.BehaviorSubject(!0)}}]})(class{constructor(){this._bindingActivator=(0,s.inject)(y.BINDING_ACTIVATOR),this.ownChangeDetectorRef=(0,s.inject)(s.ChangeDetectorRef),this.injector=i,this.refs={}}activate(){this.ownChangeDetectorRef.reattach(),this._bindingActivator.active$.next(!0)}deactivate(){this.ownChangeDetectorRef.detach(),this._bindingActivator.active$.next(!1)}updateViewElementInput(l,f,m){this.context={...this.context,[l+":"+f]:m},this.refs[l]?.changeDetectorRef?.detectChanges(),this.refs[l]?.changeDetectorRef?.markForCheck()}})}}static{this.\u0275fac=function(t){return new(t||ge)(s.\u0275\u0275inject(Ue),s.\u0275\u0275inject(s.Injector),s.\u0275\u0275inject(s.NgZone))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:ge,factory:ge.\u0275fac,providedIn:"root"})}}class Me{constructor(e){this._schemaChangeListenerService=e,this._componentInfoCache=new Map,this._destroyed$=new h.Subject,this._schemaChangeListenerService.schemaChanged$.pipe((0,p.takeUntil)(this._destroyed$)).subscribe(t=>{t.schemaType===w.SchemaTypes.ClientUnitSchema&&this._componentInfoCache.delete(t.name)})}get(e){return this._componentInfoCache.get(e)}set(e,t){this._componentInfoCache.set(e,t)}has(e){return this._componentInfoCache.has(e)}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}static{this.\u0275fac=function(t){return new(t||Me)(s.\u0275\u0275inject(w.SchemaChangeListenerService))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:Me,factory:Me.\u0275fac,providedIn:"root"})}}class me{constructor(){this.viewAttached$=new h.BehaviorSubject(!0)}static{this.\u0275fac=function(t){return new(t||me)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:me,factory:me.\u0275fac})}}class ye{constructor(){this._componentRefCache=new Map,this._viewConfigCache=new Map,this._instanceCache=new Map}invalidateInstance(e){const t=[],n=Array.from(this._componentRefCache.keys());for(const[i,r]of this._instanceCache.entries())r.delete(e),i.instance.ownChangeDetectorRef.detectChanges(),!r.size&&n.indexOf(i)<n.length-1&&t.push(i);t.forEach(i=>{this._componentRefCache.delete(i),this._viewConfigCache.delete(i),this._instanceCache.delete(i),i.destroy()})}saveView(e,t,n){const i=this._componentRefCache.get(e)||new Set;i.add(t),this._componentRefCache.set(e,i),this._viewConfigCache.set(e,n)}saveInstance(e,t){const n=this._instanceCache.get(e)||new Set;n.add(t),this._instanceCache.set(e,n)}getInstances(e){return this._instanceCache.get(e)}getView(e){for(const[t,n]of this._componentRefCache.entries())if(n.has(e))return t}getViewConfig(e){return this._viewConfigCache.get(e)}ngOnDestroy(){for(const e of this._componentRefCache.keys())e.destroy();this._componentRefCache.clear(),this._viewConfigCache.clear(),this._instanceCache.clear()}static{this.\u0275fac=function(t){return new(t||ye)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:ye,factory:ye.\u0275fac})}}var Et=C(18877);const Vt="bindTo",en="visible";class b{static _getViewElementInputProperties(e){const t=d.ViewElementRegistry.viewElements.get(e.type);return[...Object.keys(t.inputs??{}).filter(n=>t.inputs[n].propertyBindable),en]}static createLayoutConfigComponentParts(e,t,n){for(const[i,r]of Object.entries(t))n.attributes["layout-config-"+(0,g.kebabCase)(i)]={value:r}}static createVisibleComponentPartsWrapper(e,t,n,i){const r=(0,y.isBindingExpression)(t);let a=t;const o=[];r&&(a=t,o.push({name:"crtBinding",arguments:[{value:e,propertyKey:b.getContextPropertyName(e+"|propertyName",n)},{value:i,propertyKey:b.getContextPropertyName(e+"|viewElementConfig",n)}]}));const u=n.directives.find(l=>l.selector==="crtIf");if(u)u.values.unshift({propertyKey:this.getContextPropertyName(e,n),value:a,pipes:o});else{const l={values:[{propertyKey:this.getContextPropertyName(e,n),value:a,pipes:o}],selector:"crtIf",useAsterisk:!0};b.addCrtIfDirectiveAdditionalInputs(l,i),n.directives.push(l)}return n}static getContextPropertyName(e,t){return t.name+":"+e}static getViewElementEntries(e){const t=d.ViewElementRegistry.getFormControlRelatesAttribute(e.type),n=Object.entries(e),i=n.find(([a])=>a===Vt);let r=n.filter(([a])=>a!==Vt);if(i){const a=this._getViewElementInputProperties(e),[,o]=i;a.forEach(u=>{if(u!==t){const l=e[u];if(l==null||typeof l!="string"||typeof l=="string"&&!l.includes("|")){let f=o;f=`${f}:${u}`,l!=null&&(f+=`=${JSON.stringify(l)}`),r=r.filter(([m])=>m!==u),r.push([u,f])}}})}return r}static addCrtIfDirectiveAdditionalInputs(e,{visibilityStrategyMode:t}){if(!t)return;const n=e.additionalInputs||[];n.push({propertyKey:"visibilityStrategyMode",value:t}),e.additionalInputs=[...n]}}class Rt{constructor(e,t){this.injector=e,this.componentPartsFactory=t,this._specialPropertiesList=[{property:"type",createComponentPart:()=>{}},{property:"layoutConfig",createComponentPart:b.createLayoutConfigComponentParts.bind(this)}],this._loadingAttributeName="loading",this._visibleAttributeName="visible",this.initDependencies()}_createViewElementConfigProviderComponentParts(e,t){t.directives.push({selector:"crtViewElementConfig",values:[{value:e,pipes:[],propertyKey:b.getContextPropertyName("viewElementConfig",t)}]})}_createDataItemMarkerComponentParts(e,t){t.attributes["data-item-marker"]={value:e.dataItemMarker||e.name}}createLoadingComponentParts(e,t){Object.keys(e).some(i=>i===this._loadingAttributeName)?this._createInputComponentParts(this._loadingAttributeName,e[this._loadingAttributeName],e,t):this._createDefaultLoadingPropertyBinding(e,t)}_createDefaultLoadingPropertyBinding(e,t){const n=(0,g.chain)(e).entries().filter(([r,a])=>this.isInputBinding(r,a,e)&&(0,y.isBindingExpression)(a)).value();let i=(0,h.of)(!1);if(n.length){const r=n.map(([a,o])=>He(o));i=this._createLoadingPropertyValueFromContextEvent(r)}t.inputs[this._loadingAttributeName]={propertyKey:b.getContextPropertyName(this._loadingAttributeName,t),pipes:[{name:"crtAsync",arguments:[]}],value:i}}_createLoadingPropertyValueFromContextEvent(e){const t=this.injector.get(s.NgZone);return ne(this._bindingContext).viewModel$.pipe((0,p.switchMap)(n=>{if(!n)return(0,h.of)(!1);let i=[];const r=n.events$.pipe((0,p.filter)(o=>o.type===I.ViewModelEventType.StartLoadModelAttributes),(0,p.map)(o=>o),(0,p.filter)(o=>{const u=Object.keys(o.payload);return e.some(l=>u.includes(l))}),(0,p.tap)(o=>{i=Object.keys(o.payload)}),(0,p.map)(()=>!0)),a=n.events$.pipe((0,p.filter)(o=>o.type===I.ViewModelEventType.FinishLoadModelAttributes),(0,p.map)(o=>o),(0,p.filter)(o=>{const u=Object.keys(o.payload);return i.every(l=>u.includes(l))}),(0,p.map)(()=>!1),(0,p.tap)(()=>i=[]));return(0,h.merge)(r,a).pipe((0,$e.runInZone)(t))}))}_createContentPropertyComponentParts(e,t,n,i,r){const a=this.getViewElementSlotDefinition(n,e);for(const o of t){const u=this.componentPartsFactory.create(this.injector,o);let l=u.create(o,i,r);a.lazy&&(l=this.createLazyContentComponentParts(l)),this.featureValues.UseSchemaOutletReuseViewStrategy&&this.isAngularHost&&!this.featureValues.DisableComponentPartsCreatorAddContentProperty?u.addContentProperty(e,l,n):this.addContentProperty(e,l,n),i.content.push(l)}a.input&&this._createInputComponentParts(e,t,n,i)}_isConstant(e){const t=typeof e;return t==="string"&&!(0,y.isBindingExpression)(e)||t==="number"||t==="boolean"||t==="bigint"}_getBindingPipeConfig(e,t,n){return[{name:"crtBinding",arguments:[{value:e,propertyKey:b.getContextPropertyName(e+"|propertyName",n)},{value:t,propertyKey:b.getContextPropertyName(e+"|viewElementConfig",n)}]}]}_createInputComponentParts(e,t,n,i){i.inputs[e]={propertyKey:b.getContextPropertyName(e,i),value:t},(this.featureValues.DisableDoNotUseBindingPipeForConstant||!this._isConstant(t))&&(i.inputs[e].pipes=this._getBindingPipeConfig(e,n,i))}_createControlInputComponentParts(e,t,n,i){const r={selector:"crtIf",variableName:"control",useAsterisk:!0,values:[{value:t,propertyKey:b.getContextPropertyName(e,i),pipes:[{name:"crtBinding",arguments:[{value:e,propertyKey:b.getContextPropertyName(e+"|propertyName",i)},{value:n,propertyKey:b.getContextPropertyName(e+"|viewElementConfig",i)}]}]}],additionalInputs:[]};b.addCrtIfDirectiveAdditionalInputs(r,n),i.directives.push(r),i.inputs[e]={value:"control"}}_createInputWithValidationComponentParts(e,t,n,i){const a=this.injector.get(W).evaluate(t,this._bindingContext).pipe((0,p.share)()),o=a.pipe((0,p.pluck)("value"),(0,p.distinctUntilChanged)());i.inputs[e]={propertyKey:b.getContextPropertyName(e,i),value:o,pipes:[{name:"crtAsync",arguments:[]}]};const u=ze(e),l=a.pipe((0,p.pluck)("validationInfo"),(0,p.distinctUntilChanged)());i.inputs[u]={propertyKey:b.getContextPropertyName(u,i),value:l,pipes:[{name:"crtAsync",arguments:[]}]}}_createOutputComponentParts(e,t,n){n.outputs[e]={propertyKey:b.getContextPropertyName(e,n),fn:(i,r)=>{i.processOutputEvent(t,r)}}}_createTwoWayBindingComponentParts(e,t,n,i){Ie(n.type,e)?this._createInputWithValidationComponentParts(e,t,n,i):this._createInputComponentParts(e,t,n,i);const r=t.slice(1),a=ae(e),o={action:"changeAttributeValue",attributePath:r};this._createOutputComponentParts(a,o,i);const u={action:"markControlAsTouched",attributePath:r};this._createOutputComponentParts("focusout",u,i)}_createSpecialPropertyComponentParts(e,t,n){return this._specialPropertiesList.find(r=>r.property===e)?.createComponentPart(e,t,n)}initDependencies(){this.bindingExpressionInterpreter=this.injector.get(O),this._bindingContext=this.injector.get(B),this.featureValues=this.injector.get(w.FEATURE_VALUES),this.isAngularHost=this.injector.get(w.IS_ANGULAR_HOST)}createLazyContentComponentParts(e){throw Error("View element type does not support lazy content projection.")}isSpecialPropertyBinding(e,t){return Boolean(this._specialPropertiesList.find(n=>n.property===e))}isContentPropertyBinding(e,t,n){return Boolean(this.getViewElementSlotDefinition(n,e))}getViewElementSlotDefinition(e,t){const i=d.ViewElementRegistry.viewElements.get(e.type)?.contentSlots?.find(r=>(typeof r=="string"?r:r.name)===t);return typeof i=="string"?{name:i,input:!1,lazy:!1}:i}isInputBinding(e,t,n){return re(n.type,e)}isControlBinding(e,t,n){return d.ViewElementRegistry.getFormControlRelatesAttribute(n.type)===e}isInputWithValidationBinding(e,t,n){return this.isInputBinding(e,t,n)&&(0,y.isSimpleBindingExpression)(t)&&Ie(n.type,e)}isOutputBinding(e,t,n){return oe(n.type,e)}isTwoWayBinding(e,t,n){const i=ae(e);return re(n.type,e)&&oe(n.type,i)&&!(i in n)&&(0,y.isBindingExpression)(t)?(0,y.isSimpleBindingExpression)(t)?!0:(console.warn(`Cannot use two way binding for '${e}' property of '${n.name}' view element. Expression '${t}' should not have converters, properties etc.`),!1):!1}_processViewElementConfigProperty(e,t,n,i,r){if(this.isContentPropertyBinding(e,t,n)&&Array.isArray(t))this._createContentPropertyComponentParts(e,t,n,i,r);else if(this.isSpecialPropertyBinding(e,t))this._createSpecialPropertyComponentParts(e,t,i);else if(this.isTwoWayBinding(e,t,n))this._createTwoWayBindingComponentParts(e,t,n,i);else if(this.isOutputBinding(e,t,n)){const a=Array.isArray(t)?t:[t],o={action:"processRequest",requests:a};this._createOutputComponentParts(e,o,i)}else this.isInputWithValidationBinding(e,t,n)?this._createInputWithValidationComponentParts(e,t,n,i):this.isControlBinding(e,t,n)?this._createControlInputComponentParts(e,t,n,i):this.isInputBinding(e,t,n)&&this._createInputComponentParts(e,t,n,i)}addIsAttachedConditionInCrtIf(e){const t={propertyKey:b.getContextPropertyName("isViewAttached",e),value:this.injector.get(me).viewAttached$.asObservable(),pipes:[{name:"crtAsync"}]},n=e.directives.find(({selector:i})=>i==="crtIf");n?n.values.push(t):e.directives.push({selector:"crtIf",useAsterisk:!0,values:[t]})}create(e,t,n){const i=new ue(t);i.selector=this.getSelector(e),i.name=e.name??(0,Et.Z)();const r=b.getViewElementEntries(e);for(const[o,u]of r)o!==this._visibleAttributeName&&this._processViewElementConfigProperty(o,u,e,i,n);this.createLoadingComponentParts(e,i),n?.useDataItemMarker&&this._createDataItemMarkerComponentParts(e,i),this._createViewElementConfigProviderComponentParts(e,i);const a=r.find(([o])=>o===this._visibleAttributeName);return a?.[0]?b.createVisibleComponentPartsWrapper(this._visibleAttributeName,a[1],i,e):i}}class Pt extends Rt{addContentProperty(e,t,n){d.ViewElementRegistry.viewElements.get(n.type)?.contentSlots?.length>1&&(t.attributes[e]={value:""}),t.attributes["#"+e]={value:""}}createLazyContentComponentParts(e){const t=new ue;t.selector="ng-template",t.content.push(e);const n=e.directives.find(i=>i.selector==="crtIf");return n&&t.directives.push({selector:"crtIf",values:n.values,useAsterisk:!0}),t}createControl(e){return new Oe.FormControl(e)}getSelector(e){return this.getComponentMirror(e).selector}getComponentMirror(e){const n=this.injector.get(A).getViewElementType(e);return(0,s.reflectComponentType)(n)}}class rt{}class tn extends Pt{addContentProperty(e,t,n){super.addContentProperty(e,t,n),this.featureValues.UseSchemaOutletReuseViewStrategy&&this.isAngularHost&&(this.featureValues.DisableComponentPartsRerenderCache||(t.content[0].content[0].attributes["#"+e]={value:""}))}create(e,t,n){const i=super.create(e,t,n);if(this.featureValues.UseSchemaOutletReuseViewStrategy&&this.isAngularHost)if(this.featureValues.DisableComponentPartsRerenderCache)this.addIsAttachedConditionInCrtIf(i);else{const r=new ue(t);r.selector="ng-template",r.attributes.crtNgFor={value:""},r.attributes["let-instanceId"]={value:""},r.inputs.ngForOf={value:`context['${Le}']`};const a=new ue(r);return r.content=[a],a.selector="ng-container",a.directives.push({selector:"crtAttachIf",values:[],useAsterisk:!0,rawValue:`context['${Pe}'] === instanceId`}),a.content=[i],r}return i}}class nn{constructor(e){this._injector=e}create(e,t,n){const i=new ue(t);return i.selector="crt-view-element-placeholder",i.name=e.name??(0,Et.Z)(),i.inputs.caption={value:e.type,propertyKey:b.getContextPropertyName("caption",i),pipes:[]},"layoutConfig"in e&&b.createLayoutConfigComponentParts("layoutConfig",e.layoutConfig,i),"visible"in e?b.createVisibleComponentPartsWrapper("visible",e.visible,i,e):i}addContentProperty(e,t,n){}}class sn extends Rt{addContentProperty(e,t,n){d.ViewElementRegistry.viewElements.get(n.type)?.contentSlots?.length>1&&(t.attributes[e]={value:""}),t.attributes["#"+e]={value:""}}createControl(e){return new I.BaseCrtControl(e)}getSelector(e){return this.injector.get(A).getSelector(e.type)}createLoadingComponentParts(e,t){d.ViewElementRegistry.viewElements.get(e.type).inputs?.loading&&super.createLoadingComponentParts(e,t)}create(e,t,n){const i=super.create(e,t,n);return this.addIsAttachedConditionInCrtIf(i),i}}class _e extends rt{create(e,t){const n=e.get(A);if(!t.type)throw new Error('"Type" property of view config can not be empty');return n.canResolve(t.type)?n.getSelector(t.type)?new sn(e,this):d.ViewElementRegistry.viewElements.get(t.type)?.reuseStrategy===d.ViewElementReuseStrategy.Rerender?new tn(e,this):new Pt(e,this):(console.warn(`View element with type "${t.type}" not found`),new nn(e))}static{this.\u0275fac=function(){let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(_e)))(n||_e)}}()}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:_e,factory:_e.\u0275fac})}}class rn{constructor(e){this._injector=e}create(e,t,n){const i=new ComponentParts(t);i.selector="crt-view-element-container",i.name=e.name??uuid(),i.inputs.viewElementConfig={value:e,propertyKey:ComponentPartsCreatorUtils.getContextPropertyName("viewElementConfig",i),pipes:[]},"layoutConfig"in e&&ComponentPartsCreatorUtils.createLayoutConfigComponentParts("layoutConfig",e.layoutConfig,i);const a=ComponentPartsCreatorUtils.getViewElementEntries(e).find(([o])=>o==="visible");return a?.[0]in e?ComponentPartsCreatorUtils.createVisibleComponentPartsWrapper("visible",a[1],i,e):i}addContentProperty(e,t,n){}}class Q{constructor(e,t,n,i,r,a,o){this.injector=e,this._featureService=t,this.containerRef=n,this._componentCreator=i,this._componentPartsFactory=r,this._componentStorage=a,this._measurePerformanceService=o,this._featureValues=(0,s.inject)(w.FEATURE_VALUES)}_getContentProperties(e){return d.ViewElementRegistry.viewElements.get(e.type)?.contentSlots?.map(t=>typeof t=="string"?t:t.name)||[]}_getInputProperties(e){const t=d.ViewElementRegistry.viewElements.get(e.type),n=t?.inputs||{};return t.contentSlots&&t.contentSlots.forEach(i=>{typeof i=="object"&&i.input&&(n[i.name]={})}),n}_getOutputProperties(e){return d.ViewElementRegistry.viewElements.get(e.type)?.outputs||{}}_getOutputPropertiesValues(e){const t=this._getOutputProperties(e);return(0,g.pick)(e,Object.keys(t))}_isViewConfigsDifferent(e,t){return e.name!==t.name||e.type!==t.type||this._isOutputPropertiesChanged(e,t)||this._isInputOrContentPropertiesLengthChanged(e,t)}_isInputOrContentPropertiesLengthChanged(e,t){const n=[...Object.keys(this._getInputProperties(e)),...Object.keys(this._getContentProperties(e))],i=[...Object.keys(this._getInputProperties(t)),...Object.keys(this._getContentProperties(t))];return!(0,g.isEqual)(new Set(n),new Set(i))}_isOutputPropertiesChanged(e,t){const n=this._getOutputPropertiesValues(e),i=this._getOutputPropertiesValues(t);return!(0,g.isEqual)(n,i)}_getComponentParts(e){const t=new ue;t.selector="ng-container";for(const n of(0,g.cloneDeep)(this.viewConfig)){const r=this._componentPartsFactory.create(this.injector,n).create(n,null,{useDataItemMarker:e});t.content.push(r)}return t}createComponent(e,t){let n;const i=this._measurePerformanceService.measure("ViewGenerator.getComponentParts",()=>this._getComponentParts(e)),{componentContext:r,componentTemplate:a}=this._measurePerformanceService.measure("ViewGenerator.createTemplateAndContext",()=>this._componentCreator.createTemplateAndContext(i));!t&&this.selector&&this._componentStorage.has(this.selector)?n=this._componentStorage.get(this.selector):(n=this._measurePerformanceService.measure(`ViewGenerator.createComponent.${this.selector}`,()=>this._componentCreator.create(this.selector,a,this.modules)),!t&&this.selector&&this._componentStorage.set(this.selector,n));const o=this.containerRef.createComponent(n.componentType,{index:0,injector:this.injector,environmentInjector:this.injector.get(s.EnvironmentInjector)});return o.instance.context=r,o}canUpdateView(e,t){if(this._featureValues.DisableUpdateWithoutSchemaReload||e.length!==t.length||!this.componentInstance)return!1;for(let n=0;n<e.length;n++){const i=e[n],r=t[n];if(this._isViewConfigsDifferent(i,r))return!1;const a=this._getContentProperties(i);for(const o of a)if(!this.canUpdateView(i[o]||[],r[o]||[]))return!1}return!0}_updateViewElementInputs(e,t){for(let n=0;n<e.length;n++){const i=t[n],r=e[n];for(const o of Object.keys(this._getInputProperties(i)))(0,g.isEqual)(i[o],r[o])||this.componentInstance.updateViewElementInput(i.name,o,i[o]);const a=this._getContentProperties(i);for(const o of a)this._updateViewElementInputs(r[o]||[],i[o]||[])}}updateView(e,t){this._measurePerformanceService.measure("ViewGenerator.updateView",()=>{this._updateViewElementInputs(e,t),this.componentInstance.changeDetectorRef.detectChanges()})}resetPreviousView(){this.containerRef.clear()}createView(){const e=this.createComponent(this._featureValues.UseViewElementDataItemMarker,this._featureValues.DisableComponentCacheFeature);return e.instance.changeDetectorRef=e.changeDetectorRef,this.componentInstance=e.instance,e}ngOnChanges(e){const t=e.viewConfig?.currentValue||[],n=e.viewConfig?.previousValue||[];t&&!(0,g.isEqual)(n,t)&&(this.canUpdateView(n,t)?this.updateView(n,t):(this.resetPreviousView(),this.createView()))}static{this.\u0275fac=function(t){return new(t||Q)(s.\u0275\u0275directiveInject(s.Injector),s.\u0275\u0275directiveInject(lt.FeatureService),s.\u0275\u0275directiveInject(s.ViewContainerRef),s.\u0275\u0275directiveInject(ge),s.\u0275\u0275directiveInject(rt),s.\u0275\u0275directiveInject(Me),s.\u0275\u0275directiveInject(w.MeasurePerformanceService))}}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:Q,selectors:[["","crtViewGenerator",""]],inputs:{viewConfig:"viewConfig",selector:"selector",modules:"modules"},features:[s.\u0275\u0275ProvidersFeature([...be]),s.\u0275\u0275NgOnChangesFeature]})}}class H extends Q{constructor(){super(...arguments),this._cacheService=(0,s.inject)(ye),this._viewModel$=new h.ReplaySubject(1),this._bindingContext={viewModel$:this._viewModel$.asObservable()}}resetPreviousView(){if(this.componentInstance?.deactivate(),this._componentRef){const e=this.containerRef.indexOf(this._componentRef.hostView);this.containerRef.detach(e)}}createView(){return this._viewModel$.next(this.viewModel),super.createView()}_restoreView(e){this.resetPreviousView(),this._componentRef=e,this.componentInstance=this._componentRef.instance,this._viewModel$.next(this.viewModel),this.componentInstance.activate(),this.containerRef.insert(e.hostView,0)}_createOrUpdateViewWithoutCaching(e){if("instanceId"in e){this.resetPreviousView(),this._componentRef=this.createView(),this._componentRef.instance.context[Pe]=this.instanceId,this._componentRef.instance.context[Le]=[this.instanceId];return}const t=this.viewConfig||[],n=e.viewConfig?.previousValue||[];"viewConfigId"in e&&(this.canUpdateView(n,t)?this.updateView(n,t):(this.resetPreviousView(),this._componentRef.destroy(),this._componentRef=this.createView(),this._componentRef.instance.context[Pe]=this.instanceId,this._componentRef.instance.context[Le]=[this.instanceId]))}_createOrUpdateView(e){const t=this.viewConfig||[],n=e.viewConfig?.previousValue||[];if("instanceId"in e||"viewConfigId"in e){const i=this._cacheService.getView(this.viewConfigId),a=this._cacheService.getViewConfig(i)||n;this.canUpdateView(a,t)?(i&&this._restoreView(i),this._componentRef.instance.context[Pe]=this.instanceId,this.updateView(a,t)):(this.resetPreviousView(),this._componentRef=this.createView(),this._cacheService.invalidateInstance(this.instanceId),this._componentRef.instance.context[Pe]=this.instanceId),this._cacheService.saveView(this._componentRef,this.viewConfigId,this.viewConfig),this._cacheService.saveInstance(this._componentRef,this.instanceId),this._componentRef.instance.context[Le]=this._cacheService.getInstances(this._componentRef)}}_resetPreviousViewWithoutCaching(e){const t="skipCache"in e?e.skipCache.previousValue:this.skipCache;"instanceId"in e&&t&&(this.resetPreviousView(),this._componentRef.destroy(),this._componentRef=null)}ngOnChanges(e){if(this._resetPreviousViewWithoutCaching(e),this.skipCache){this._createOrUpdateViewWithoutCaching(e);return}this._createOrUpdateView(e)}static{this.\u0275fac=function(){let e;return function(n){return(e||(e=s.\u0275\u0275getInheritedFactory(H)))(n||H)}}()}static{this.\u0275dir=s.\u0275\u0275defineDirective({type:H,selectors:[["","crtReusableViewGenerator",""]],inputs:{instanceId:"instanceId",viewModel:"viewModel",viewConfigId:"viewConfigId",skipCache:"skipCache"},features:[s.\u0275\u0275ProvidersFeature([{provide:B,useFactory:e=>e._bindingContext,deps:[(0,s.forwardRef)(()=>H)]},...be]),s.\u0275\u0275InheritDefinitionFeature,s.\u0275\u0275NgOnChangesFeature]})}}class ve{static forRoot(e){return{ngModule:ve,providers:[{provide:Ue,useValue:e}]}}static{this.\u0275fac=function(t){return new(t||ve)}}static{this.\u0275mod=s.\u0275\u0275defineNgModule({type:ve})}static{this.\u0275inj=s.\u0275\u0275defineInjector({providers:[{provide:rt,useClass:_e}],imports:[P.CommonModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&s.\u0275\u0275setNgModuleScope(ve,{declarations:[Q,H],imports:[P.CommonModule],exports:[Q,H]})})()},18877:(Ge,Te,C)=>{C.d(Te,{Z:()=>j});const te={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let s;const d=new Uint8Array(16);function y(){if(!s&&(s=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!s))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(d)}const g=[];for(let _=0;_<256;++_)g.push((_+256).toString(16).slice(1));function h(_,v=0){return g[_[v+0]]+g[_[v+1]]+g[_[v+2]]+g[_[v+3]]+"-"+g[_[v+4]]+g[_[v+5]]+"-"+g[_[v+6]]+g[_[v+7]]+"-"+g[_[v+8]]+g[_[v+9]]+"-"+g[_[v+10]]+g[_[v+11]]+g[_[v+12]]+g[_[v+13]]+g[_[v+14]]+g[_[v+15]]}function p(_,v=0){const D=h(_,v);if(!validate(D))throw TypeError("Stringified UUID is invalid");return D}const Be=null;function B(_,v,D){if(te.randomUUID&&!v&&!_)return te.randomUUID();_=_||{};const R=_.random||(_.rng||y)();if(R[6]=R[6]&15|64,R[8]=R[8]&63|128,v){D=D||0;for(let P=0;P<16;++P)v[D+P]=R[P];return v}return h(R)}const j=B},57421:Ge=>{Ge.exports=`<svg xmlns="http://www.w3.org/2000/svg" width="65.898" height="50" viewBox="0 0 65.898 50">
  <g id="Group_10554" data-name="Group 10554" transform="translate(-630.824 -282)">
    <g id="Group_10553" data-name="Group 10553" transform="translate(-8 4)">
      <rect id="Rectangle_23319" data-name="Rectangle 23319" width="24" height="8" transform="translate(640 311) rotate(-90)" fill="#757575" opacity="0.15"/>
      <rect id="Rectangle_23320" data-name="Rectangle 23320" width="15" height="8" transform="translate(655 313) rotate(-90)" fill="#757575" opacity="0.36"/>
      <rect id="Rectangle_23321" data-name="Rectangle 23321" width="50" height="8" transform="translate(671 328) rotate(-90)" fill="#757575" opacity="0.16"/>
      <rect id="Rectangle_23326" data-name="Rectangle 23326" width="20" height="8" transform="translate(671 298) rotate(-90)" fill="#757575" opacity="0.36"/>
      <rect id="Rectangle_23322" data-name="Rectangle 23322" width="30" height="8" transform="translate(687 311) rotate(-90)" fill="#757575" opacity="0.12"/>
      <rect id="Rectangle_23327" data-name="Rectangle 23327" width="17" height="8" transform="translate(687 298) rotate(-90)" fill="#757575" opacity="0.36"/>
      <rect id="Rectangle_23323" data-name="Rectangle 23323" width="11" height="8" transform="translate(640 298) rotate(-90)" fill="#757575" opacity="0.15"/>
      <rect id="Rectangle_23324" data-name="Rectangle 23324" width="25" height="8" transform="translate(655 313) rotate(-90)" fill="#757575" opacity="0.19"/>
      <path id="Path_9959" data-name="Path 9959" d="M223.923,2054c8.8,1.753,9.21,7.979,18.455,7.661s19.38-15.618,29.076-15.618,13.109-8.362,16.091-8.043" transform="translate(416.077 -1753.707)" fill="none" stroke="#757575" stroke-linecap="round" stroke-width="2" opacity="0.36"/>
    </g>
  </g>
</svg>
`}}]);
